{"version":3,"sources":["context/GameContext.js","components/game/Scoreboard.js","util/data.js","util/misc.js","components/game/InformationTooltip.js","components/game/Util.js","components/game/TwentyQuestions.js","hooks/useWindowSize.js","components/game/Match.js","components/game/TwentyQuestionsPractice.js","components/game/Menu.js","components/ImageAnimation.js","components/chart/ThresholdChartSet.js","components/chart/ExperimentThresholdCharts.js","components/ImageNoise.js","components/story/ImageClasses.js","components/story/TargetModel.js","components/story/InputOutput.js","components/story/FlowChart.js","components/Story.js","views/GameView.js","App.js","reportWebVitals.js","index.js"],"names":["GameContext","createContext","GameContextProvider","props","useState","players","name","color","selections","score","images","previousPracticeRounds","practiceRound","gameSettings","setGameSettings","Provider","value","children","styled","div","scoreDisplays","player","totalPossible","percentage","toFixed","sample","items","size","map","x","r","Math","random","sort","a","b","slice","length","sanitizeJson","obj","Object","keys","reduce","all","p","toLowerCase","cleanObject","filter","key","allGroups","data","Set","groups","practiceSet","groupNumber","includes","gameData","path","snippetId","fetchPath","fetch","allOptions","json","correctData","practiceOptions","gameOptions","matchData","match","easy","hard","learn","isDefined","undefined","clean","k","styleDiv","getDiv","style","forEach","isDef","shuffle","arr","reduceRight","res","_","__","s","push","splice","chain","console","log","bind","fns","duration","delay","t","Promise","resolve","setTimeout","StyledInstructions","Instructions","StyledInformationButton","button","InformationTooltip","triggerText","triggerStyle","id","Date","now","floor","getContent","effect","place","data-for","data-tip","CenteredOuter","CenteredInner","Centered","ToggleButtonCheckBoxWrapper","CheckButton","checked","backgroundColor","left","ToggleButton","trueLabel","falseLabel","trueBgColor","falseBgColor","onToggle","defaultValue","onClick","right","GameButton","Emoji","className","label","symbol","symbols","Array","isArray","role","aria-label","String","fromCodePoint","Sidecar","StyledRangeSlider","ControlLabel","position","RangeTrack","RangeHandle","RangeSlider","min","max","onChange","step","labelPosition","handleStyle","_label","values","_value","renderTrack","renderThumb","marginTop","height","StyledGameTitle","GameTitle","information","fadeIn","keyframes","StyledAnswerSvg","WrongAnswerX","width","strokeWidth","stroke","fill","rx","strokeLinecap","cornerPadding","viewBox","y","x1","y1","x2","y2","RightAnswerCheck","strokeLinejoin","checkPoints","cx","cy","points","join","SIZES","generateGameData","gameMode","gameDataModel","_gameData","i","correctAnswers","correct","parseInt","labelStyle","padding","fontSize","background","toDeerImage","img","index","image","tags","src","thumbnail","thumbnailWidth","thumbnailHeight","customOverlay","toImage","_img","title","findYouPlayer","StyledAnswersOverlay","AnswerOverlay","AnswersOverlay","useContext","_you","shouldShowAnswers","Choices","noise","settings","useEffect","resetGame","originalImages","noiseKey","variant","variants","hasVariant","onSelectImage","updated","you","hasOwnProperty","isSelected","enableImageSelection","onClickThumbnail","tagStyle","showLightboxThumbnails","enableLightbox","mode","original","updateFn","currentGameData","StyledControls","StyledControlEnd","Score","Controls","onSettingsUpdated","noiseLevel","setNoiseLevel","setScore","showRetryButton","setShowRetryButton","selectionCount","level","_selections","wrongAnswers","omittedAnswers","calculateScore","disabled","StyledGame","Game","GameInformation","TwentyQuestions","setSettings","marginBottom","_settings","useWindowSize","windowSize","setWindowSize","handleResize","window","innerWidth","innerHeight","addEventListener","removeEventListener","DraggableImageBase","StyledDraggableImage","DraggableImage","correctTarget","attempt","onGuess","draggableId","useDrag","type","item","end","monitor","dropResult","getDropResult","guess","source","target","collect","isDragging","drag","opacity","alt","ref","DraggableContainer","DraggableTargetDrop","DraggableTarget","matches","useDrop","accept","drop","isOver","canDrop","isActive","from","find","to","display","flexDirection","backgroundImage","marginLeft","SideContainer","toKey","MiddleSection","GameInfo","matchCount","targetCount","ScoreBoard","guesses","textAlign","incorrect","RetryButton","won","Options","onGameOver","onRetry","setWon","buttonText","setButtonText","total","text","maxStrikes","MatchLayout","model","setDisabled","useMemo","sources","targetIds","setMatches","resetGuesses","useCallback","setGuesses","sourceId","prev","getTime","start","animateDrawing","Match","retries","setRetries","setModel","allImages","setAllImages","resetModel","targets","_matchData","getMatchData","DndProvider","backend","HTML5Backend","sourceCount","PRACTICE_IMAGE_SIZE","AI_NAME","COLORS","setCurrentIndex","demo","version","practiceRoundNumber","scrollingImages","url","allQuestionsAnswered","seenbefore","StyledPracticeResult","current","PracticeResultTitle","PracticeResult","question","agree","questionNumber","isCurrentImage","answer","waiting","StyledEndButtons","EndButtons","StylePracticeResults","PracticeResultsTitle","PracticeResultsSubtitle","h4","PracticeResults","currentImageIndex","ImageSliderOverrideStyles","currentIndex","Selectors","imageSize","imagePercent","paddingLeft","paddingTop","dangerouslySetInnerHTML","__html","property","colors","border","_bulletStyle","StyledQuestionWithButtons","StyledQuestionWithButtonsButton","QuestionText","QuestionWithButtons","onAnswer","StyledTuningSideTile","TuningSideTile","StyledProbability","Probability","previousLabel","percent","PictureLabel","changed","margin","animate","reveal","hideLabel","totalValue","lineWidth","dataEntry","StyledTuningsOuter","StyledTuningSelect","TuningSelect","selectStyles","container","provided","indicatorSeparator","option","whiteSpace","content","icon","menu","singleValue","styles","isSearchable","Tunings","getImageDiv","onLoadImageVariant","defaultStyle","setStyles","selectedVariant","setSelectedVariant","changeImage","transition","variantLabel","updateImage","additionalStyles","toggle","probability","augmentVariants","startsWith","optionDecorations","hflip","vflip","replace","noop","decorate","object","decoration","options","fn","defaults","decorationKey","noiseLevelVariants","noiseLevels","Caption","StyledSwitchMode","SwitchModeButton","selected","SwitchMode","onSwitchMode","labels","trick","toModes","toMode","StyledPracticeVoteButtons","ImageControls","displayMode","setDisplayMode","loadedImage","setLoadedImage","defaultLoadedImageState","onSeenBeforeClick","guessed","caption","StyledPractice","StyledPracticeGame","TwentyQuestionsPractice","hideSideBar","imageState","setImageState","reset","sliderRef","useRef","querySelectorAll","showBullets","showNavs","navStyle","onStartSlide","idx","borderBottomLeftRadius","borderTopLeftRadius","Container","Title","h1","GameCards","GameCardContainer","GameCardTitle","GameCardButton","ButtonContainer","GameCard","links","games","Stack","OrScroll","Menu","PictureAndInformation","Picture","Information","Slides","Slide","Rotated","rotation","transform","RotatedText","StyledAnimateButton","ButtonSymbols","play","pause","AnimateButton","status","stateSymbols","stopped","playing","ImageAnimation","info","selectedIndex","setSelectedIndex","animating","setAnimating","React","nextIndex","outline","onInput","e","onMouseOver","ChartData","round","results","binned","errorRounded","maxX","filterFn","flat","threshold","starterBin","g","Tooltip","ChartContainer","reducePropWithFn","propKey","cumulative","v","d","Thresholds","maxXValue","maxYValue","minXValue","minYValue","yCount","count","set","toString","Threshold","xScale","yScale","nodeSize","columnX1","columnY1","columnX2","columnY2","columnCount","minX","minXEdge","maxXEdge","linePadding","columnPolyPoints","outAreaPolyPoints","inLabelX","outLabelX","isNaN","textAnchor","DotPlot","colorFn","bottomLabel","top","bottom","tooltip","node","axisBottom","orient","legend","legendPosition","legendOffset","axisLeft","layers","legends","anchor","direction","translateX","translateY","itemWidth","itemHeight","itemsSpacing","symbolSize","symbolShape","effects","on","itemTextColor","itemBackground","StyledChartTitle","WaffleDot","borderWidth","borderColor","onHover","onLeave","onMouseEnter","onMouseMove","onMouseLeave","Waffle","rows","columns","cellComponent","fillDirection","emptyColor","PieCenterTotal","dataWithArc","centerX","centerY","dominantBaseline","Pie","showTotal","innerRadius","enableRadialLabels","padAngle","cornerRadius","sliceLabel","sliceLabelsTextColor","LegendPart","colorPosition","swatch","borderRadius","justifyContent","Legend","gridTemplateColumns","negativeBelowThreshold","positiveBelowThreshold","negativeAboveThreshold","positiveAboveThreshold","FlexDiv","FlexColumns","FlexRows","ThresholdChartSet","models","dotPlotMaxX","sliderLabel","setThreshold","dotPlotColorFn","legendModel","dotPlotWidth","smallChartHeight","dotPlot","truePositive","positive","Colors","LegendModel","ChartModels","ExperimentThresholdChartSet","defaultThreshold","thresholdPercent","rawData","setRawData","setModels","setDotPlotMaxX","result","error","getRawData","_dotPlotData","_threshold","toNoiseImage","StyledImageTile","StyledImageTileImage","rounded","StyledImageLabel","ImageTile","ImageTiles","tileSize","ImageNoise","imageSetNumber","rawImages","setRawImages","setImages","noiseLevelRange","setNoiseLevelRange","_rawImages","getImageData","noisyImages","sliderMin","sliderMax","Model","tagSize","StyledImg","Image","details","imageWidth","onSelect","hovered","setHovered","onMouseOut","boxShadow","Images","Tag","ImageClasses","setSelected","alignItems","alignContent","minSize","maxSize","renderer","tag","customRenderer","yValues","arrows","defaultCircleProps","circleProps","override","Column","TargetModelArrow","col","lineY","yValue","lineEndX","markerEnd","TargetModelDiagram","additionalShapes","xmlns","markerWidth","markerHeight","refX","refY","c","Input","Inputs","inputs","StyledOutputDiagram","OutputDiagram","boxStyle","heightOffset","ry","font","Output","Outputs","maxHeight","lineColors","HACK_lineLabels","LineLabel","inputImages","ActionButton","Buttons","actionDisabled","InputOutput","inputCount","setInputCount","linesOld","lines","setLines","drawLines","_lines","lineOptions","startAnchor","offset","rightness","delta","minWidth","maxWidth","TargetModel","RowFlexContainer","valign","defaultLinkConfig","head","FlowCharts","validate","elements","issues","hasPosition","hasPositionedElements","hasUserDefinedLinks","buildLinks","l","config","StyledFlowChartElement","FlowChart","startAnimating","visible","chainLinkAnimation","betweenLinkDelay","shouldAnimate","setLinks","linkId","containerStyle","flex","elementStyle","element","startSocket","endAnchor","endSocket","headSize","ImageTitle","Scroller","ScrollerContainer","ScrollContainer","ScrollyHeaderSection","h2","ScrollyContentSection","ScrollyImageSectionContainer","ScrollySectionWithBackgroundImage","sizePercent","imageOpacity","progress","WeaknessWithAI","stepOpacityStyle","LabelTile","PuppiesToFoodFlowChart","PuppiesVsCroissantsImages","before","after","slider","VerticalSpacer","PuppiesOrFoodImage","cover","Covers","securityPrivacyConcerns","clipPath","hoverShape","hoverTexture","hoverColor","_default","StyledHoverLink","HoverLink","offHover","PuppiesOrFoodHoverLink","setCover","StepContainer","PuppiesOrFoodStepContainer","currentView","viewName","PuppiesOrFood","setCurrentView","flexBasis","onStepEnter","onStepExit","TitledElement","MiaFlowChart","endLabel","MembershipInferenceAttack","ModelInversionAttack","ReverseEngineeringDataPrototypes","DotMatrix","ExperimentThresholdCharts","DebuggerTitle","Debugger","viewState","hide","zIndex","Story","debugScrolling","currentViewState","setCurrentViewState","setViewState","view","onStepProgress","debug","Modal","setAppElement","PageHeader","subtitle","fontWeight","GameModal","withRouter","history","isModalOpen","setModalOpen","toggleModal","isOpen","onRequestClose","contentLabel","alwaysShowTitle","mainButtonStyles","location","hash","scrollTo","behavior","GameView","App","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"qNAEaA,EAAcC,0BAEdC,EAAsB,SAACC,GAAW,IAAD,EACJC,mBAAS,CAC/CC,QAAS,CACP,CAAEC,KAAM,MAAOC,MAAO,QAASC,WAAY,GAAIC,MAAO,MACtD,CACEH,KAAM,SACNC,MAAO,MACPC,WAAY,GACZC,MAAO,OAGXC,OAAQ,GACRC,uBAAwB,GACxBC,cAAe,KAb2B,mBACrCC,EADqC,KACvBC,EADuB,KAgB5C,OACE,cAACd,EAAYe,SAAb,CAAsBC,MAAO,CAACH,EAAcC,GAA5C,SACGX,EAAMc,Y,m1CCpBKC,IAAOC,IAAV,KAYDD,IAAOC,IAAV,KAOWD,IAAOC,IAAV,KAKND,IAAOC,IAAV,KAIGD,IAAOC,IAAV,KAQaD,IAAOC,IAAV,KAGND,IAAOC,IAAV,KAIID,IAAOC,IAAV,KA3CZ,IAmDaC,EAAgB,SAACC,EAAQC,GAAT,OAC3BD,EAAOZ,MACH,CACEA,MACEa,EAAgB,EAAhB,UAAuBD,EAAOZ,MAA9B,YAAuCa,GAAkBD,EAAOZ,MAClEc,WACED,EAAgB,GACVD,EAAOZ,MAAQa,EAAiB,KAAKE,UACvC,MAER,M,iBC2BAC,EAAS,SAACC,EAAOC,GAAR,OACbD,EACGE,KAAI,SAACC,GAAD,MAAQ,CAAEA,IAAGC,EAAGC,KAAKC,aACzBC,MAAK,SAACC,EAAGC,GAAJ,OAAUD,EAAEJ,EAAIK,EAAEL,KACvBF,KAAI,SAACM,GAAD,OAAOA,EAAEL,KACbO,MAAM,EAAGT,GAAQD,EAAMW,SAKtBC,EAAe,SAACC,GAGpB,OAAOC,OAAOC,KAAKF,GAAKG,QACtB,SAACC,EAAKd,GAAN,mBAAC,eACIc,GADL,kBAEGd,IAL8Be,EAKAL,EAAIV,KAJzB,SAANe,GAAsB,UAANA,EAA8CA,EAAT,SAApBA,EAAEC,gBADT,IAACD,IAOjC,KAISE,EAAc,SAACjB,GAAD,OACzBW,OAAOC,KAAKZ,GAAK,IACdkB,QAAO,SAACC,GAAD,OAASnB,EAAEmB,MAClBN,QAAO,SAACC,EAAKK,GAAN,mBAAC,eAAmBL,GAApB,kBAA0BK,EAAMnB,EAAEmB,OAAS,KAKjDC,EAAY,SAACC,GAAD,OAChBA,EAAKR,QAAO,SAACC,EAAKd,GAAN,mBAAgB,IAAIsB,IAAJ,sBAAYR,GAAZ,YAAqBd,EAAEuB,QAAU,SAAQ,KAEjEC,EAAc,SAAC3C,EAAQ4C,GAI3B,OAAO5C,EAAOqC,QAAO,SAAClB,GAAD,OAAOA,EAAEuB,QAAUvB,EAAEuB,OAAOG,SAASD,OAG/CE,EAAQ,uCAAG,wDAAAtB,EAAA,8FAGpB,GAHoB,IACtBuB,YADsB,MACf,wBADe,MAEtBC,UAEMC,GAFND,OAFsB,MAEV,KAFU,GAIK,qDACuBA,EADvB,QAEvBD,EANkB,SAOGG,MAAMD,GAPT,cAOhBE,EAPgB,gBAQHA,EAAWC,OARR,cAQhBZ,EARgB,OAShBa,EAAcb,EAAKtB,IAAIU,GATP,kBAUf,CACL0B,gBAAiBf,EAAUc,GAAarB,QACtC,SAACC,EAAKd,GAAN,mBAAC,eAAiBc,GAAlB,kBAAwBd,EAAIwB,EAAYU,EAAalC,OACrD,IAEFoC,YAAaxC,EAAOsC,EA/CQ,MAgCR,4CAAH,qDAmBRG,EAAS,uCAAG,sBAAAhC,EAAA,+EAAa,CACpC,mBAAoB,CAClBiC,MAAO,CACLC,KAAM,CACJ,wDACA,4CACA,4CACA,4CACA,6CAEFC,KAAM,CACJ,gEACA,oDACA,oDACA,oDACA,uDAIN,mBAAoB,CAClBF,MAAO,CACLC,KAAM,CACJ,uDACA,2CACA,2CACA,2CACA,4CAEFC,KAAM,CACJ,+DACA,mDACA,mDACA,mDACA,sDAIN,oBAAqB,CACnBF,MAAO,CACLC,KAAM,CAAC,yDACPC,KAAM,CAAC,mEAGX,mBAAoB,CAClBF,MAAO,CACLC,KAAM,CAAC,wDACPC,KAAM,CAAC,kEAGX,qBAAsB,CACpBF,MAAO,CACLC,KAAM,CAAC,0DACPC,KAAM,CACJ,sEAIN,oBAAqB,CACnBF,MAAO,CACLC,KAAM,CAAC,yDACPC,KAAM,CAAC,mEAGX,kBAAmB,CACjBF,MAAO,CACLC,KAAM,CACJ,uDACA,2CACA,2CACA,2CACA,4CAEFC,KAAM,CACJ,+DACA,mDACA,mDACA,mDACA,sDAIN,oBAAqB,CACnBF,MAAO,CACLC,KAAM,CACJ,6CACA,6CACA,6CACA,8CAEFC,KAAM,CACJ,qDACA,qDACA,qDACA,wDAIN,mBAAoB,CAClBF,MAAO,CACLC,KAAM,CACJ,4CACA,4CACA,4CACA,6CAEFC,KAAM,CACJ,oDACA,oDACA,oDACA,uDAIN,oBAAqB,CACnBF,MAAO,CACLG,MAAO,CAAC,qBAAsB,qBAC9BF,KAAM,CACJ,yDACA,6CACA,6CACA,6CACA,8CAEFC,KAAM,CACJ,iEACA,qDACA,qDACA,qDACA,wDAIN,oBAAqB,CACnBF,MAAO,CACLC,KAAM,CACJ,6CACA,6CACA,6CACA,8CAEFC,KAAM,CACJ,qDACA,qDACA,qDACA,0DAhJiB,2CAAH,qDAsJTE,EAAY,SAAC1C,GAAD,OAAa,OAANA,QAAoB2C,IAAN3C,G,0BC3SjC4C,EAAQ,SAAClC,GAAD,OACnBC,OAAOC,KAAKF,GACTQ,QAAO,SAAC2B,GAAD,OAAiB,MAAVnC,EAAImC,MAClBhC,QAAO,SAACR,EAAGwC,GAAJ,mBAAC,eAAexC,GAAhB,kBAAoBwC,EAAInC,EAAImC,OAAO,KAElCC,EAAW,SAACC,EAAQC,GAC/B,IAAM1D,EAAMyD,IACZpC,OAAOC,KAAKoC,GAAOC,SAAQ,SAACJ,GAAD,OAAQvD,EAAI0D,MAAMH,GAAKG,EAAMH,OAG7CK,EAAQ,SAAClD,GAAD,OAAa,OAANA,QAAoB2C,IAAN3C,GAG7BmD,EAAU,SAACC,GAAD,OACrB,YAAIA,GAAKC,aACP,SACEC,EACAC,EACAC,EACAC,GAJF,OAKMH,EAAII,KAAKD,EAAEE,OAAO,EAAKzD,KAAKC,SAAWsD,EAAEjD,OAAS,GAAG,IAAK8C,IAChE,KAOSM,GAJQC,QAAQC,IAAIC,KAAKF,SAIpB,uCAAG,WAAOG,EAAKC,GAAZ,mBAAA5D,EAAA,sDACb6D,EAAQ,SAACC,GAAD,OACZ,IAAIC,SAAQ,SAACC,GACXC,YAAW,WACTD,MACCF,OALY,cAQLH,GARK,gEAQVhE,EARU,oBAUXkE,EAAMD,GAAY,GAVP,sMAAH,yD,ugBCxBlB,IAAMM,EAAqBlF,IAAOC,IAAV,KASlBkF,EAAe,SAAC,GAAD,IAAGpF,EAAH,EAAGA,SAAH,OACnB,cAACmF,EAAD,UAAqBnF,KAGjBqF,GAA0BpF,IAAOqF,OAAV,KA+BdC,GAjBY,SAAC,GAAmD,IAAjDvF,EAAgD,EAAhDA,SAAgD,IAAtCwF,mBAAsC,MAAxB,IAAwB,EAAnBC,EAAmB,EAAnBA,aACnDC,EDUoB,UCVF,WDUE,OACdC,KAAKC,OADS,OACD9E,KAAK+E,MAAsB,IAAhB/E,KAAKC,WCVzC,OACE,qCACE,cAAC,IAAD,CACE2E,GAAIA,EACJI,WAAY,kBAAM,cAAC,EAAD,UAAe9F,KACjC+F,OAAO,QACPC,MAAM,WAER,cAACX,GAAD,CAAyBY,WAAUP,EAAIQ,YAAA,EAAStC,MAAO6B,EAAvD,SACGD,Q,s9ECnCT,IAAMW,GAAgBlG,IAAOC,IAAV,MAMbkG,GAAgBnG,IAAOC,IAAV,MAONmG,GAAW,SAAC,GAAD,IAAGrG,EAAH,EAAGA,SAAH,OACtB,cAACmG,GAAD,UACE,cAACC,GAAD,UAAgBpG,OAIdsG,GAA8BrG,IAAOC,IAAV,MAO3BqG,GAActG,IAAOqF,OAAV,MACD,gBAAGkB,EAAH,EAAGA,QAASC,EAAZ,EAAYA,gBAAZ,OACZD,EAAUC,EAAkB,UAErB,gBAAGD,EAAH,EAAGA,QAASlH,EAAZ,EAAYA,MAAZ,OAAyBkH,EAAUlH,EAAQ,UAGnC,qBAAGoH,KAAmB,cAAgB,iBAItC,qBAAGF,QACN,qBAAuB,4BAI1BG,GAAe,SAAC,GAOtB,IAAD,IANJC,iBAMI,MANQ,MAMR,MALJC,kBAKI,MALS,KAKT,EAJJC,EAII,EAJJA,YACAC,EAGI,EAHJA,aACAC,EAEI,EAFJA,SACAC,EACI,EADJA,aAEA,OACE,eAACX,GAAD,WACE,cAAC,GAAD,CACEE,QAASlD,EAAU2D,IAAiBA,EACpCR,gBAAiBK,EACjBI,QAAS,kBAAMF,GAAS,IACxBN,MAAM,EAJR,SAMGE,IAEH,cAAC,GAAD,CACEJ,QAASlD,EAAU2D,KAAkBA,EACrCR,gBAAiBM,EACjBG,QAAS,kBAAMF,GAAS,IACxBG,OAAO,EAJT,SAMGN,QAYIO,GAAanH,IAAOqF,OAAV,MAoBV+B,GAAQ,SAAC,GAAyC,IAAvCC,EAAsC,EAAtCA,UAAW1D,EAA2B,EAA3BA,MAAO2D,EAAoB,EAApBA,MAAOC,EAAa,EAAbA,OACzCC,EAAUC,MAAMC,QAAQH,GAAUA,EAAS,CAACA,GAClD,OACE,sBAAMF,UAAWA,EAAW1D,MAAOA,EAAOgE,KAAK,MAAMC,aAAYN,EAAjE,SACGE,EAAQ9G,KAAI,SAACC,GAAD,OAAOkH,OAAOC,cAAcnH,SAKlCoH,GAAU/H,IAAOC,IAAV,MAId+H,GAAoBhI,IAAOC,IAAV,MAKVgI,GAAejI,IAAOC,IAAV,MACrB,oBAAGiI,SAAH,MACa,cADb,MAAc,MAAd,GACA,8CAKEC,GAAanI,IAAOC,IAAV,MAOVmI,GAAcpI,IAAOC,IAAV,MAaJoI,GAAc,SAAC,GAUrB,IATLvI,EASI,EATJA,MACAwI,EAQI,EARJA,IACAC,EAOI,EAPJA,IACAC,EAMI,EANJA,SACA7E,EAKI,EALJA,MAKI,IAJJ8E,YAII,MAJG,EAIH,MAHJnB,aAGI,MAHI,KAGJ,MAFJoB,qBAEI,MAFY,MAEZ,EADJC,EACI,EADJA,YAEMC,EAAStB,EACb,cAACW,GAAD,CAAcC,SAAUQ,EAAxB,SAAwCpB,IACtC,KACJ,OACE,eAACU,GAAD,CAAmBrE,MAAOA,EAA1B,UACGiF,GAA4B,QAAlBF,EAA0BE,EAAS,KAC9C,cAAC,QAAD,CACEH,KAAMA,EACNH,IAAKA,EACLC,IAAKA,EACLM,OAAQ,CAAC/I,GACT0I,SAAU,SAACK,GAAY,IACdC,EADa,YACHD,EADG,MAEhBC,IAAWhJ,GACb0I,EAASM,IAGbC,YAAa,gBAAG9J,EAAH,EAAGA,MAAOc,EAAV,EAAUA,SAAV,OACX,cAACoI,GAAD,2BAAgBlJ,GAAhB,aAAwBc,MAE1BiJ,YAAa,gBAAG/J,EAAH,EAAGA,MAAH,OACX,cAACmJ,GAAD,2BAAiBnJ,GAAjB,IAAwB0E,MAAOgF,EAA/B,SACG7I,QAIN8I,GAA4B,WAAlBF,EACT,qBAAK/E,MAAO,CAAEsF,UAAW,IAAzB,SAAgCL,IAEhC,qBAAKjF,MAAO,CAAEuF,OAAQ,SAMxBC,GAAkBnJ,IAAOC,IAAV,MASRmJ,GAAY,SAAC,GAAD,IAAGrJ,EAAH,EAAGA,SAAUsJ,EAAb,EAAaA,YAAa1F,EAA1B,EAA0BA,MAA1B,OACvB,eAACwF,GAAD,CAAiBxF,MAAOA,EAAxB,UACG5D,EACAsJ,EACC,cAAC,GAAD,UAAqBA,IACnB,SAIFC,GAASC,YAAH,MAKNC,GAAkBxJ,IAAOC,IAAV,KAENqJ,IAGFG,GAAe,SAAC,GAKtB,IAAD,IAJJC,aAII,MAJI,GAIJ,MAHJR,cAGI,MAHK,IAGL,MAFJS,mBAEI,MAFU,EAEV,MADJtK,MAEMsE,EAAQ,CACZiG,YAFE,MADI,MACJ,EAGFC,KAAM,OACNF,cACAG,GAAI,EACJC,cAAe,SAEXC,EAA8B,IAAdL,EACtB,OACE,cAACH,GAAD,CAAiB7F,MAAO,CAAE+F,QAAOR,UAAjC,SACE,sBAAKe,QAAO,cAASP,EAAT,YAAkBR,GAA9B,UACE,sBACEvF,MAAOA,EACPhD,EAAGgJ,EACHO,EAAGP,EACHD,MAAOA,EAAsB,EAAdC,EACfT,OAAQA,EAAuB,EAAdS,IAEnB,sBACEQ,GAAIH,EACJI,GAAIJ,EACJK,GAAIX,EAAQM,EACZM,GAAIpB,EAASc,EACbrG,MAAOA,IAET,sBACEwG,GAAIT,EAAQM,EACZI,GAAIJ,EACJK,GAAIL,EACJM,GAAIpB,EAASc,EACbrG,MAAOA,UAOJ4G,GAAmB,SAAC,GAK1B,IAAD,IAJJb,aAII,MAJI,GAIJ,MAHJR,cAGI,MAHK,GAGL,MAFJS,mBAEI,MAFU,EAEV,MADJtK,MAEMsE,EAAQ,CACZiG,YAFE,MADI,QACJ,EAGFC,KAAM,OACNF,cACAa,eAAgB,SAEZC,EAAc,CAAC,GAAD,OACP,GAARf,EADe,YACS,GAATR,GADA,UAEP,IAARQ,EAFe,YAEU,IAATR,GAFD,UAGP,GAARQ,EAHe,YAGS,IAATR,IAEpB,OACE,cAACM,GAAD,CAAiB7F,MAAO,CAAE+F,QAAOR,UAAjC,SACE,sBAAKe,QAAO,cAASP,EAAT,YAAkBR,GAA9B,UACE,wBACEvF,MAAOA,EACP+G,GAAIhB,EAAQ,EACZiB,GAAIzB,EAAS,EACbtI,EAAG8I,EAAQ,EAAI,IAEjB,0BAAU/F,MAAOA,EAAOiH,OAAQH,EAAYI,KAAK,a,q5CChRzD,IAAMC,GACO,CACT5B,OAAQ,GACRQ,MAAO,IAHLoB,GAKE,CACJpB,MAAO,KAILqB,GAAgB,uCAAG,WAAOC,GAAP,mBAAAhK,EAAA,6DAKjBiK,EAJiB,CACrB/H,KAAM,CAAEX,KAAM,yBACdY,KAAM,CAAEZ,KAAM,mCAEqByI,GAAY,QAL1B,SAMC1I,EAAS2I,GANV,cAMjBC,EANiB,OAOjB1L,EAAS0L,EAAUnI,YAAYvB,QACnC,SAACC,EAAKd,EAAGwK,GAAT,mBAAC,eAAoB1J,GAArB,kBAA2B0J,EAAIxK,MAC/B,IATqB,kBAWhB,CACL2B,SAAU4I,EACV1L,SACA4L,eAAgB9J,OAAOC,KAAK/B,GACzBqC,QAAO,SAACsJ,GAAD,OAAO3L,EAAO2L,GAAGE,WACxB3K,KAAI,SAACyK,GAAD,OAAOG,SAASH,QAhBF,2CAAH,sDAoBhBI,GAAa,CACjBC,QAAS,MACTC,SAAU,MACVpM,MAAO,QACPqM,WAAY,mBAgBRC,GAAc,SAACC,EAAKC,GAAN,OAbJ,SAACC,EAAOD,GAA4B,IAArBE,EAAoB,uDAAb,iBAAM,IACpCH,EAAM,CACVI,IAAI,OAAD,OAASF,EAAMvJ,MAClB0J,UAAU,OAAD,OAASH,EAAMvJ,MACxB2J,eAAgBpB,GAAgBpB,MAChCyC,gBAAiBrB,GAAgB5B,OACjC2C,QACAR,QAASS,EAAMT,QACfe,cAAe,cAAC,GAAD,CAAgBP,MAAOA,KAGxC,OADAD,EAAIG,KAAOA,EAAKH,IAAQ,GACjBhK,EAAYgK,GAGnBS,CAAQT,EAAKC,GAAO,SAACS,GAAD,MAAU,CAC5B,CACExM,MAAM,GAAD,OAAK8L,EAAItE,OACdiF,MAAM,eAAD,OAAiBX,EAAItE,aAI1BkF,GAAgB,SAAC7M,GAAD,OACpBA,GAAgBA,EAAaR,SAAWQ,EAAaR,QAAQgC,OACzDxB,EAAaR,QAAQ,GACrB,MAEAsN,GAAuBzM,IAAOC,IAAV,MAOJ,qBAAGoL,QACX,wBAA0B,2BAKlCqB,GAAgB1M,IAAOC,IAAV,MAQb0M,GAAiB,SAAC,GAAe,IAAbd,EAAY,EAAZA,MAAY,EACbe,qBAAW9N,GAA3Ba,EAD6B,oBAE9BkN,EAAOL,GAAc7M,GACrBmN,EAAoBzJ,EAAUwJ,EAAKtN,OACnC8L,EACHwB,EAAKvN,WAAW+C,SAASwJ,IAAUlM,EAAaH,OAAOqM,GAAOR,UAC7DwB,EAAKvN,WAAW+C,SAASwJ,KAAWlM,EAAaH,OAAOqM,GAAOR,QACnE,OACE,cAACoB,GAAD,CACEpB,QAAShI,EAAUwJ,EAAKtN,SAAWI,EAAaH,OAAOqM,GAAOR,QADhE,SAGE,cAACqB,GAAD,UACGI,EACCzB,EACE,cAAC,GAAD,IAEA,cAAC,GAAD,IAEA,UAMN0B,GAAU,SAAC,GAAuC,IAAzBC,EAAwB,EAApCC,SAAYD,MAAShC,EAAe,EAAfA,SAAe,EACb4B,qBAAW9N,GADE,mBAC9Ca,EAD8C,KAChCC,EADgC,KAGrDsN,qBAAU,WACRC,GAAUnC,EAAUrL,EAAcC,KACjC,IAEHsN,qBAAU,WACR,GAAIvN,EAAayN,eAAgB,CAC/B,IAAMC,EAAQ,eAAWL,GAGzBpN,EAAgB,2BACXD,GADU,IAEbH,OAAQG,EAAayN,eAClB1M,KAAI,SAACoL,GAAD,OALU,SAACA,EAAOwB,GAAR,MACjB,aAAcxB,GAASwB,KAAWxB,EAAMyB,SAKpCC,CAAW1B,EAAOuB,GAAYvB,EAAMyB,SAASF,GAAYvB,KAE1DpL,KAAI,SAACoL,EAAOX,GAAR,mBAAC,eACDxL,EAAaH,OAAO2L,IACpBQ,GAAYG,EAAOX,aAI7B,CAAC6B,IAEJ,IAAMS,EAAgB,SAAC5B,GACrB,IAAM6B,EAAO,eAAQ/N,GACfgO,EAAMnB,GAAckB,GAC1B,IAAIC,EAAIpO,MAAR,CACA,IAAIqM,EAAM8B,EAAQlO,OAAOqM,GACrBD,EAAIgC,eAAe,cAAehC,EAAIiC,YAAcjC,EAAIiC,WACvDjC,EAAIiC,YAAa,EACtBF,EAAIrO,WAAaoO,EAAQlO,OACtBkB,KAAI,SAACC,EAAGkL,GAAJ,mBAAC,eAAmBlL,GAApB,IAAuBkL,aAC3BhK,QAAO,SAAClB,GAAD,OAAOA,EAAEkN,cAChBnN,KAAI,SAACC,GAAD,OAAOA,EAAEkL,SAChBjM,EAAgB8N,KAGZC,EAAMnB,GAAc7M,GAC1B,OACE,qBAAKgE,MAAO,CAAEuF,OAAQ,KAAtB,SACE,cAAC,IAAD,CACE1J,OAAQG,EAAaH,OACrBsO,sBAAuBH,EAAIpO,MAC3BkO,cAAeA,EACfM,iBAAkBN,EAClBO,SAAUzC,GACV0C,wBAAwB,EACxBC,gBAAgB,OAMlBf,GAAS,uCAAG,WAAOgB,EAAMC,EAAUC,GAAvB,mBAAArN,EAAA,6DACV0M,EADU,eACKU,GADL,SAEcrD,GAAiBoD,GAF/B,OAEVG,EAFU,OAGhBZ,EAAQY,gBAAkBA,EAC1BZ,EAAQN,eAAiB9L,OAAOC,KAAK+M,EAAgB9O,QAAQkB,KAC3D,SAAC8C,GAAD,OAAO8K,EAAgB9O,OAAOgE,MAEhCkK,EAAQlO,OAASkO,EAAQN,eAAe1M,IAAIiL,KACtCkB,EAAOL,GAAckB,IACtBnO,MAAQ,KACbsN,EAAKvN,WAAa,GAClB+O,EAASX,GAXO,4CAAH,0DA8BTa,GAAiBvO,IAAOC,IAAV,MAYduO,GAAmBxO,IAAOC,IAAV,MAWhBwO,GAAQzO,IAAOC,IAAV,MASLyO,GAAW,SAAC,GAAkD,IAAhD1D,EAA+C,EAA/CA,SAA+C,IAArC2D,yBAAqC,MAAjB,kBAAM,MAAW,IACzB/B,qBAAW9N,GADc,mBAC1Da,EAD0D,KAC5CC,EAD4C,OAE7BV,mBAAS,GAFoB,mBAE1D0P,EAF0D,KAE9CC,EAF8C,OAGvC3P,qBAHuC,mBAG1DK,EAH0D,KAGnDuP,EAHmD,OAInB5P,oBAAS,GAJU,mBAI1D6P,EAJ0D,KAIzCC,EAJyC,KAU3DC,EAAiBtP,EAAaR,QAAQ,GAAGG,WAAW6B,OAe1D,OACE,eAACoN,GAAD,WACE,cAACC,GAAD,UACgB,SAAbxD,EACC,cAAC,GAAD,CACE1D,MAAM,YACNoB,cAAc,SACdJ,IAAK,EACLC,IAAK,EACLE,KAAM,EACN3I,MAAO8O,EACPpG,SA/Be,SAAC0G,GACxBL,EAAcK,GACdP,EAAkB,CAAE3B,MAAOkC,KA8BnBvL,MAAO,CAAE+F,MAAO,UAEhB,OAELqF,EACC,cAAC5H,GAAD,CAAYF,QAvBA,WAChBkG,GAAUnC,EAAUrL,EAAcC,GAClCkP,EAAS,MACTE,GAAmB,IAoBf,yBAEA,cAAC7H,GAAD,CAAYF,QAjCC,WACjB,IAAMyG,EAAO,eAAQ/N,GACfkN,EAAOL,GAAckB,GAC3Bb,EAAKtN,MA9Dc,SAAC+C,EAAUhD,GAChC,IAAM6P,EAAc7P,GAAc,GAC5B8P,EAAeD,EAAYtN,QAC/B,SAAClB,GAAD,OAAQ2B,EAAS8I,eAAe/I,SAAS1B,MAErC0O,EAAiB/M,EAAS8I,eAAevJ,QAC7C,SAAClB,GAAD,OAAQwO,EAAY9M,SAAS1B,MAG/B,OACEW,OAAOC,KAAKe,EAAS9C,QAAQ2B,OAC7BiO,EAAajO,OACbkO,EAAelO,OAkDFmO,CAAe3P,EAAa2O,gBAAiBzB,EAAKvN,YAC/DwP,EAAS5O,EAAc2M,EJpKK,KIqK5BjN,EAAgB8N,GAChBsB,GAAmB,IA2BkBO,SAA6B,IAAnBN,EAA3C,4BAIF,cAACT,GAAD,UACGjP,EACC,eAAC,GAAD,WACGA,EAAMA,MADT,KACkBA,EAAMc,WADxB,QAGE,WAMNmP,GAAaxP,IAAOC,IAAV,MAKVwP,GAAOzP,IAAOC,IAAV,KACK6K,GAAWpB,MACXoB,GAAWpB,OAGpBgG,GAAkB,kBACtB,qCACE,0IAIA,4HAIA,8FACA,yGA0BWC,GAtBS,SAAC,GAAkB,IAAhB3E,EAAe,EAAfA,SAAe,EACR9L,mBAAS,GADD,mBACjC+N,EADiC,KACvB2C,EADuB,KAIxC,OACE,cAAC,GAAD,UACE,cAACJ,GAAD,UACE,eAAC,GAAD,WACE,cAAC,GAAD,CACEnG,YAAa,cAAC,GAAD,IACb1F,MAAO,CAAEkM,aAAc,IAFzB,0BAMA,cAAC,GAAD,CAAS5C,SAAUA,EAAUjC,SAAUA,IACvC,cAAC,GAAD,CAAUA,SAAUA,EAAU2D,kBAbd,SAACmB,GAAD,OAAeF,EAAYE,cC3StCC,GA/BO,WAAM,MAGU7Q,mBAAS,CAC3CwK,WAAOpG,EACP4F,YAAQ5F,IALgB,mBAGnB0M,EAHmB,KAGPC,EAHO,KA4B1B,OApBA/C,qBAAU,WAER,SAASgD,IAEPD,EAAc,CACZvG,MAAOyG,OAAOC,WACdlH,OAAQiH,OAAOE,cAWnB,OANAF,OAAOG,iBAAiB,SAAUJ,GAGlCA,IAGO,kBAAMC,OAAOI,oBAAoB,SAAUL,MACjD,IAEIF,G,q9CCrBT,IAAMlF,GACE,CACJ5B,OAAQ,IACRQ,MAAO,KAIL8G,GAAqBxQ,IAAOC,IAAV,KACZ6K,GAAW5B,OACZ4B,GAAWpB,OAGA,gBAAGsC,EAAH,EAAGA,IAAH,oBAAoBA,EAApB,QAIhByE,GAAuBzQ,YAAOwQ,GAAPxQ,CAAH,MAIpB0Q,GAAiB,SAAC,GAOjB,IANL7E,EAMI,EANJA,MACAC,EAKI,EALJA,MAEA6E,GAGI,EAJJC,QAII,EAHJD,eACApB,EAEI,EAFJA,SAEI,IADJsB,eACI,MADM,kBAAM,MACZ,EACEC,EAAW,mBAAejF,GAD5B,EAE2BkF,cAAQ,iBAAO,CAC5CC,KAAM,YACNC,KAAM,CAAE7R,KAAM0M,GACdoF,IAAK,SAACD,EAAME,GACV,IAAMC,EAAaD,EAAQE,gBACvBJ,GAAQG,GACVP,EAAQC,EAAa,CACnBQ,MAAOX,IAAkBS,EAAWhS,KACpCmS,OAAQ,CAAE9L,GAAIqL,EAAalF,IAAKqF,EAAK7R,MACrCoS,OAAQ,CAAE/L,GAAI2L,EAAWhS,KAAMwM,IAAKwF,EAAWhS,SAIrDqS,QAAS,SAACN,GAAD,MAAc,CACrBO,WAAYP,EAAQO,mBAhBpB,mBAEKA,EAFL,KAEKA,WAAcC,EAFnB,KAmBEC,EAAUF,EAAa,GAAM,EACnC,OACE,cAACjB,GAAD,CACEhL,GAAIqL,EACJnJ,KAAK,YACLqE,IAAG,oBAAeF,GAClB+F,IAAK/F,EACLgG,IAAKvC,EAAW,KAAOoC,EACvBhO,MAAO,CAAEiO,cAKTG,GAAqB/R,IAAOC,IAAV,MAQlB+R,GAAsBhS,YAAOwQ,GAAPxQ,CAAH,MAKnBiS,GAAkB,SAAC,GAA4B,IAA1BxM,EAAyB,EAAzBA,GAAIqG,EAAqB,EAArBA,MAAOoG,EAAc,EAAdA,QAAc,EACdC,cAAQ,WAC1C,MAAO,CACLC,OAAQ,YACRC,KAAM,iBAAO,CAAEjT,KAAMqG,IACrBgM,QAAS,SAACN,GAAD,MAAc,CACrBmB,OAAQnB,EAAQmB,SAChBC,QAASpB,EAAQoB,gBAP2B,0BACzCA,EADyC,EACzCA,QAASD,EADgC,EAChCA,OAAUD,EADsB,KAW5CG,EAAWD,GAAWD,EACtBG,GACJnR,OAAOuH,OAAOqJ,GAASQ,MAAK,SAAC/R,GAAD,OAAOA,EAAEgS,GAAGlN,KAAOA,MAAO,CACpDgN,KAAM,OAERA,KAEIjM,EAAkBiM,EACpB,KACAD,EACA,OACAD,EACA,OACA,QAEJ,OACE,sBAAK5O,MAAO,CAAEiP,QAAS,OAAQC,cAAe,OAA9C,UACE,cAACb,GAAD,CACEvM,GAAIA,EACJqM,IAAKO,EACL1O,MAAO,CACL6C,kBACAsM,gBAAiBL,EAAI,wBAAoBA,EAAK7G,IAAzB,KAAkC,QAG3D,cAAC4E,GAAD,CACExE,IAAG,oBAAeF,GAClB+F,IAAK/F,EACLnI,MAAO,CACLoP,WAAY,UAOhBC,GAAgBhT,IAAOC,IAAV,MAWbgT,GAAQ,SAACtS,EAAGkL,GAAJ,gBAAiBlL,EAAjB,YAAsBkL,IAE9BqH,GAAgBlT,IAAOC,IAAV,MAIbyP,GAAkB,kBACtB,qCACE,oGACA,wEACA,yGAGA,4BACE,+EAEF,0BAIEyD,GAAW,CACf/P,MAAO,CAAEmJ,MAAO,iBAAkB6G,WAAY,GAC9ClQ,KAAM,CAAEqJ,MAAO,kBAAmB6G,WAAY,GAC9CjQ,KAAM,CAAEoJ,MAAO,kBAAmB6G,WAAY,EAAGC,YAAa,IAG1DjN,GAAWpG,IAAOC,IAAV,MAKRqT,GAAa,SAAC,GAAD,IAAGC,EAAH,EAAGA,QAAH,OACjB,mCACE,qBAAK5P,MAAO,CAAE6P,UAAW,SAAUtK,OAAQ,IAAKD,UAAW,GAA3D,SACG,IAAIxB,MAAM8L,EAAQE,WAAW5J,OAAOnJ,KAAI,SAACwD,EAAGiH,GAAJ,OACvC,cAAC,GAAD,yBAAkCA,YAMpCuI,GAAc1T,IAAOqF,OAAV,MAOK,qBAAGsO,IAAiB,QAAU,eAQ9CC,GAAU,SAAC,GAAsC,IAApCL,EAAmC,EAAnCA,QAASM,EAA0B,EAA1BA,WAAYC,EAAc,EAAdA,QAAc,EAC9B5U,oBAAS,GADqB,mBAC7CyU,EAD6C,KACxCI,EADwC,OAEhB7U,mBAAS,MAFO,mBAE7C8U,EAF6C,KAEjCC,EAFiC,KAepD,OAZA/G,qBAAU,WACR,IAKMyG,EAJJJ,EAAQW,MAAQ,GAChB5S,OAAOC,KAAKgS,EAAQlI,SAASxJ,QAAO,SAAClB,GAAD,OAAO4S,EAAQlI,QAAQ1K,MAAIQ,SAC7DoS,EAAQW,MAGZH,EAAOJ,GACP,IAAMQ,EAHcZ,EAAQE,WAAaF,EAAQa,WAG1B,aAAeT,EAAM,uBAAyB,KACrEM,EAAcE,GACVA,GAAMN,MACT,CAACN,EAASM,IACNG,EACL,cAAC,GAAD,UACE,cAACN,GAAD,CAAazM,QAAS6M,EAASH,IAAKA,EAApC,SACGK,MAGH,MAGAK,GAAc,SAAC,GAAkD,IAAhDC,EAA+C,EAA/CA,MAAOtJ,EAAwC,EAAxCA,SAAU8I,EAA8B,EAA9BA,QAA8B,IAArBM,kBAAqB,MAAR,EAAQ,EACpErE,KADoE,MAEpC7Q,oBAAS,GAF2B,mBAE7DqQ,EAF6D,KAEnDgF,EAFmD,KAa9D/U,EAASgV,mBAAQ,kBAAOF,GAAS,IAAI9U,QAAU,KAAI,CAAC8U,IACpDG,EAAUD,mBAAQ,kBAAMlT,OAAOuH,OAAOrJ,GAAQqC,QAAO,SAAClB,GAAD,OAAOA,OAAI,CACpEnB,IAEIkV,EAAYF,mBAAQ,kBAAM1Q,EAAQxC,OAAOC,KAAK/B,MAAU,CAACA,IAjBK,EAkBtCN,mBAAS,IAlB6B,mBAkB7DgT,EAlB6D,KAkBpDyC,EAlBoD,KAoB9DC,EAAeC,uBACnB,iBAAO,CACLT,aACAF,MAAOO,EAAQtT,OACfkK,QAAS,GACToI,UAAW,KAEb,CAACgB,EAASL,IAGZlH,qBAAU,WACRqH,GAAY,GACZO,EAAWF,OACV,CAACN,EAAOM,IAjCyD,MAmCtC1V,mBAAS0V,KAnC6B,mBAmC7DrB,EAnC6D,KAmCpDuB,EAnCoD,KAoC9DjE,EAAU,SAACkE,EAAD,GAA0C,IAA7BzD,EAA4B,EAA5BA,MAAOC,EAAqB,EAArBA,OAAQC,EAAa,EAAbA,OAC1CmD,GAAW,SAACK,GAAD,mBAAC,eACPA,GADM,kBAERD,EAAW,CACVtC,KAAMlB,EACNoB,GAAInB,EACJnS,MAAOiS,EAAQ,QAAU,YAG7BwD,GAAW,SAACE,GAAD,mBAAC,eACPA,GADM,IAET3J,SACY,IAAViG,EAAA,2BACS0D,EAAK3J,SADd,kBACwB0J,EAAWzD,IACrB,OAAVA,EAAA,2BACK0D,EAAK3J,SADV,kBACoB0J,GAAW,IAC/BC,EAAK3J,QACXoI,WACY,IAAVnC,EACIzQ,KAAKyH,IAAI0M,EAAKvB,UAAY,EAAGuB,EAAKd,OAClCc,EAAKvB,gBAIf,OACE,eAAC1B,GAAD,WACE,cAAC,GAAD,UACG0C,EAAQ/T,KAAI,SAACC,EAAGwK,GAAJ,OACX,cAAC,GAAD,CAEEU,MAAOV,EACPW,MAAOnL,EACPiQ,QAAS0D,EAAM1D,QACfrB,SAAUA,EACVmF,UAAWA,EACX/D,eApEY7E,EAoEgBnL,EAnEpCW,OAAOC,KAAK+S,EAAM9U,QAAQkT,MAAK,SAAC5Q,GAAD,OAASwS,EAAM9U,OAAOsC,KAASgK,MAoEtD+E,QAASA,GAPJoC,GAAMtS,EAAGwK,IA9DH,IAACW,OAyElB,eAACoH,GAAD,WACE,cAAC,GAAD,CAAYK,QAASA,IACrB,cAAC,GAAD,CAAWlK,YAAa,cAAC,GAAD,IAAxB,SACG8J,GAASnI,GAAUuB,OAAS,eAE/B,cAAC,GAAD,CAASgH,QAASA,EAASO,QA1EhB,WACfgB,EAAWF,KACXD,EAAW,IACXb,KAuEkDD,WA3EjC,kBAAMU,GAAY,SAACrQ,GAAD,OAAO,WA6ExC,cAAC,GAAD,UACGwQ,EAAUhU,KAAI,SAACC,EAAGwK,GAAJ,OACb,cAAC,GAAD,CAEE1F,GAAI9E,EACJmL,MAAOnL,EACPuR,QAASA,GAHJe,GAAMtS,EAAGwK,SAHA,IAAIzF,MAAOuP,WAU9B3T,OAAOuH,OAAOqJ,GAASxR,KAAI,SAACC,GAAD,OAC1B,cAAC,KAAD,CAEEuU,MAAK,UAAKvU,EAAE8R,KAAKhN,IACjByL,IAAG,UAAKvQ,EAAEgS,GAAGlN,IACbpG,MAAOsB,EAAEtB,MACTkD,KAAK,WACL4S,eAAe,SANjB,eACexU,EAAE8R,KAAKhN,GADtB,YAC4B9E,EAAEgS,GAAGlN,YA0E1B2P,GA9DD,SAAC,GAIR,IAAD,IAHJpK,gBAGI,MAHO,OAGP,MAFJoI,kBAEI,MAFSD,GAASnI,GAAUoI,WAE5B,MADJC,mBACI,MADUF,GAASnI,GAAUqI,aAAeF,GAASnI,GAAUoI,WAC/D,IAC0BlU,mBAAS,GADnC,mBACGmW,EADH,KACYC,EADZ,OAEsBpW,mBAAS,IAF/B,mBAEGoV,EAFH,KAEUiB,EAFV,OAG8BrW,mBAAS,IAHvC,mBAGGsW,EAHH,KAGcC,EAHd,KAIEC,EAAab,uBAAY,WAC7B,IAAMc,EAAU7R,EAAQxC,OAAOC,KAAKiU,IAAYtU,MAAM,EAAGmS,GAQzD,OAAOsC,EAAQnU,QACb,SAACC,EAAKd,EAAGwK,GACP,OAAO,2BACF1J,GADL,IAEEjC,OAAO,2BACFiC,EAAIjC,QADH,kBAEHmB,EAAIwK,EAAIiI,GAbGtR,EAaqBnB,EAZhC6U,EAAU1T,GAAKmB,MAAM+H,GACxBwK,EAAU1T,GAAKmB,MAAM+H,GAAU7J,OAC7B2C,EAAQ0R,EAAU1T,GAAKmB,MAAM+H,IAAW9J,MAAM,EAAG,GAAG,GACpD,KACFY,GAQwC,SAb3B,IAACA,IAiBlB,CAAE8O,QAASyE,MAEZ,CAACG,EAAWpC,EAAYiC,EAASrK,EAAUqI,IAe9C,GAbAnG,qBAAU,YACU,uCAAG,4BAAAlM,EAAA,sEACMgC,IADN,OACb4S,EADa,OAEnBH,EAAaG,GAFM,2CAAH,qDAKlBC,KACC,IAEH3I,qBAAU,WACRqI,EAASG,OACR,CAACL,EAASK,IAETtC,EAAaC,EACf,OAAO,2EAIT,OACE,cAACyC,GAAA,EAAD,CAAaC,QAASC,KAAtB,SACE,cAAC,GAAD,CACE1B,MAAOA,EACPtJ,SAAUA,EACV8I,QANY,kBAAMwB,GAAW,SAACN,GAAD,OAAUA,EAAO,MAO9CiB,YAAa7C,EACbC,YAAaD,O,m5IC5WrB,IAAM8C,GACO,CACTxM,MAAO,IACPR,OAAQ,KAHNgN,GAKG,CACLxM,MAAO,IACPR,OAAQ,KAINiN,GAAU,QACVC,GACC,UADDA,GAEA,UAIAjJ,GAAS,uCAAG,WAAOiB,EAAUC,EAAUgI,EAAiBC,GAA5C,iBAAAtV,EAAA,6DACV0M,EADU,eACKU,IACbmI,QAAUlT,EAAUqK,EAAQ6I,SAAW7I,EAAQ6I,QAAU,EAAI,EACrE7I,EAAQ8I,oBAAsBF,EAC1B,EACgC,IAAhC5I,EAAQ8I,oBACR,EACA,EACJhS,QAAQC,IAAR,kCAAuCiJ,EAAQ8I,sBAR/B,SASczL,GAAiB2C,EAAQ8I,qBATvC,OASVlI,EATU,OAUZZ,EAAQhO,eAAiB4B,OAAOC,KAAKmM,EAAQhO,eAAeyB,QAC9DuM,EAAQjO,uBAAuB4E,KAA/B,eAAyCqJ,EAAQhO,gBAEnDgO,EAAQY,gBAAkBA,EAC1B+H,EAAgB,GAChB3I,EAAQhO,cAAgB4O,EAAgBmI,gBAAgBjV,QACtD,SAACC,EAAKd,EAAGwK,GAAT,mBAAC,eACI1J,GADL,kBAEGd,EAAE4B,KAFL,eAEiB5B,OAEjB,IAEF0N,EAASX,GAtBO,4CAAH,4DAyBT3C,GAAgB,uCAAG,WAAOyL,GAAP,mBAAAxV,EAAA,sEACCsB,IADD,cACjB4I,EADiB,OAEjB1L,EAAS0L,EAAUpI,gBAAgB0T,GAAqBhV,QAC5D,SAACC,EAAKd,EAAGwK,GAAT,mBAAC,eAAoB1J,GAArB,kBAA2B0J,EAAIxK,MAC/B,IAEI8V,EAAkBnV,OAAOC,KAAK/B,GAAQkB,KAAI,SAACyK,GAAD,mBAAC,eAC5C3L,EAAO2L,IADoC,IAE9CuL,IAAI,OAAD,OAASlX,EAAO2L,GAAG5I,WARD,kBAUhB,CACLD,SAAU4I,EACV1L,SACAiX,kBACArL,eAAgB9J,OAAOC,KAAK/B,GACzBqC,QAAO,SAACsJ,GAAD,OAAO3L,EAAO2L,GAAGE,WACxB3K,KAAI,SAACyK,GAAD,OAAOG,SAASH,QAhBF,2CAAH,sDAyBhBwL,GAAuB,SAAChX,GAAD,OAC3B2B,OAAOC,KAAK5B,EAAaD,eAAe8B,QACtC,SAACC,EAAKd,GAAN,OAAYc,GAAO4B,EAAU1D,EAAaD,cAAciB,GAAGiW,eAC3D,IAGEC,GAAuB7W,IAAOC,IAAV,MAKJ,SAAChB,GAAD,OAAYA,EAAM6X,QAAU,YAAc,UAI1DC,GAAsB/W,IAAOiB,EAAV,MACd,SAAChC,GAAD,OAAWA,EAAMI,SAEZ,SAACJ,GAAD,OAAYA,EAAM6X,QAAU,KAAO,MAI7CE,GAAiB,SAAC,GAIjB,IAAD,IAHJC,SAAY1U,EAGR,EAHQA,KAAM8I,EAGd,EAHcA,QAAgBuL,GAG9B,EAHuBM,MAGvB,EAH8BN,YAClCO,EAEI,EAFJA,eACAC,EACI,EADJA,eAEMC,EAAUhU,EAAUuT,GAErBA,GAAcvL,IAAcuL,IAAevL,EAC5C,UACA,YAHA,UAiBEuH,EAbkB,CACtB0E,QAAS,CACPnD,KAAM,4BAER9I,QAAS,CACP8I,KAAK,YAAD,OAAcgC,GAAd,iBACJ9W,MAAO+W,IAET3C,UAAW,CACTU,KAAK,yBAAD,OAA2BgC,GAA3B,eACJ9W,MAAO+W,KAGqBiB,GAChC,OACE,eAACR,GAAD,CAAsBC,QAASM,EAA/B,UACE,eAACL,GAAD,CACE1X,MAAOuT,EAAQvT,MACfyX,QAASM,EACT7K,MAAOhK,EAHT,mBAKS4U,KAET,8BAAMvE,EAAQuB,WAKdoD,GAAmBvX,IAAOC,IAAV,MAOhBuX,GAAa,SAAC,GAAmB,IAAjBrK,EAAgB,EAAhBA,UAAgB,EACIP,qBAAW9N,GADf,mBAC7Ba,EAD6B,KACfC,EADe,KAQpC,OACE,eAAC2X,GAAD,WACE,cAACpQ,GAAD,CAAYF,QAASkG,EAArB,2BACA,cAAC,KAAD,CAAMwF,GAAG,YAAT,SACE,cAACxL,GAAD,CAAYF,QAVD,WACf,IAAMyG,EAAO,eAAQ/N,GACrB+N,EAAQjO,uBAAuB4E,KAA/B,eAAyCqJ,EAAQhO,gBACjDgO,EAAQhO,cAAgB,GACxBE,EAAgB8N,IAMZ,8BAMF+J,GAAuBzX,YAAO+H,GAAP/H,CAAH,MAcpB0X,GAAuB1X,IAAOC,IAAV,MAUpB0X,GAA0B3X,IAAO4X,GAAV,MAIvBC,GAAkB,SAAC,GAA4C,IAA1C1K,EAAyC,EAAzCA,UAAW2K,EAA8B,EAA9BA,kBAAmBxB,EAAW,EAAXA,KAAW,EAC3C1J,qBAAW9N,GAA3Ba,EAD2D,oBAElE,OACE,eAAC8X,GAAD,WACE,gCACE,eAACC,GAAD,6BACmBpB,EAA0C,KAAnC3W,EAAa6W,uBAEvC,cAACmB,GAAD,+CAGCrW,OAAOC,KAAK5B,EAAaD,eAAegB,KAAI,SAACC,EAAGwK,GAAJ,OAC3C,cAAC,GAAD,CAEEgM,eAAgBhM,EAAI,EACpBiM,eAAgBjM,IAAM2M,EACtBb,SAAUtX,EAAaD,cAAciB,IAHhCwK,SAOX,+BACImL,GAAQK,GAAqBhX,GAC7B,cAAC,GAAD,CAAYwN,UAAWA,IACrB,WAMN4K,GAA4B,SAAC,GAA8B,IAA5BvY,EAA2B,EAA3BA,OAAQwY,EAAmB,EAAnBA,aAAmB,EACvCpL,qBAAW9N,GAA3Ba,EADuD,oBAExDsY,EACI,SAACpM,GAAD,wEACqDA,EAAQ,EAD7D,MADJoM,EAGG,iBACL,uGAkBEC,EAEFhC,GAA0BxM,MAAQwM,GAA8BxM,MAF9DwO,EAIFhC,GAA0BhN,OAASgN,GAA8BhN,OAE/DiP,EAAe,CACnBzO,MAAO4B,SAA2B,IAAlB4M,GAChBhP,OAAQoC,SAA4B,IAAnB4M,IAEbE,GACHlC,GAA8BxM,MAAQwM,GAA0BxM,OAAS,EACtE2O,GACHnC,GAA8BhN,OAASgN,GAA0BhN,QAClE,EASF,OACE,uBACEoP,wBAAyB,CACvBC,OAAQ,sBAhCZ/Y,EAAOkB,KAAI,SAACwD,EAAGiH,GACb,IACiBxK,EADXiW,EAtKG,SAAC4B,EAAU7Y,EAAciM,GAAzB,OACXA,KAAOjM,EAAaD,cAElBC,EAAaD,cAAckM,GAAK4M,GADhC,KAoKmBnB,CAAO,aAAc1X,EAAcH,EAAO2L,GAAG5I,MAEhE,OAZiB,SAACsJ,EAAO4M,GAC3B,IAAMC,EACJV,IAAiBnM,EAAQ,uCAAyC,GACpE,MAAM,GAAN,OAAUoM,EAAiBpM,GAA3B,gCACE4M,EAAO,GADT,wBAEgBC,EAFhB,gBASSC,CAAaxN,EAAG,EADNxK,EACeiW,EADH,MAALjW,EAAY,QAAUA,EAAIyV,GAAaA,UA8BrD,YAVY,CAAC,GAAD,OACrB6B,IADqB,mBACOG,EADP,+BACyCC,EADzC,iCAEtBF,EAAazO,MAFS,iCAItByO,EAAajP,OAJS,sEAU0B2B,KAAK,UAMrD+N,GAA4B5Y,IAAOC,IAAV,MAiBzB4Y,GAAkC7Y,IAAOC,IAAV,MAO/B6Y,GAAe9Y,IAAOC,IAAV,MAGZ8Y,GAAsB,SAAC,GAAD,IAAG9B,EAAH,EAAGA,SAAU+B,EAAb,EAAaA,SAAUhS,EAAvB,EAAuBA,aAAvB,OAC1B,eAAC4R,GAAD,WACE,cAACE,GAAD,UAAe7B,IACf,cAAC4B,GAAD,UACE,cAAC,GAAD,CACE7R,aAAcA,EACdD,SAAUiS,EACVnS,YAAY,QACZC,aAAa,QACbH,UAAU,MACVC,WAAW,aAMbqS,GAAuBjZ,IAAOC,IAAV,MAQpBiZ,GAAiBlZ,IAAOC,IAAV,MAWdkZ,GAAoBnZ,YAAOiZ,GAAPjZ,CAAH,MAIjBoZ,GAAc,SAAC,GAAqC,IAAnCC,EAAkC,EAAlCA,cAAe/R,EAAmB,EAAnBA,MAC9BgS,GAAmB,IAD8B,EAAZxZ,OACbQ,QAAQ,GACtC,OACE,cAAC6Y,GAAD,UACE,cAAC,GAAD,UACE,eAACD,GAAD,WACE,gCACG/C,GADH,SACiB,uBACf,cAACoD,GAAD,CACEC,QAAS3V,EAAMwV,IAAkB/R,IAAU+R,EAD7C,SAGG/R,IACa,IANlB,0BASA,qBAAK3D,MAAO,CAAE8V,OAAQ,iBAAtB,SACE,cAAC,YAAD,CACEC,SAAO,EACPC,OAAQ,IACR3X,KAAM,CACJ,CAAElC,MAAOwZ,EAASja,MAAO,QACzB,CAAES,MAAO,IAAMwZ,EAASja,MAAO,OAAQua,WAAW,IAEpDC,WAAY,IACZC,UAAW,GACXxS,MAAO,gBAAGyS,EAAH,EAAGA,UAAH,OACLA,EAAUH,UAAY,KAAtB,UAAgCG,EAAUja,MAA1C,MAEFyL,WAAY,CACVE,SAAU,SACV5B,KAAM,SAERnB,cAAe,cASvBsR,GAAqBha,YAAOiZ,GAAPjZ,CAAH,MAIlBia,GAAqBja,IAAOC,IAAV,MAMlBia,GAAe,SAACjb,GACpB,IAAMkb,EAAe,CACnBC,UAAW,SAACC,GAAD,mBAAC,eAAmBA,GAApB,IAA8B3Q,MAAO,UAChD4Q,mBAAoB,SAACD,GAAD,mBAAC,eAAmBA,GAApB,IAA8BzH,QAAS,UAC3D2H,OAAQ,SAACF,EAAD,OAAarY,EAAb,EAAaA,KAAb,mBAAC,eACJqY,GADG,IAEN7G,UAAW,OACXgH,WAAY,SACZnb,MAAO,QACPoM,SAAU,SACV,UAAW,CACTgP,QAAQ,GAAD,OAAKzY,EAAK0Y,KAAL,WAAgB1Y,EAAK0Y,KAArB,KAA+B,MAC3ChR,MAAO,OACP8B,QAAS,uBACToH,QAAS,eACTY,UAAW,aAGfmH,KAAM,SAACN,GAAD,mBAAC,eACFA,GADC,IAEJ3Q,MAAO,iBAETkR,YAAa,SAACP,GAAD,mBAAC,eACTA,GADQ,IAEX5O,SAAU,aAId,OAAO,cAAC,KAAD,aAAQoP,OAAQV,EAAcW,cAAc,GAAW7b,KAG1D8b,GAAU,SAAC,GAAgD,IAA9CjP,EAA6C,EAA7CA,MAAOkP,EAAsC,EAAtCA,YAAaC,EAAyB,EAAzBA,mBAC/BC,EAAe,CACnBlO,MAAO,GAFqD,EAIlC9N,mBAASgc,GAJyB,mBAIvDL,EAJuD,KAI/CM,EAJ+C,OAKhBjc,mBAAS,MALO,mBAKvDkc,EALuD,KAKtCC,EALsC,KAMxDC,EAAc,SAACxZ,GAAD,OAClB2B,EAASuX,EAAa,CACpBO,WAAY,OACZ,oBACGV,EAAO/Y,IAAQA,KAAOgK,EAAMyB,UAAY,SAAUzB,EAAMyB,SAASzL,GAAlE,mBACgBgK,EAAMyB,SAASzL,GAAKS,KADpC,yBAEgBuJ,EAAMvJ,KAFtB,SAKAiZ,EAAe,SAAC1Z,GACpB,OAAQgK,EAAMyB,SAASzL,IAAQgK,GAAOxE,OASlCmU,EAAc,SAAC3Z,GAAgC,IAA3B4Z,EAA0B,uDAAP,GACrCC,GAAUd,EAAO/Y,GACvBwZ,EAAYxZ,GACZmZ,EACE1X,EAAM,CACJqY,YAAaD,GACT7Z,KAAOgK,EAAMyB,SACXzB,EAAMyB,SAASzL,GAAK8Z,YAEtB,KACJtU,MAAOkU,EAAa1Z,MAGxBqZ,EAAU,2BAAKD,GAAN,kBAAqBpZ,EAAM6Z,GAAWD,KAK3CG,EAAkBva,OAAOC,KAAKuK,EAAMyB,UAAY,IAAI1L,QACxD,SAAClB,GAAD,OAAQA,EAAEmb,WAAW,YAEjBC,EAAoB,CACxBC,MAAO,CACL1U,MAAO,iBAAM,mBACboT,KAAM,iBAAM,WAEduB,MAAO,CACL3U,MAAO,iBAAM,iBACboT,KAAM,iBAAM,WAEd,OAAQ,CACNpT,MAAO,SAAC3G,GAAD,gBAAUA,EAAEub,QAAQ,MAAO,WAA3B,SACPxB,KAAM,iBAAM,YAIVyB,EAAO,aACPC,EAAW,SAACC,EAAQ7D,EAAU8D,EAAYxa,GAA/B,OACdua,EAAO7D,IAAa8D,EAAW9D,IAAa2D,GAAMra,IA4B/Cya,EAAO,CACX,CACEzc,MAAO,SACPwH,MAAO,SACPkV,GA7Ee,WACjBhY,QAAQC,IAAI,uBACZ6W,EAAY,WACZL,EAAmB,IACnBE,EAAU,eAAKD,OAqEJ,mBAMRW,EAAgBnb,KAhCE,SAACoB,GACtB,IAAM2a,EAAW,CACf3c,MAAOgC,EACPwF,MAAOxF,EACP0a,GAAIf,EAAY/W,KAAK,KAAM5C,IAEzBwa,OAAahZ,EACjB,GAAIxB,KAAOia,EACTO,EAAaP,EAAkBja,OAC1B,CACL,IAAM4a,EAAgBpb,OAAOC,KAAKwa,GAC/Bla,QAAO,SAAClB,GAAD,OAAOA,EAAE0B,SAAS,QACzBqQ,MAAK,SAAC/R,GAAD,OAAOmB,EAAIga,WAAWnb,EAAEub,QAAQ,IAAK,QACzCQ,IACFJ,EAAaP,EAAkBW,IASnC,OALIJ,IACFF,EAASK,EAAU,QAASH,EAAYxa,GACxCsa,EAASK,EAAU,OAAQH,EAAYxa,IAGlC2a,OAYHE,EAAqBrb,OAAOC,KAAKuK,EAAMyB,UAAY,IACtD1L,QAAO,SAAClB,GAAD,OAAOA,EAAEmb,WAAW,YAC3Bpb,KAAI,SAACC,GAAD,OAAO2K,SAAS3K,EAAEub,QAAQ,QAAS,QACpCU,EAAW,CAAI,GAAJ,mBAAUD,IAE3B,OACE,cAAC3C,GAAD,UACE,cAAC,GAAD,UACE,eAACd,GAAD,WACE,cAACjR,GAAD,4BACA,cAACgS,GAAD,UACE,cAAC,GAAD,CACEsC,QAASA,EACTzc,MAAOsb,GAAmBmB,EAAQ,GAClC/T,SAAU,SAAC7H,GACT0a,EAAmB1a,GACnBA,EAAE6b,UAIR,cAAC,GAAD,CACElV,MAAM,aACNmB,KAAM,EACNH,IAAK,EACLC,IAAK1H,KAAK0H,IAAL,MAAA1H,KAAI,YAAQ+b,IACjB9c,MAAO+a,EAAO7N,MACdxE,SAAU,SAAC0G,GAtFJ,IAACN,EAuFNyM,EAAmB,MAtF7BI,EAAY,QAAD,OADK7M,EAwFGM,GAvFe,CAAElC,MAAO4B,eAgGzCiO,GAAU7c,IAAOC,IAAV,MAeP6c,GAAmB9c,IAAOC,IAAV,MAehB8c,GAAmB/c,IAAOqF,OAAV,MAKX,qBAAG2X,SAA2B,QAAU,WAU7CC,GAAa,SAAC,GAA4B,IAA1B9O,EAAyB,EAAzBA,KAAM+O,EAAmB,EAAnBA,aACpBC,EAAS,CACbC,MAAO,gBAGH9V,EAAQ6G,KAAQgP,EAASA,EAAOhP,GAAxB,aACRkP,EAAU,CACdD,MAAO,MAEHE,EAASnP,KAAQkP,EAAUA,EAAQlP,GAAQ,QACjD,OACE,cAAC2O,GAAD,UACE,cAACC,GAAD,CAAkB9V,QAAS,kBAAMiW,EAAaI,IAA9C,SACGhW,OAMHiW,GAA4Bvd,IAAOC,IAAV,MAWzBsZ,GAAevZ,IAAOC,IAAV,MAKP,SAAChB,GAAD,OAAYA,EAAMua,QAAU,QAAU,UAC3B,SAACva,GAAD,OAAYA,EAAMua,QAAU,UAAY,WAE5C,SAACva,GAAD,OAAYA,EAAMua,QAAU,eAAiB,eAKzDgE,GAAgB,SAAC,GAA8C,IAA5CxC,EAA2C,EAA3CA,YAAaxb,EAA8B,EAA9BA,OAAQqM,EAAsB,EAAtBA,MAAOrD,EAAe,EAAfA,SAAe,EAC1BoE,qBAAW9N,GADe,mBAC3Da,EAD2D,KAC7CC,EAD6C,OAG5BV,mBAAS,MAHmB,mBAG3Due,EAH2D,KAG9CC,EAH8C,OAI5Bxe,mBAAS,IAJmB,mBAI3Dye,EAJ2D,KAI9CC,EAJ8C,KAK5D9R,EAAQtM,EAAOqM,GACfgS,EAA0BrJ,mBAC9B,kBACE1I,EACI,CACE8P,YAAa9P,EAAM8P,aARD,GASlBtU,MAAOwE,EAAMxE,OAEf,CAAEsU,YAXkB,GAWgBtU,MAAO,aACjD,CAACwE,IAMH,GAJAoB,qBAAU,WACR0Q,EAAeC,KACd,CAAChS,EAAOgS,KAENre,EAAQ,OAAO,KAEpB,IAWMse,EALwB,SAACtF,EAAUuF,GACvC,IAAMrQ,EAAO,eAAQ/N,GACrB+N,EAAQhO,cAAcF,EAAOqM,GAAOtJ,MAAMiW,GAAYuF,EACtDne,EAAgB8N,IAE8BhJ,KAAK,KAAM,cAErDuS,EAAWtX,EAAaD,cAAcF,EAAOqM,GAAOtJ,MACpDyb,EACkB,SAAtBL,EAAYrW,MACV,uDAA0B6O,GAA1B,aAEA,uDACuBA,GADvB,gBAC6C,IAC3C,cAACoD,GAAD,CACEC,QACE3V,EAAM8Z,EAAYtE,gBAClBsE,EAAYrW,QAAUqW,EAAYtE,cAEpC9M,MAAK,oBAAeoR,EAAYtE,eAAiB,QALnD,SAOGsE,EAAYrW,WAIrB,OACE,qCACmB,UAAhBmW,EAA0B,cAACZ,GAAD,UAAUmB,IAAqB,KACzDxe,EAAOqM,GAAO0B,SACb,cAAC,GAAD,CACEY,KAAMsP,EACNP,aAAc,SAAC/O,GApCrB1K,EAASuX,EAAa,CACpB,mBAAmB,YAAnB,OAAgClP,EAAMvJ,KAAtC,QAEFqb,EAAeC,GAmCPH,EAAevP,GACf3F,EAASjF,EAAM,CAAEka,YAAatP,QAGhC,KACHsP,GAA+B,UAAhBA,EACd,cAAC,GAAD,CACE3R,MAAOtM,EAAOqM,GACdmP,YAAaA,EACbC,mBAAoB,SAACta,GACnBid,EAAe,uCACVC,GACAld,GAFS,IAGZ0Y,cAAesE,EAAYrW,SAE7BkB,EAAS,uCAAKqV,GAA4Bld,GAAlC,IAAqC8c,kBAE/C7B,YAAa+B,EAAY/B,cAEzB,KACH6B,GAA+B,UAAhBA,EACd,cAAC,GAAD,CACE3d,MAAO6d,EAAY/B,YACnBvC,cAAesE,EAAYtE,cAC3B/R,MAAOqW,EAAYrW,QAEnB,KACJ,cAAC,GAAD,CAA2B9H,OAAQA,EAAQwY,aAAcnM,IACxC,UAAhB4R,EACC,cAACF,GAAD,UACE,cAAC,GAAD,CACEtG,SAAQ,uBAAkBd,GAAlB,+BACR6C,SAAU8E,EAAkBpZ,KAAK,MACjCsC,aAAciQ,EAASL,eAGzB,SAKJqH,GAAiBje,IAAOC,IAAV,MAKdie,GAAqBle,IAAOC,IAAV,MAoETke,GAhEiB,SAAC,GAA2B,IAAzB7H,EAAwB,EAAxBA,KAAM8H,EAAkB,EAAlBA,YAAkB,EACjBlf,mBAAS,GADQ,mBAClD8Y,EADkD,KACpC3B,EADoC,OAEjBzJ,qBAAW9N,GAFM,mBAElDa,EAFkD,KAEpCC,EAFoC,OAGrBV,mBAAS,IAHY,mBAGlDmf,EAHkD,KAGtCC,EAHsC,KAInDC,EAAQ,kBACZpR,GAAUxN,EAAcC,EAAiByW,EAAiBC,IACtDkI,EAAYC,mBAElBvR,oBAAUqR,EAAO,IASjB,OACG5e,EAAa2O,iBACb3O,EAAa2O,gBAAgBmI,iBAIzB9W,EAAa2O,gBAClB,cAAC,GAAD,UACE,eAAC2P,GAAD,CAAgBxY,GAAG,qBAAnB,UACE,eAACyY,GAAD,CAAoBpM,IAAK0M,EAAzB,UACE,cAAC,GAAD,CACExD,YAlBW,WAInB,OAHYwD,EAAU1H,QAAQ4H,iBAC5B,kDACA,IAgBMlf,OAAQG,EAAa2O,gBAAgBmI,gBACrC5K,MAAOmM,EACPxP,SAAU8V,IAEZ,cAAC,KAAD,CAEE5U,MAAOwM,GAA8BxM,MACrCR,OAAQgN,GAA8BhN,OACtC1J,OAAQG,EAAa2O,gBAAgBmI,gBACrCkI,aAAa,EACbC,SAAqC,UAA3BP,EAAWZ,YACrBoB,SAAU,EACVC,aAAc,SAACC,GACb1I,EAAgB0I,EAAM,IAExBpb,MAAO,CACLqb,uBAAyBZ,EAAmB,KAAL,GACvCa,oBAAsBb,EAAmB,KAAL,GACpC5X,gBAAiB,KACjBkS,OAAQ,wBAdL/Y,EAAa4W,YAkBpB6H,EAME,KALF,cAAC,GAAD,CACEjR,UAAWoR,EACXzG,kBAAmBE,EACnB1B,KAAMA,SAnCP,M,08CClxBX,IAAM4I,GAAYlf,IAAOC,IAAV,MAQTkf,GAAQnf,IAAOof,GAAV,MAKLC,GAAYrf,IAAOC,IAAV,MAITqf,GAAoBtf,IAAOC,IAAV,MAajBsf,GAAgBvf,IAAOC,IAAV,MAKbuf,GAAiBxf,YAAOmH,GAAPnH,CAAH,MAIdyf,GAAkBzf,IAAOC,IAAV,MAOfyf,GAAW,SAAC,GAAsB,IAApBnT,EAAmB,EAAnBA,MAAOoT,EAAY,EAAZA,MACzB,OACE,eAACL,GAAD,WACE,cAACC,GAAD,UAAgBhT,IAChB,cAACkT,GAAD,UACGE,EAAMjf,KAAI,SAACC,GAAD,OACT,cAAC,KAAD,CAAiBgS,GAAIhS,EAAEgS,GAAvB,SACE,cAAC6M,GAAD,2BACM,CAAE,WAAY7e,EAAE4O,SAAW,cAAgB,OADjD,aAGG5O,EAAE4L,OAAS,WAJL5L,EAAEgS,aAajBiN,GAAQ,CACZ,CACErT,MAAO,eACPoT,MAAO,CACL,CAAEpT,MAAO,QAASoG,GAAI,cACtB,CAAEpG,MAAO,OAAQoG,GAAI,aACrB,CAAEpG,MAAO,OAAQoG,GAAI,eAGzB,CACEpG,MAAO,aACPoT,MAAO,CACL,CAAEpT,MAAO,QAASoG,GAAI,gBACtB,CAAEpG,MAAO,OAAQoG,GAAI,eACrB,CAAEpG,MAAO,OAAQoG,GAAI,kBAKrBkN,GAAQ7f,IAAOC,IAAV,MAIL6f,GAAW9f,IAAOC,IAAV,MA6CC8f,GApCF,WACX,OACE,mCACE,cAAC,GAAD,UACE,eAACF,GAAD,WACE,eAAC,GAAD,WACE,cAACV,GAAD,0BACA,cAACE,GAAD,UACGO,GAAMlf,KAAI,SAACC,GAAD,OACT,cAAC,GAAD,eAA4BA,GAAbA,EAAE4L,eAoBvB,cAACuT,GAAD,Y,u3CC5HV,IAAMZ,GAAYlf,IAAOC,IAAV,MAKT+f,GAAwBhgB,IAAOC,IAAV,MAKrBggB,GAAUjgB,IAAO4L,IAAV,MAMPsU,GAAclgB,IAAOC,IAAV,MAQXyO,GAAW1O,IAAOC,IAAV,MAIRkgB,GAASngB,IAAOC,IAAV,MAKNmgB,GAAQpgB,IAAO4L,IAAV,MAMQ,qBAAGoR,SACP,yBAA2B,6BAGpCqD,GAAU,SAAC,GAAD,QAAGC,gBAAH,MAAc,GAAd,EAAkBvgB,EAAlB,EAAkBA,SAAU4D,EAA5B,EAA4BA,MAA5B,OACd,qBAAKA,MAAK,2BAAOA,GAAP,IAAc4c,UAAU,UAAD,OAAYD,EAAZ,UAAjC,SACGvgB,KAICygB,GAAc,SAACvhB,GAAD,OAClB,cAAC,GAAD,aAAS0E,MAAO,CAAE8H,SAAUxM,EAAMwB,OAAYxB,KAG1CwhB,GAAsBzgB,IAAOqF,OAAV,MAWnBqb,GAAgB,CACpBC,KAAM,cAAC,GAAD,CAAOpZ,OAAO,SAAS5D,MAAO,CAAEyU,YAAa,KACnDwI,MAAO,cAAC,GAAD,CAAangB,KAAM,GAAnB,gBAGHogB,GAAgB,SAAC,GAAqC,IAAD,IAAlCC,cAAkC,MAAzB,UAAyB,EAAd7Z,EAAc,EAAdA,QACrC8Z,EAAe,CACnBC,QAASN,GAAcC,KACvBM,QAASP,GAAcE,OAEzB,OACE,cAACH,GAAD,CAAqBxZ,QAASA,EAA9B,SACG8Z,EAAaD,MAwDLI,GAnDQ,SAAC,GAA0C,IAAxC1hB,EAAuC,EAAvCA,OAAQ2hB,EAA+B,EAA/BA,KAAMzX,EAAyB,EAAzBA,MAAyB,IAAlB7E,aAAkB,MAAV,IAAU,IACrB3F,mBAAS,GADY,mBACxDkiB,EADwD,KACzCC,EADyC,OAE7BniB,oBAAS,GAFoB,mBAExDoiB,EAFwD,KAE7CC,EAF6C,KAW/D,OARAC,IAAMtU,WAAU,WACd,GAAIoU,EAAW,CACb,IAAMG,EACJL,EAAgB5hB,EAAO2B,OAAS,EAAIigB,EAAgB,EAAI,EAC1Dnc,YAAW,kBAAMoc,EAAiBI,KAAY5c,MAE/C,CAACyc,EAAWF,EAAeC,EAAkB7hB,EAAQqF,IAGtD,eAAC,GAAD,CAAWlB,MAAO,CAAE+F,SAApB,UACE,eAACsW,GAAD,WACE,cAACC,GAAD,CAASjU,IAAKxM,EAAO4hB,GAAgBvP,IAAI,KACzC,eAACqO,GAAD,WACE,8BAAMiB,IACN,eAAC,GAAD,WACE,cAAC,GAAD,CACEC,cAAeA,EACfN,OAAQQ,EAAY,UAAY,UAChCra,QAAS,kBAAMsa,GAAcD,MAE/B,uBACEtQ,KAAK,QACL1I,IAAK,EACLC,IAAK/I,EAAO2B,OAAS,EACrBsH,KAAM,EACN3I,MAAOshB,EACPzd,MAAO,CAAE+d,QAAS,QAClBC,QAAS,SAACC,GAAD,OAAOP,EAAiB/V,SAASsW,EAAEpQ,OAAO1R,oBAK3D,cAACqgB,GAAD,UACG3gB,EAAOkB,KAAI,SAACC,EAAGwK,GAAJ,OACV,cAACiV,GAAD,CAEEpU,IAAKrL,EACLkhB,YAAa,WACNP,GAAWD,EAAiBlW,IAEnC6R,SAAU7R,IAAMiW,GANlB,gBACgBjW,a,+0BCtHnB,IAAM2W,GACD,SAACnhB,GAAD,OAAOE,KAAKkhB,MAAU,EAAJphB,GAAS,GAD1BmhB,GAEF,SAACE,EAAD,GAA0B,IAAd9f,EAAa,EAAbA,OAOb+f,EAASD,EAAQxgB,QACrB,SAACC,EAAKd,GAAN,mBAAC,eACIc,GADL,kBAEGd,EAAEuhB,aAFL,sBAEyBzgB,EAAId,EAAEuhB,eAAiB,IAFhD,CAEqDvhB,EAAE4B,WAEvD,IAEF,MAAO,CACLL,SACAuW,OAAQvW,EAAOxB,KAAI,SAACC,GAAD,OAAOA,EAAEtB,SAC5B8iB,KAAM7gB,OAAOC,KAAK0gB,GAAQ9gB,OAASN,KAAK0H,IAAL,MAAA1H,KAAI,YAAQS,OAAOC,KAAK0gB,KAAW,EACtEjgB,KAAME,EAAOxB,KAAI,SAACC,GAAD,MAAQ,CACvB8E,GAAI9E,EAAE2G,MACNtF,MAnBcA,EAmBCigB,EAnBKG,EAmBGzhB,EAAE6b,GAlB3Blb,OAAOC,KAAKS,GACTtB,KAAI,SAACC,GAAD,OAAOqB,EAAKrB,GAAGD,KAAI,SAACwJ,EAAGiB,GAAJ,MAAW,CAAExK,EAAGA,EAAGuJ,EAAGiB,EAAI,EAAG7D,MAAO4C,SAC3DmY,OACAxgB,OAAOugB,KAJK,IAACpgB,EAAMogB,OAHfN,GA0BH,SAACE,EAAD,EAA6BM,GAAe,IAAhC/V,EAA+B,EAA/BA,MAAOrK,EAAwB,EAAxBA,OACnBqgB,EAAargB,EAAOV,QAAO,SAACC,EAAKd,GAAN,mBAAC,eAAiBc,GAAlB,kBAAwBd,EAAE2G,MAAQ,MAAM,IACnE2a,EAASD,EAAQxgB,QACrB,SAACygB,EAAQthB,GAAT,OACGuB,GAAU,IAAIV,QACb,SAACC,EAAK+gB,GAAN,OACEA,EAAEhG,GAAG7b,EAAG2hB,GAAR,2BACS7gB,GADT,kBACe+gB,EAAElb,OAAS7F,EAAI+gB,EAAElb,QAAU,GAAK,IAD/C,eAES7F,KACXwgB,KAEJM,GAEF,MAAO,CACLrgB,SACAqK,QACAkM,OAAQvW,EAAOxB,KAAI,SAACC,GAAD,OAAOA,EAAEtB,SAC5B2C,KAAME,EAAOxB,KAAI,SAAC8hB,GAAD,MAAQ,CACvB/c,GAAI+c,EAAElb,MACNA,MAAOkb,EAAElb,MACTxH,MAAOmiB,EAAOO,EAAElb,WAElB4M,MAAO8N,EAAQ7gB,SAKfshB,GAAUziB,IAAOC,IAAV,MAOPyiB,GAAiB1iB,IAAOC,IAAV,MACR,oBAAGiJ,OAAH,2BAAY,IAAZ,WACD,oBAAGQ,MAAH,2BAAW,IAAX,WAOLiZ,GAAmB,SAACnG,EAAIoG,EAAS5gB,GAAd,OACvBA,GAAQA,EAAKb,OACTa,EAAKR,QACH,SAACqhB,EAAYC,GAAb,OAAmBtG,EAAE,WAAF,cAAMsG,EAAE9gB,KAAKtB,KAAI,SAACqiB,GAAD,OAAOA,EAAEH,OAA1B,QAAqCC,OACxD,GAEF,GAEAG,GAAa,CACjBC,UAAWN,GAAiBje,KAAK,KAAM7D,KAAK0H,IAAK,KACjD2a,UAAWP,GAAiBje,KAAK,KAAM7D,KAAK0H,IAAK,KACjD4a,UAAWR,GAAiBje,KAAK,KAAM7D,KAAKyH,IAAK,KACjD8a,UAAWT,GAAiBje,KAAK,KAAM7D,KAAKyH,IAAK,KACjD+a,OAAQ,SAACrhB,EAAMrB,GAAP,OACNqB,GAAQA,EAAKb,OACTa,EAAKR,QACH,SAAC8hB,EAAOC,GAAR,OACEA,EAAIvhB,KAAKH,QAAO,SAACoP,GAAD,OAAUA,EAAKtQ,EAAE6iB,aAAe7iB,EAAE6iB,cAC/CriB,OAASmiB,IACd,GAEF,IAEFG,GAAY,SAAC,GAAmD,IAAjDzhB,EAAgD,EAAhDA,KAAMsgB,EAA0C,EAA1CA,UAAWoB,EAA+B,EAA/BA,OAAQC,EAAuB,EAAvBA,OAAQC,EAAe,EAAfA,SAEpD,IAAK/f,EAAM7B,KAAU6B,EAAMye,KAAeze,EAAM+f,GAAW,OAAO,KAFC,MAIlB,CAC/CF,EAAOpB,GACPqB,GALoB,GAMpBD,EAAOpB,GACPqB,EAAOX,GAAWE,UAAUlhB,GAPR,IAGf6hB,EAJ4D,KAIlDC,EAJkD,KAIxCC,EAJwC,KAI9BC,EAJ8B,KAW7DC,EAAcjB,GAAWK,OAAOrhB,EAAMsgB,GAEtC4B,EAAOlB,GAAWG,UAAUnhB,GAC5BmgB,EAAOa,GAAWC,UAAUjhB,GAC5BmiB,EAAWD,EAAO,EAClBE,EAAWjC,EAAO,EAClBkC,EAAcT,EAAW,EAAM,EAC/BU,EAAmB,CAAC,GAAD,OACpBT,EAAWQ,EADS,YACMP,GADN,UAEpBD,EAAWQ,EAFS,YAEML,GAFN,UAGpBD,EAAWM,EAHS,YAGML,GAHN,UAIpBD,EAAWM,EAJS,YAIMP,IAQzBS,EAAoB,CAAC,GAAD,OACrBb,EAAOS,GADc,YACDL,GADC,UAErBJ,EAAOS,GAFc,YAEDH,GAFC,UAGrBH,EAAWQ,EAHU,YAGKL,GAHL,UAIrBH,EAAWQ,EAJU,YAIKP,IAEzBU,EAAWT,GAAYL,EAAOU,GAAYL,GAAY,EACtDU,EAAYZ,GAAYA,EAAWH,EAAOS,IAAa,EAC7D,OAAOO,MAAMb,IACXa,MAAMX,IACNW,MAAMZ,IACNY,MAAMV,GAAY,KAClB,qCACE,qCACG1B,EAAY4B,EACX,sBACEvjB,EAAG8jB,EACHva,GAAI,GACJya,WAAW,SACXhhB,MAAO,CAAE8H,SAAU,SAJrB,wBAQE,KACHwY,EACC,sBACEtjB,EAAGkjB,EACH3Z,GAAI,GACJya,WAAW,SACXhhB,MAAO,CAAE8H,SAAU,UAJrB,SAMGwY,IAED,KACH3B,GAAaH,EACZ,sBACExhB,EAAG6jB,EACHta,GAAI,GACJya,WAAW,SACXhhB,MAAO,CAAE8H,SAAU,SAJrB,uBAQE,QAEN,yBACEb,OAAQ0Z,EAAiBzZ,KAAK,KAC9BhB,KAAK,gBACLD,OAAO,mBACPD,YAAY,QAEd,yBAASiB,OAAQ2Z,EAAkB1Z,KAAK,KAAMhB,KAAK,wBAKnD+a,GAAU,SAAC,GAAD,IACdtQ,EADc,EACdA,MADc,IAEdsP,gBAFc,MAEH,GAFG,EAGdtB,EAHc,EAGdA,UAHc,IAIdH,YAJc,MAIP,OAJO,MAKd+B,YALc,MAKP,OALO,EAMdW,EANc,EAMdA,QACAC,EAPc,EAOdA,YAPc,OASd,cAAC,KAAD,CACE9iB,KAAMsS,EAAMtS,KACZyX,OAAQ,CAAEsL,IAAK,GAAIC,OAAQ,GAAI9d,MAAO,GAAIT,KAAM,IAChDid,OAAQ,CAAE1S,KAAM,SAAU1I,IAAK4b,EAAM3b,IAAK4Z,GAC1C1J,OAAQoM,GAAWvQ,EAAMmE,OACzBwM,QAAS,SAACtkB,GAAD,OAAO,cAAC8hB,GAAD,UAAU9hB,EAAEukB,KAAKljB,KAAKsF,SACtCsc,SAAUA,EACVuB,WAAY,CACVC,OAAQ,SACRC,OAAQP,EACRQ,eAAgB,SAChBC,aAAc,IAEhBC,UAAU,EACVlD,UAAWA,EACXmD,OAAQ,CAAC,OAAQ,QAAShC,IAC1BiC,QAAS,CACP,CACEC,OAAQ,YACRC,UAAW,SACXC,WAAY,IACZC,WAAY,EACZC,UAAW,GACXC,WAAY,GACZC,aAAc,EACdC,WAAYtC,EACZuC,YAAa,SACbC,QAAS,CACP,CACEC,GAAI,QACJ1iB,MAAO,CACL2iB,cAAe,OACfC,eAAgB,kBASxBC,GAAmBxmB,IAAOC,IAAV,MAMhBwmB,GAAY,SAAC,GAAD,IAChBhmB,EADgB,EAChBA,KACAE,EAFgB,EAEhBA,EACAuJ,EAHgB,EAGhBA,EACA7K,EAJgB,EAIhBA,MACAwK,EALgB,EAKhBA,KACA+H,EANgB,EAMhBA,QACA8U,EAPgB,EAOhBA,YACAC,EARgB,EAQhBA,YACAC,EATgB,EAShBA,QACAC,EAVgB,EAUhBA,QAVgB,OAYhB,wBACEjmB,EAAGH,EAAO,EACViK,GAAI/J,EAAIF,EAAO,EACfkK,GAAIT,EAAIzJ,EAAO,EACfoJ,KAAMA,GAAQxK,EACdsK,YAAa+c,EACb9c,OAAQ+c,EACR/U,QAASA,EACTkV,aAAcF,EACdG,YAAaH,EACbI,aAAcH,KAGZI,GAAS,SAAC,GAAe,IAAb3S,EAAY,EAAZA,MAChB,OAAKA,EAAMJ,MAET,qCACGI,EAAM/H,MAAQ,cAACia,GAAD,UAAmBlS,EAAM/H,QAA4B,KACpE,cAAC,KAAD,CACEvK,KAAMsS,EAAMtS,KACZkS,MAAOI,EAAMJ,MACbgT,KAAM5S,EAAMJ,MAAQ,GAAK,EACzBiT,QAAS,GACT1O,OAAQnE,EAAMmE,OACdgB,OAAQ,CAAEsL,IAAK,GACfqC,cAAeX,GACfY,cAAc,MACdC,WAAW,qBAbQ,MAmBrBC,GAAiB,SAAC,GAAuC,IAArCC,EAAoC,EAApCA,YAAaC,EAAuB,EAAvBA,QAASC,EAAc,EAAdA,QACxCxT,EAAQsT,EAAYhmB,QAAO,SAACC,EAAKd,GAAN,OAAYc,EAAMd,EAAEb,QAAO,GAC5D,OACE,sBACEa,EAAG8mB,EACHvd,EAAGwd,EACH/C,WAAW,SACXgD,iBAAiB,UACjBhkB,MAAO,CACL8H,SAAU,UANd,SASGyI,KAKD0T,GAAM,SAAC,GAAiC,IAA/BtT,EAA8B,EAA9BA,MAA8B,IAAvBuT,iBAAuB,SAC3C,OACE,qCACGvT,EAAM/H,MAAQ,cAACia,GAAD,UAAmBlS,EAAM/H,QAA4B,KACpE,cAAC,KAAD,CACEvK,KAAMsS,EAAMtS,KACZyX,OAAQ,CAAEsL,IAAK,GAAI7d,MAAO,IAAK8d,OAAQ,GAAIve,KAAM,KACjDgS,OAAQnE,EAAMmE,OACdqP,YAAa,GACbC,oBAAoB,EACpBC,SAAU,GACVC,aAAc,EACdxC,OAAQ,CACN,SACA,cACA,eACA,UACAoC,EAAYN,GAAiB,MAE/BW,WAAY,SAACvnB,GAAD,OAAQA,EAAEb,MAAQa,EAAEb,MAAQ,MACxCqoB,qBAAqB,cAMvBC,GAAa,SAAC,GAA6C,IAA3C/oB,EAA0C,EAA1CA,MAAO8U,EAAmC,EAAnCA,KAAmC,IAA7BkU,qBAA6B,MAAb,OAAa,EACxDC,EACJ,qBACE3kB,MAAO,CACL+F,MAAO,GACPR,OAAQ,GACRqf,aAAc,MACd/hB,gBAAiBnH,EACjBoa,OAAQ,WAId,OACE,sBACE9V,MAAO,CACLiP,QAAS,OACTY,UAAW6U,EACXG,eAAkC,SAAlBH,EAA2B,aAAe,WAC1D7c,QAAS,SALb,UAQqB,SAAlB6c,EAA2BC,EAAS,KACrC,sBAAM3kB,MAAO,CAAE8H,SAAU,SAAzB,SAAqC0I,IAClB,UAAlBkU,EAA4BC,EAAS,SAKtCG,GAAS,SAAC,GAAD,IAAGnU,EAAH,EAAGA,MAAH,OACb,sBACE3Q,MAAO,CACLiP,QAAS,OACT8V,oBAAqB,WAHzB,UAME,cAAC,GAAD,aAAYL,cAAc,SAAY/T,EAAMqU,yBAC5C,cAAC,GAAD,eAAgBrU,EAAMsU,yBACtB,cAAC,GAAD,aAAYP,cAAc,SAAY/T,EAAMuU,yBAC5C,cAAC,GAAD,eAAgBvU,EAAMwU,6BAIpBC,GAAU/oB,IAAOC,IAAV,MAGP+oB,GAAchpB,YAAO+oB,GAAP/oB,CAAH,MAGXipB,GAAWjpB,YAAO+oB,GAAP/oB,CAAH,MA8RCkpB,GA3RW,SAAC,GAYpB,IAAD,IAXJtF,gBAWI,MAXO,GAWP,MAVJ1a,cAUI,MAVK,IAUL,MATJQ,aASI,MATI,IASJ,EARJ4Y,EAQI,EARJA,UACA6G,EAOI,EAPJA,OACAC,EAMI,EANJA,YACAtE,EAKI,EALJA,YACAuE,EAII,EAJJA,YACAC,EAGI,EAHJA,aACAC,EAEI,EAFJA,eACAC,EACI,EADJA,YAEMC,EAAe/f,EAAQ,EACvBggB,EAAmBxgB,EAAS,EAAI,EACtC,OACE,eAAC6f,GAAD,WACGK,EACC,eAACJ,GAAD,WACE,cAACtG,GAAD,CAAgBxZ,OAAQA,EAAQQ,MAAO+f,EAAvC,SACE,cAAC,GAAD,CACEnV,MAAO6U,EAAOQ,QACd/F,SAAUA,EACVtB,UAAWA,EACX4B,KAAM,EACN/B,KAAMiH,EACNvE,QAAS0E,EACTzE,YAAaA,EACb0E,YAAaA,MAGjB,cAAC,GAAD,CACEliB,MAAO+hB,EACP3gB,cAAc,SACdJ,IAAK,EACLC,IAAK6gB,EACL3gB,KAAM,GACN3I,MAAOwiB,EACP3e,MAAO,CACL+d,QAAS,OACThY,MAAO+f,EAAe,GACtB1W,WAAY,GACZ9J,UAAW,GAEbN,YAAa,CACX6C,QAAS,EACT+c,aAAc,eAEhB/f,SAAU,SAAC0G,GAAD,OAAWoa,EAAapa,SAGpC,KACJ,eAAC8Z,GAAD,WACE,eAACC,GAAD,WACE,cAACvG,GAAD,CAAgBxZ,OAAQwgB,EAAxB,SACE,cAAC,GAAD,CAAQpV,MAAO6U,EAAO9d,YAExB,cAACqX,GAAD,CAAgBxZ,OAAQwgB,EAAxB,SACE,cAAC,GAAD,CAAQpV,MAAO6U,EAAO1V,iBAG1B,eAACwV,GAAD,WACE,cAACvG,GAAD,CAAgBxZ,OAAQwgB,EAAxB,SACE,cAAC,GAAD,CAAKpV,MAAO6U,EAAOS,iBAErB,cAAClH,GAAD,CAAgBxZ,OAAQwgB,EAAxB,SACE,cAAC,GAAD,CAAKpV,MAAO6U,EAAOU,gBAGvB,cAAC,GAAD,CAAQvV,MAAOkV,WC9bjBM,GACC,UADDA,GAEE,UAFFA,GAGO,YAHPA,GAIE,OAGFC,GAAc,CAClBjB,uBAAwB,CAAEzpB,MAAOyqB,GAAa3V,KAAM,wBACpDyU,uBAAwB,CAAEvpB,MAAOyqB,GAAa3V,KAAM,wBACpD0U,uBAAwB,CAAExpB,MAAOyqB,GAAY3V,KAAM,yBACnDwU,uBAAwB,CACtBtpB,MAAOyqB,GACP3V,KAAM,0BAIJ6V,GAAc,CAClBL,QAAS,CACPznB,OAAQ,CACN,CACEoF,MAAO,eACPkV,GAAI,SAAC7b,GAAD,OAAOA,EAAE2G,MAAMjF,SAAS,YAC5BhD,MAAOyqB,IAET,CACExiB,MAAO,gBACPkV,GAAI,SAAC7b,GAAD,OAAOA,EAAE2G,MAAMjF,SAAS,UAC5BhD,MAAOyqB,MAIbze,QAAS,CACPkB,MAAO,UACPrK,OAAQ,CACN,CACEoF,MAAO,YACPkV,GAAI,SAAC7b,EAAGmE,GAAJ,OAAUnE,EAAEuhB,aAAepd,GAAKnE,EAAE4B,KAAKF,SAAS,UACpDhD,MAAOyqB,IAET,CACExiB,MAAO,UACPkV,GAAI,SAAC7b,EAAGmE,GAAJ,OAAUnE,EAAEuhB,cAAgBpd,GAAKnE,EAAE4B,KAAKF,SAAS,YACrDhD,MAAOyqB,MAIbrW,UAAW,CACTlH,MAAO,YACPrK,OAAQ,CACN,CACEoF,MAAO,YACPkV,GAAI,SAAC7b,EAAGmE,GAAJ,OAAUnE,EAAEuhB,cAAgBpd,GAAKnE,EAAE4B,KAAKF,SAAS,UACrDhD,MAAOyqB,IAET,CACExiB,MAAO,UACPkV,GAAI,SAAC7b,EAAGmE,GAAJ,OAAUnE,EAAEuhB,aAAepd,GAAKnE,EAAE4B,KAAKF,SAAS,YACpDhD,MAAOyqB,MAIbF,aAAc,CACZrd,MAAO,qBACPrK,OAAQ,CACN,CACEoF,MAAO,KACPkV,GAAI,SAAC7b,EAAGmE,GAAJ,OAAUnE,EAAEuhB,cAAgBpd,GAAKnE,EAAE4B,KAAKF,SAAS,YACrDhD,MAAOyqB,IAET,CACExiB,MAAO,qBACPkV,GAAI,SAAC7b,EAAGmE,GAAJ,OAAUnE,EAAEuhB,aAAepd,GAAKnE,EAAE4B,KAAKF,SAAS,YACpDhD,MAAOyqB,MAIbD,SAAU,CACRtd,MAAO,gBACPrK,OAAQ,CACN,CACEoF,MAAO,KACPkV,GAAI,SAAC7b,EAAGmE,GAAJ,OAAUnE,EAAEuhB,cAAgBpd,GAAKnE,EAAE4B,KAAKF,SAAS,YACrDhD,MAAOyqB,IAET,CACExiB,MAAO,qBACPkV,GAAI,SAAC7b,EAAGmE,GAAJ,OAAUnE,EAAEuhB,aAAepd,GAAKnE,EAAE4B,KAAKF,SAAS,YACpDhD,MAAOyqB,IAET,CACExiB,MAAO,MACPkV,GAAI,SAAC7b,EAAGmE,GAAJ,OAAUnE,EAAEuhB,cAAgBpd,GAAKnE,EAAE4B,KAAKF,SAAS,UACrDhD,MAAOyqB,IAET,CACExiB,MAAO,sBACPkV,GAAI,SAAC7b,EAAGmE,GAAJ,OAAUnE,EAAEuhB,aAAepd,GAAKnE,EAAE4B,KAAKF,SAAS,UACpDhD,MAAOyqB,OA6GAG,GAxGqB,SAAC,GAQ9B,IAAD,IAPJrG,gBAOI,MAPO,GAOP,MANJsG,wBAMI,MANe,IAMf,MALJhhB,cAKI,MALK,IAKL,MAJJQ,aAII,MAJI,IAIJ,EAHJygB,EAGI,EAHJA,iBACArF,EAEI,EAFJA,YACAuE,EACI,EADJA,YACI,EAC0BnqB,mBAAS,IADnC,mBACGkrB,EADH,KACYC,EADZ,OAEwBnrB,mBAAS,CACnCyqB,QAAS,CAAE3nB,KAAM,IACjBqJ,QAAS,CAAErJ,KAAM,GAAIkS,MAAO,GAC5BT,UAAW,CAAEzR,KAAM,GAAIkS,MAAO,GAC9B0V,aAAc,CAAE5nB,KAAM,GAAIkS,MAAO,GACjC2V,SAAU,CAAE7nB,KAAM,GAAIkS,MAAO,KAP3B,mBAEGiV,EAFH,KAEWmB,EAFX,OASkCprB,mBAAS,GAT3C,mBASGkqB,EATH,KASgBmB,EAThB,OAU8BrrB,mBAASgrB,GAVvC,mBAUG5H,EAVH,KAUcgH,EAVd,KAuEJ,OA3DApc,qBAAU,YACQ,uCAAG,8BAAAlM,EAAA,sEACI0B,MAAM,gCADV,cACX8nB,EADW,gBAEEA,EAAO5nB,OAFT,OAEXZ,EAFW,OAGjBqoB,EACEroB,EAAKggB,QAAQthB,KAAI,SAACC,GAAD,mBAAC,eACbA,GADY,IAEfuhB,aAAcJ,GAAmBnhB,EAAE8pB,aANtB,2CAAH,qDAWhBC,KACC,IAEHxd,qBAAU,WACR,IAAMyd,EAAe7I,GAAkBsI,EAASJ,GAAYL,SAC5DW,EAAU,CACRX,QAASgB,EACTtf,QAASyW,GAAiBsI,EAASJ,GAAY3e,QAAS6e,GACxDzW,UAAWqO,GACTsI,EACAJ,GAAYvW,UACZyW,GAEFN,aAAc9H,GACZsI,EACAJ,GAAYJ,aACZM,GAEFL,SAAU/H,GACRsI,EACAJ,GAAYH,SACZK,KAIJZ,EAAaY,GACTS,EAAaxI,MAAMoI,EAAeI,EAAaxI,KAAO,KACzD,CAACiI,EAASF,IAEbhd,qBAAU,WACR,IAAI0d,EAAatI,EACb6H,IACFS,EAAa9I,GAAmBsH,EAAce,GAC9Cb,EAAasB,IAEfN,EAAU,2BACLnB,GADI,IAEP9d,QAASyW,GAAiBsI,EAASJ,GAAY3e,QAASuf,GACxDnX,UAAWqO,GAAiBsI,EAASJ,GAAYvW,UAAWmX,GAC5DhB,aAAc9H,GACZsI,EACAJ,GAAYJ,aACZgB,GAEFf,SAAU/H,GAAiBsI,EAASJ,GAAYH,SAAUe,QAE3D,CAACtI,EAAW6H,IAEb,cAAC,GAAD,CACEvG,SAAUA,EACV1a,OAAQA,EACRQ,MAAOA,EACP4Y,UAAWA,EACX6G,OAAQA,EACRK,YAAaO,GACbX,YAAaA,EACbtE,YAAaA,EACbuE,YAAaA,EACbC,aAAcA,EACdC,eAAgB,SAAC5oB,GAAD,OACdA,EAAEA,EAAI2hB,EACF3hB,EAAE2G,MAAMjF,SAAS,OACf,YACA,OACF1B,EAAE2G,OAAS3G,EAAE2G,MAAMjF,SAAS,OAC5BynB,GACAA,O,4xBCvMZ,IAAMe,GAAe,SAAC/e,EAAOD,GAAR,MAAmB,CACtCA,QACAG,IAAI,OAAD,OAASF,EAAMvJ,MAClB+E,MAAOwE,EAAMxE,QAGT4X,GAAYlf,IAAOC,IAAV,MAST6qB,GAAkB9qB,IAAOC,IAAV,MAGT,oBAAGQ,KAAH,kBAAU,GAAV,GAAwByI,QAAU,WACnC,oBAAGzI,KAAH,kBAAU,GAAV,GAAwBiJ,OAAS,WAItCqhB,GAAuB/qB,IAAO4L,IAAV,MAGP,qBAAGof,QAAyB,MAAQ,UAGjDC,GAAmBjrB,IAAOC,IAAV,MASU,qBAAG+qB,QAAyB,MAAQ,UAG9DE,GAAY,SAAC,GAAD,IAAGpf,EAAH,EAAGA,MAAOrL,EAAV,EAAUA,KAAMuqB,EAAhB,EAAgBA,QAAhB,OAChB,eAACF,GAAD,CAAiBrqB,KAAMA,EAAvB,UACE,cAACwqB,GAAD,CAAkB1e,MAAOT,EAAMS,MAAOye,QAASA,EAA/C,SACGlf,EAAMxE,QAET,cAACyjB,GAAD,CAAsB/e,IAAKF,EAAME,IAAK6F,IAAI,GAAGmZ,QAASA,QAIpDG,GAAa,SAAC,GAAD,IAAG3rB,EAAH,EAAGA,OAAQ4rB,EAAX,EAAWA,SAAUJ,EAArB,EAAqBA,QAArB,OACjB,8BACGxrB,EAAOkB,KAAI,SAACC,EAAGwK,GAAJ,OACV,cAAC,GAAD,CAEEW,MAAOnL,EACPF,KAAM2qB,EACNJ,QAASA,GAJX,qBACqBrqB,EADrB,YAC0BwK,UA8EjBkgB,GArEI,SAAC,GAA4C,IAAD,IAAzCC,sBAAyC,MAAxB,EAAwB,MAArBN,eAAqB,WAC3B9rB,mBAAS,IADkB,mBACtDqsB,EADsD,KAC3CC,EAD2C,OAEjCtsB,mBAAS,IAFwB,mBAEtDM,EAFsD,KAE9CisB,EAF8C,OAGzBvsB,mBAAS,GAHgB,mBAGtD0P,EAHsD,KAG1CC,EAH0C,OAIf3P,mBAAS,CAAC,EAAG,IAJE,mBAItDwsB,EAJsD,KAIrCC,EAJqC,KAK7Dze,qBAAU,YACU,uCAAG,gCAAAlM,EAAA,sEACKsB,IADL,OACb4I,EADa,OAEb0gB,EAAa1gB,EAAUpI,gBAAgBwoB,GAC7CE,EAAaI,GACPhP,EAJa,YAKd,IAAI3a,IACL2pB,EAAWpqB,QACT,SAACC,EAAKd,GAAN,4BACKc,GADL,YAEKH,OAAOC,KAAKZ,EAAE4M,UAAY,IAC1B1L,QAAO,SAAClB,GAAD,OAAOA,EAAEmb,WAAW,YAC3Bpb,KAAI,SAACC,GAAD,OAAO2K,SAAS3K,EAAEub,QAAQ,QAAS,YAE5C,MAINyP,EAAmB,CAAC,EAAG9qB,KAAK0H,IAAL,MAAA1H,KAAI,YAAQ+b,MACnC6O,EAAUG,EAAWlrB,IAAImqB,KAlBN,2CAAH,qDAqBlBgB,KACC,IAEH3e,qBAAU,WACR,GAAmB,IAAf0B,EAAJ,CACA,IAAMkd,EAAcP,EAAU7qB,KAC5B,SAACC,EAAGwK,GAAJ,OAAU0f,GAAalqB,EAAE4M,SAAF,eAAmBqB,IAAezD,MAE3DsgB,EAAUK,MACT,CAACld,IApCyD,kBAsC9B8c,EAtC8B,GAsCtDK,EAtCsD,KAsC3CC,EAtC2C,KAuC7D,OAAOxsB,GAAUA,EAAO2B,OACtB,cAAC,GAAD,UACE,eAAC,GAAD,WACE,cAAC,GAAD,CACE3B,OAAQA,EACR4rB,SAAU,CAAEliB,OAAQ,QAASQ,MAAO,SACpCshB,QAASA,IAEVgB,EAAY,EACX,qBAAKroB,MAAO,CAAEiP,QAAS,OAAQ4V,eAAgB,UAA/C,SACE,cAAC,GAAD,CACElhB,MAAM,YACNoB,cAAc,SACdJ,IAAKyjB,EACLxjB,IAAKyjB,EACLvjB,KAAM,EACN3I,MAAO8O,EACPjL,MAAO,CACL+d,QAAS,OACThY,MAAO,QAETlB,SAAUqG,MAGZ,UAGN,M,gZClIN,IAAMod,GAAQ,CACZ,CAAErgB,IAAK,2BAA4BtE,MAAO,OAAQ4kB,QAAS,IAC3D,CAAEtgB,IAAK,2BAA4BtE,MAAO,OAAQ4kB,QAAS,IAC3D,CAAEtgB,IAAK,4BAA6BtE,MAAO,QAAS4kB,QAAS,IAC7D,CAAEtgB,IAAK,6BAA8BtE,MAAO,SAAU4kB,QAAS,IAC/D,CAAEtgB,IAAK,4BAA6BtE,MAAO,QAAS4kB,QAAS,IAC7D,CAAEtgB,IAAK,6BAA8BtE,MAAO,SAAU4kB,QAAS,IAC/D,CAAEtgB,IAAK,2BAA4BtE,MAAO,OAAQ4kB,QAAS,IAC3D,CAAEtgB,IAAK,4BAA6BtE,MAAO,QAAS4kB,QAAS,IAC7D,CAAEtgB,IAAK,iCAAkCtE,MAAO,aAAc4kB,QAAS,IACvE,CAAEtgB,IAAK,2BAA4BtE,MAAO,OAAQ4kB,QAAS,IAC3D,CAAEtgB,IAAK,4BAA6BtE,MAAO,QAAS4kB,QAAS,IAC7D,CAAEtgB,IAAK,8BAA+BtE,MAAO,UAAW4kB,QAAS,KAG7DlqB,GAAOiqB,GAAMvrB,KAAI,SAACC,EAAGwK,GAAJ,MAAW,CAAErL,MAAOa,EAAE2G,MAAOgc,MAAO3iB,EAAEurB,YAEvDC,GAAYnsB,IAAO4L,IAAV,MAMTwgB,GAAQ,SAAC,GAIR,IAAD,IAHJC,QAAWzgB,EAGP,EAHOA,IAAKtE,EAGZ,EAHYA,MAChBglB,EAEI,EAFJA,WAEI,IADJC,gBACI,MADO,kBAAM,MACb,IAC0BrtB,oBAAS,GADnC,mBACGstB,EADH,KACYC,EADZ,KAEE5K,EAAc,SAACva,GACnBmlB,IAAWnlB,GACXilB,EAASjlB,IASX,OACE,cAAC6kB,GAAD,CACEtK,YAAa,kBAAMA,EAAYva,IAC/BolB,WAAY,kBAAM7K,KAClB7V,IAAKJ,EACLiG,IAAKvK,EACL3D,MAZiB,CACnB+F,MAAO4iB,EACPpjB,OAAQ,OACRyjB,UAAWH,EAAU,mBAAqB,WAcxCI,GAAS,SAAC,GAAyD,IAAvDptB,EAAsD,EAAtDA,OAAsD,IAA9CkK,aAA8C,MAAtC,IAAsC,MAAjC4iB,kBAAiC,MAApB,IAAoB,EAAfC,EAAe,EAAfA,SACvD,OACE,qBAAK5oB,MAAO,CAAE+F,SAAd,SACGlK,EAAOkB,KAAI,SAACC,GAAD,OACV,cAAC,GAAD,CAEE0rB,QAAS1rB,EACT2rB,WAAYA,EACZC,SAAUA,GAJZ,eACe5rB,EAAE2G,cAUnBulB,GAAM7sB,IAAOC,IAAV,MAIa,qBAAGZ,SAEV,qBAAGoB,QA+CHqsB,GApCM,SAAC,GAAuB,IAAD,IAApBxY,aAAoB,MAAZ2X,GAAY,IACV/sB,qBADU,mBACnC8d,EADmC,KACzB+P,EADyB,OAEd7tB,mBAAS,IAFK,mBAEnCM,EAFmC,KAE3BisB,EAF2B,KAQ1C,OAJAve,qBAAU,WACRue,EAAUnX,KACT,IAGD,sBACE3Q,MAAO,CACLiP,QAAS,OACT4V,eAAgB,SAChBwE,WAAY,UAJhB,UAOE,cAAC,GAAD,CAAQxtB,OAAQA,EAAQ+sB,SAAU,SAACjlB,GAAD,OAAWylB,EAAYzlB,MACzD,qBAAK3D,MAAO,CAAEiP,QAAS,OAAQqa,aAAc,UAA7C,SACE,cAAC,YAAD,CACEtpB,MAAO,CAAE+F,MAAO,IAAK8J,UAAW,UAChCzH,KAAM/J,GACNkrB,QAAS,GACTC,QAAS,GACTC,SAAU,SAACC,GAAD,OA9BG,SAACA,EAAK5sB,EAAMpB,GACjC,OACE,cAACwtB,GAAD,CAAqBpsB,KAAMA,EAAMpB,MAAOA,EAAxC,SACGguB,EAAIvtB,OADGutB,EAAIvtB,OA6BNwtB,CACED,EACAA,EAAI/J,MACJ+J,EAAIvtB,QAAUkd,EAAW,SAAW,0BClH5CiP,GAAQ,CACZ9E,QAAS,CACP,CAAEzc,GAAI,GAAIb,KAAM,mBAAoB0jB,QAAS,CAAC,GAAI,GAAI,GAAI,GAAI,KAC9D,CAAE7iB,GAAI,GAAIb,KAAM,mBAAoB0jB,QAAS,CAAC,GAAI,GAAI,KACtD,CAAE7iB,GAAI,GAAIb,KAAM,mBAAoB0jB,QAAS,CAAC,GAAI,KAClD,CACE7iB,GAAI,IACJ6iB,QAAS,CACP,CAAE5iB,GAAI,GAAId,KAAM,gBAChB,CAAEc,GAAI,GAAI/J,EAAG,GACb,CAAE+J,GAAI,GAAI/J,EAAG,GACb,CAAE+J,GAAI,GAAI/J,EAAG,GACb,CAAE+J,GAAI,GAAId,KAAM,cAChB,CAAEc,GAAI,GAAId,KAAM,oBAChB,CAAEc,GAAI,GAAId,KAAM,qBAGpB,CACEa,GAAI,IACJ6iB,QAAS,CACP,CAAE5iB,GAAI,GAAId,KAAM,kBAChB,CAAEc,GAAI,GAAI/J,EAAG,GACb,CAAE+J,GAAI,GAAI/J,EAAG,GACb,CAAE+J,GAAI,GAAI/J,EAAG,GACb,CAAE+J,GAAI,GAAId,KAAM,oBAChB,CAAEc,GAAI,GAAId,KAAM,oBAChB,CAAEc,GAAI,GAAId,KAAM,uBAItB2jB,OAAQ,CACN,CAAE/a,KAAM,CAAC,EAAG,GAAIE,GAAI,CAAC,EAAG,IACxB,CAAEF,KAAM,CAAC,EAAG,GAAIE,GAAI,CAAC,EAAG,IACxB,CAAEF,KAAM,CAAC,EAAG,GAAIE,GAAI,CAAC,EAAG,IACxB,CAAEF,KAAM,CAAC,EAAG,GAAIE,GAAI,CAAC,EAAG,IACxB,CAAEF,KAAM,CAAC,EAAG,GAAIE,GAAI,CAAC,EAAG,IACxB,CAAEF,KAAM,CAAC,EAAG,GAAIE,GAAI,CAAC,EAAG,IACxB,CAAEF,KAAM,CAAC,EAAG,GAAIE,GAAI,CAAC,EAAG,IACxB,CAAEF,KAAM,CAAC,EAAG,GAAIE,GAAI,CAAC,EAAG,IACxB,CAAEF,KAAM,CAAC,EAAG,GAAIE,GAAI,CAAC,EAAG,IACxB,CAAEF,KAAM,CAAC,EAAG,GAAIE,GAAI,CAAC,EAAG,IACxB,CAAEF,KAAM,CAAC,EAAG,GAAIE,GAAI,CAAC,EAAG,IACxB,CAAEF,KAAM,CAAC,EAAG,GAAIE,GAAI,CAAC,EAAG,IACxB,CAAEF,KAAM,CAAC,EAAG,GAAIE,GAAI,CAAC,EAAG,IACxB,CAAEF,KAAM,CAAC,EAAG,GAAIE,GAAI,CAAC,EAAG,IACxB,CAAEF,KAAM,CAAC,EAAG,GAAIE,GAAI,CAAC,EAAG,IACxB,CAAEF,KAAM,CAAC,EAAG,GAAIE,GAAI,CAAC,EAAG,IACxB,CAAEF,KAAM,CAAC,EAAG,GAAIE,GAAI,CAAC,EAAG,IACxB,CAAEF,KAAM,CAAC,EAAG,GAAIE,GAAI,CAAC,EAAG,IACxB,CAAEF,KAAM,CAAC,EAAG,GAAIE,GAAI,CAAC,EAAG,IACxB,CAAEF,KAAM,CAAC,EAAG,GAAIE,GAAI,CAAC,EAAG,IACxB,CAAEF,KAAM,CAAC,EAAG,GAAIE,GAAI,CAAC,EAAG,IACxB,CAAEF,KAAM,CAAC,EAAG,GAAIE,GAAI,CAAC,EAAG,IACxB,CAAEF,KAAM,CAAC,EAAG,GAAIE,GAAI,CAAC,EAAG,IACxB,CAAEF,KAAM,CAAC,EAAG,GAAIE,GAAI,CAAC,EAAG,IACxB,CAAEF,KAAM,CAAC,EAAG,GAAIE,GAAI,CAAC,EAAG,IACxB,CAAEF,KAAM,CAAC,EAAG,GAAIE,GAAI,CAAC,EAAG,IACxB,CAAEF,KAAM,CAAC,EAAG,GAAIE,GAAI,CAAC,EAAG,MAItB8a,GAAqB,CACzB7sB,EAAG,EACHiJ,KAAM,SAGF6jB,GAAc,SAAC,GAAD,IAAG7hB,EAAH,EAAGA,MAAO8hB,EAAV,EAAUA,SAAV,mBAAC,eAChBF,IADe,IAElB3rB,IAAI,UAAD,OAAY+J,EAAZ,YAAqB8hB,EAAShjB,KAC9BgjB,IAGCC,GAAS,SAAC,GAAD,IAAG/hB,EAAH,EAAGA,MAAOnB,EAAV,EAAUA,GAAI6iB,EAAd,EAAcA,QAAd,IAAuB3sB,SAAvB,MAA2B,EAA3B,EAA8BiJ,EAA9B,EAA8BA,KAA9B,OACb0jB,EAAQ7sB,KAAI,SAACiK,GACX,IAAM1L,EAEAyuB,GADU,kBAAP/iB,EACS,CACVkB,QACA8hB,SAAS,aAAGjjB,MAAOC,IAET,CACVkB,QACA8hB,SAAU,CAAEjjB,KAAIC,KAAI/J,IAAGiJ,UAE/B,OAAO,sCAAY5K,QAGjB4uB,GAAmB,SAAC,GAAkB,IAK3BC,EALWrb,EAAe,EAAfA,KAAME,EAAS,EAATA,GAC1Bob,EAAQ,SAACD,EAAK3iB,GAClB,IAAM6iB,EAAS/B,GAAM9E,QAAQ2G,GAAKP,QAAQpiB,GAC1C,MAAyB,kBAAX6iB,EAAsBA,EAAOrjB,GAAKqjB,GAIlD,OACE,sBACE7jB,IAJW2jB,EAIDrb,EAAK,GAJIwZ,GAAM9E,QAAQ2G,GAAKpjB,GAAK+iB,GAAmB7sB,GAK9DwJ,GAAI2jB,EAAMtb,EAAK,GAAIA,EAAK,IACxBpI,GALa,SAACyjB,GAAD,OAAS7B,GAAM9E,QAAQ2G,GAAKpjB,GAAK+iB,GAAmB7sB,EAK7DqtB,CAAStb,EAAG,IAChBrI,GAAIyjB,EAAMpb,EAAG,GAAIA,EAAG,IACpB/I,OAAO,OACPD,YAAa,GACbukB,UAAU,qBAiCDC,GA5BY,SAAC,GAAD,IAAGxqB,EAAH,EAAGA,MAAO8B,EAAV,EAAUA,GAAV,IAAc2oB,wBAAd,MAAiC,GAAjC,SACzB,qBAAKzqB,MAAOA,EAAO8B,GAAIA,EAAvB,SACE,sBAAK4oB,MAAM,6BAA6BpkB,QAAQ,cAAhD,UACE,+BACE,wBACExE,GAAG,YACH6oB,YAAY,IACZC,aAAa,IACbC,KAAK,KACLC,KAAK,IACLrJ,OAAO,OANT,SAQE,yBAASxa,OAAO,sBAGnBqhB,GAAM9E,QAAQzmB,KAAI,SAACguB,EAAGvjB,GAAJ,OACjB,cAAC,GAAD,eAAgCujB,GAAhC,iBAAuBvjB,OAGxB8gB,GAAMuB,OAAO9sB,KAAI,SAACM,EAAGmK,GAAJ,OAChB,cAAC,GAAD,eAAsDnK,GAAtD,6BAA6CmK,OAG9CijB,Q,0oFC5HP,IAAM9kB,GAASC,YAAH,MAKNolB,GAAQ3uB,IAAOC,IAAV,MAQW,qBAAG4L,SAUnB+iB,GAAS,SAAC,GAAuB,IAArBtL,EAAoB,EAApBA,MAAO9jB,EAAa,EAAbA,OACjBqvB,EAAS,IAAIpnB,MAAM6b,GAAOzZ,KAAK,GACrC,OACE,qBACElG,MAAO,CACLiP,QAAS,OACTC,cAAe,UAHnB,SAMGgc,EAAOnuB,KAAI,SAACwD,EAAGiH,GAAJ,OACV,cAACwjB,GAAD,CAEE9iB,MAAOV,EAAI,EACX1F,GAAE,gBAAW0F,EAAI,GACjBxH,MAAO,CACLmP,gBAAiBtT,EAAO2L,GAAP,wBAA6B3L,EAAO2L,GAApC,KAA4C,OALjE,gBACgBA,EAAI,UAYtB2jB,GAAsB9uB,IAAOC,IAAV,KAIVqJ,IAGTylB,GAAgB,SAAC,GAAgD,IAAD,IAA7CrlB,aAA6C,MAArC,OAAqC,MAA7BR,cAA6B,MAApB,OAAoB,EAAZ2C,EAAY,EAAZA,MAClDmjB,EAAW,SAACC,GAAD,MAAmB,CAClC/lB,OAAQ,IAAM+lB,GAAgB,GAC9BnlB,GAAI,EACJI,EAAG,IAAM+kB,GAAgB,KAO3B,OACE,cAACH,GAAD,CACEnrB,MAAO,CAAE+F,QAAOR,SAAQhB,SAAU,YAClCzC,GAAE,iBAAYoG,GAFhB,SAKE,sBAAK5B,QAAO,aAAZ,UACE,sBAAMJ,KAAK,eAAelG,MAAOqrB,IAAYruB,EAAG,EAAG+I,MAAO,KAC1D,sBAAMG,KAAK,OAAOlG,MAAOqrB,IAAYruB,EAAG,GAAI+I,MAAO,KACnD,sBAAMG,KAAK,QAAQlJ,EAAG,GAAIuJ,EAAG,GAAIhB,OAAQ,EAAGQ,MAAO,IACnD,sBAAMG,KAAK,QAAQlJ,EAAG,GAAIuJ,EAAG,GAAIhB,OAAQ,EAAGQ,MAAO,IACnD,sBAAMG,KAAK,QAAQlJ,EAAG,GAAIuJ,EAAG,GAAIhB,OAAQ,EAAGQ,MAAO,IACnD,sBACEG,KAAK,QACLlG,MAAOqrB,EAAuB,GAAbnjB,EAAQ,IACzBlL,EAAG,GACH+I,MAAO,KAET,sBAAMG,KAAK,mBAAmBlG,MAAOqrB,IAAYruB,EAAG,GAAI+I,MAAO,KAC/D,sBAAMG,KAAK,kBAAkBlG,MAAOqrB,IAAYruB,EAAG,GAAI+I,MAAO,KAC9D,yBAASgB,GAAG,KAAKC,GAAG,KAAKb,GAAG,KAAKolB,GAAG,KAAKvrB,MAzB1B,CACnBiG,OAAQ,kBACRD,YAAa,EACbE,KAAM,UAuBF,sBAAMlJ,EAAE,KAAKuJ,EAAE,KAAKya,WAAW,SAAShhB,MAAO,CAAEwrB,KAAM,cAAvD,qBAQFC,GAASpvB,IAAOC,IAAV,MAWqB,qBAAG4L,SAiB9BwjB,GAAU,SAAC,GAAe,IAAb/L,EAAY,EAAZA,MACXuL,EAAS,IAAIpnB,MAAM6b,GAAOzZ,KAAK,GACrC,OACE,qBACElG,MAAO,CACLiP,QAAS,OACTC,cAAe,SACfyc,UAAW,IACXjX,WAAY,GACZmQ,eAAgB,gBANpB,SASGqG,EAAOnuB,KAAI,SAACwD,EAAGiH,GAAJ,OACV,cAACikB,GAAD,CAAQvjB,MAAOV,EAAI,EAAnB,SACE,cAAC,GAAD,CAAeU,MAAOV,EAAI,KAD5B,iBAAqCA,EAAI,UAQ3CokB,GAAa,CACjB,GACA,QACA,kBACA,gBACA,mBAGIC,GAAkB,CAAC,GAAI,wBAAU,wBAAU,wBAAU,yBAErDC,GAAY,SAAC,GAAD,IAAG5jB,EAAH,EAAGA,MAAH,OAChB,qBAAKlI,MAAO,CAAEtE,MAAOkwB,GAAW1jB,GAAQ5C,UAAW,IAAnD,SACGumB,GAAgB3jB,MAIf6jB,GAAc,CAClB,KACA,2BACA,2BACA,4BAGIC,GAAe3vB,IAAOqF,OAAV,MA4BZuqB,GAAU,SAAC,GAAiC,IAA/B3oB,EAA8B,EAA9BA,QAAS4oB,EAAqB,EAArBA,eAC1B,OACE,sBAAKlsB,MAAO,CAAE6P,UAAW,SAAU3D,aAAc,IAAjD,UACE,eAAC8f,GAAD,CAAc1oB,QAAS,kBAAMA,EAAQ,IAAIsI,SAAUsgB,EAAnD,UACE,cAAC,GAAD,CAAOtoB,OAAO,WADhB,qBAGA,cAACooB,GAAD,CAAc1oB,QAAS,kBAAMA,KAAWsF,MAAM,QAA9C,SACE,cAAC,GAAD,CAAOhF,OAAO,iBAgGPuoB,GA1FK,WAAO,IAAD,EACY5wB,mBAAS,GADrB,mBACjB6wB,EADiB,KACLC,EADK,KAElBC,EAAWxR,iBAAO,IAFA,EAGEvf,mBAAS,IAHX,mBAGjBgxB,EAHiB,KAGVC,EAHU,KAKxBjjB,qBAAU,WACRjI,YAAW,kBAAM+qB,EAAc,KAAI,OAClC,IAEH,IAAMI,EAAYvb,uBAAY,WAC5B,GAAIkb,EAAa,EAAG,CAGlB,IAFA,IAAMM,EAAS,GAENllB,EAAI,EAAGA,GAAK4kB,EAAY5kB,IAAK,CACpC,IAAMmlB,EAAc,CAClBjxB,MAAOkwB,GAAWpkB,GAClB1K,KAAM,IACN0U,eAAgB,OAChBxL,YAAa,EACbpH,KAAM,YAER8tB,EAAOhsB,KAAP,2BACKisB,GADL,IAEEpb,MAAM,SAAD,OAAW/J,GAChB+F,IAAK,kBAEPmf,EAAOhsB,KAAP,2BACKisB,GADL,IAEEC,YAAa,CAAEroB,SAAU,OAAQsoB,OAAQ,CAAEC,WAAY,KACvDvb,MAAO,eACPhE,IAAI,UAAD,OAAY/F,GACf7D,MAAO,CAAE4J,IAAK,cAAC,GAAD,CAAWrF,MAAOV,QAGpCglB,EAASE,MAEV,CAACN,IAEJ7iB,qBAAU,WACRkjB,MACC,CAACA,IAWJ,OACE,sBAAKzsB,MAAO,CAAEkM,aAAc,KAA5B,UACE,cAAC,GAAD,CAAS5I,QAXY,SAACypB,GAAD,OACvBV,GAAc,SAAChb,GACb,GAAc,OAAV0b,QAA4BptB,IAAVotB,EAAqBV,EAAc,OACpD,CACH,IAAMtiB,EAAUsH,EAAO0b,EACvBV,EAAcnvB,KAAKyH,IAAIzH,KAAK0H,IAAI,EAAGmF,GAAU,SAMXmiB,eAA+B,IAAfE,IACpD,sBACEpsB,MAAO,CACLiP,QAAS,OACT4V,eAAgB,eAChBwE,WAAY,SACZ2D,SAAU,IACVC,SAAU,OAEZ9e,IAAKme,EARP,UAUE,cAAC,GAAD,CAAQ3M,MAAOyM,EAAYvwB,OAAQkwB,KACnC,cAACmB,GAAD,CACEltB,MAAO,CAAE+F,MAAO,KAChBjE,GAAG,eACH2oB,iBAAkB,CAChB,wBAEE1jB,GAAG,MACHC,GAAG,KACH/J,EAAE,KACFgJ,OAAO,kBACPD,YAAa,EACbE,KAAK,QAND,2BAUV,cAAC,GAAD,CAASyZ,MAAOyM,IACfG,EAAMxvB,KAAI,SAACC,GAAD,OACT,cAAC,KAAD,eAA+CA,GAA/C,iBAAuBA,EAAEuU,MAAzB,YAAkCvU,EAAEuQ,gB,0UChS9C,IAAM4f,GAAmB9wB,IAAOC,IAAV,MAIL,oBAAG8wB,OAAH,kBAAY,SAAZ,KAGXC,GAAoB,CACxBvwB,KAAM,EACNwwB,KAAM,EACN5xB,MAAO,SAGH6xB,GAAa,CACjBC,SAAU,SAACC,GACT,IAAMC,EAAS,GAKf,OAJAD,EAASxtB,SAAQ,SAACjD,GACXA,EAAE8E,IAAO9E,EAAE1B,MAAMwG,IACpB4rB,EAAOhtB,KAAP,6BAAkC1D,EAAEqQ,KAApC,uBAEGqgB,GAETC,YAAa,SAAC3wB,GAAD,OACXA,EAAEgD,QACD,QAAShD,EAAEgD,OACV,WAAYhD,EAAEgD,OACd,SAAUhD,EAAEgD,OACZ,UAAWhD,EAAEgD,QACjB4tB,sBAAuB,SAACH,GAAD,OACrBA,EAAS5vB,QAAO,SAACC,EAAKd,GAAN,OAAYc,GAAOyvB,GAAWI,YAAY3wB,MAAI,IAChE6wB,oBAAqB,SAACJ,GAAD,OACnBA,EAAS5vB,QAAO,SAACC,EAAKd,GAAN,OAAYc,GAAO,UAAWd,KAAG,IACnD8wB,WAAY,SAACL,GAEX,OADoBF,GAAWM,oBAAoBJ,GAE1CA,EACJ1wB,KAAI,SAACC,GAAD,OACFW,OAAOC,KAAKZ,EAAEgf,OAAS,KAAO,IAAIjf,KAAI,SAACgxB,GAAD,MAAQ,CAC7Cjf,KAAM9R,EAAE8E,GACRkN,GAAI+e,EACJC,OAAO,2BAAMX,IAAsBrwB,EAAEgf,MAAM+R,WAG9CrP,OAGI+O,EAAS5vB,QAAO,SAACC,EAAKd,EAAGwK,GAC9B,OAAIA,IAAMimB,EAASjwB,OAAS,EAAUM,EAChC,GAAN,mBACKA,GADL,CAEE,CACEgR,KAAM9R,EAAE1B,MAAMwG,GACdkN,GAAIye,EAASjmB,EAAI,GAAGlM,MAAMwG,GAC1BksB,OAAQX,QAGX,MAKHY,GAAyB5xB,IAAOC,IAAV,MAgGb4xB,GAxFG,SAAC,GASZ,IARLzyB,EAQI,EARJA,KACAgyB,EAOI,EAPJA,SACA3wB,EAMI,EANJA,KACAkD,EAKI,EALJA,MACAmuB,EAII,EAJJA,eACAC,EAGI,EAHJA,QACAC,EAEI,EAFJA,mBAEI,IADJC,wBACI,MADe,EACf,EACEC,EAAgBH,GAAWD,EAD7B,EAEsB5yB,mBAAS,IAF/B,mBAEGygB,EAFH,KAEUwS,EAFV,KAGEd,EAASH,GAAWC,SAASC,GAC/BC,EAAOlwB,QACTqD,QAAQimB,MAAM4G,EAAOxmB,KAAK,OAG5B,IAAMunB,EAAS,SAACzxB,GAAD,gBAAUA,EAAE8R,KAAZ,YAAoB9R,EAAEgS,KACrCzF,qBAAU,WACR,GAAIglB,EACF,GAAIF,EAAoB,CACtBG,GAAS,SAACnd,GAAD,MAAU,MACnB,IAAMrQ,EAAMusB,GAAWO,WAAWL,GAAU1wB,KAAI,SAACC,GAAD,OAAO,kBACrDwxB,GAAS,SAACnd,GAAD,OACPA,EAAKtC,MAAK,SAACgf,GAAD,OAAOU,EAAOV,KAAOU,EAAOzxB,MAAMqU,EAA5C,sBAAuDA,GAAvD,CAA6DrU,WAGjE4D,EAAMI,EAAKstB,QAEXE,EAASjB,GAAWO,WAAWL,SAEvBW,GACVI,EAAS,MAEV,CACDA,EACAf,EACAc,EACAH,EACAE,EACAD,IAGF,IAAMK,EAAiBnB,GAAWK,sBAAsBH,GAAjC,aACjBlpB,SAAU,YAAezH,GAC3B,CACEmS,QAAS,OACT4V,eAAgB,eAChBwE,WAAY,SACZsF,KAAM,GAGNC,EAAe,SAAC5xB,GAAD,OACnBuwB,GAAWI,YAAY3wB,GAAvB,aAA8BuH,SAAU,YAAevH,EAAEgD,OAAU,MAErE,OACE,cAACmtB,GAAD,CAAkBntB,MAAOA,EAAzB,SACE,sBAAKA,MAAO0uB,EAAZ,UACGjB,EAAS1wB,KAAI,SAACC,EAAGwK,GAAJ,OACZ,cAACymB,GAAD,CAEEnsB,GAAI9E,EAAE8E,GACN9B,MAAO4uB,EAAa5xB,GAHtB,SAKGA,EAAE6xB,QAAU7xB,EAAE6xB,QAAU7xB,GAL3B,UACUvB,EADV,YACkB+L,OAOnBwU,EAAMjf,KAAI,SAACC,GACV,OACE,cAAC,KAAD,CAEEuU,MAAK,UAAKvU,EAAE8R,MACZvB,IAAG,UAAKvQ,EAAEgS,IACVtT,MAAOsB,EAAEgxB,OAAOtyB,MAChBkD,KAAM5B,EAAEgxB,OAAOpvB,KACfoH,YAAahJ,EAAEgxB,OAAOlxB,KACtB8vB,YAAa5vB,EAAEgxB,OAAOc,YACtBC,UAAW/xB,EAAEgxB,OAAOgB,UACpBC,SAAUjyB,EAAEgxB,OAAOV,KACnB9b,iBAAgB+c,GAAgB,QAVlC,UACU9yB,EADV,iBACuBuB,EAAE8R,KADzB,YACiC9R,EAAEgS,c,81DCpI/C,IAAMkgB,GAAa7yB,IAAO4X,GAAV,MAKVkb,GAAW9yB,IAAOC,IAAV,MAIR8yB,GAAoB/yB,IAAOC,IAAV,MAMjB+yB,GAAkBhzB,IAAOC,IAAV,MAKfgzB,GAAuBjzB,IAAOkzB,GAAV,MACpBC,GAAwBnzB,IAAOC,IAAV,MACrBmzB,GAA+BpzB,IAAOC,IAAV,MAO5BozB,GAAoC,SAAC,GASpC,IAAD,IARJ3pB,aAQI,MARI,MAQJ,MAPJinB,gBAOI,MAPO,IAOP,EANJ/kB,EAMI,EANJA,IACAW,EAKI,EALJA,MACAxM,EAII,EAJJA,SACA+gB,EAGI,EAHJA,OAGI,IAFJwS,mBAEI,MAFU,GAEV,MADJC,oBACI,MADW,GACX,EACEjH,EACJxL,GAAUA,EAAO0S,SACbF,EAAcxS,EAAO0S,UAAY,IAAMF,GACvCA,EACN,OACE,cAAC,GAAD,UACE,sBACE3vB,MAAO,CACL+F,QACAinB,WACAznB,OAAQ,IACRhB,SAAU,YALd,UAQE,qBACE8D,IAAG,oBAAeJ,GAClBiG,IAAI,GACJlO,MAAO,CACLuE,SAAU,WACVwB,MAAM,GAAD,OAAK4iB,EAAL,KACLpjB,OAAQ,OACR0I,QAAS2hB,EACTxO,IAAK,MACLte,KAAM,MACN8Z,UAAW,4BAGf,sBACE5c,MAAO,CACLuE,SAAU,WACVwB,MAAO,OACPqb,IAAK,MACLte,KAAM,MACN8Z,UAAW,0BANf,UASE,cAAC0S,GAAD,UAAuB1mB,IACvB,cAACymB,GAAD,UACE,cAACG,GAAD,CAAuBxvB,MAAO,GAA9B,SAAmC5D,eAQzC+wB,GAAmB9wB,IAAOC,IAAV,MAIL,oBAAG8wB,OAAH,kBAAY,SAAZ,KAGX0C,GAAiB,SAAC,GAAgB,IAAd3S,EAAa,EAAbA,OACxB,OACE,qBAAKnd,MAAO+vB,GAAiB5S,GAA7B,SACE,eAAC,GAAD,CACEvU,MAAM,uBACNX,IAAI,eACJlC,MAAM,MACNoX,OAAQA,EAJV,UAME,ugBASA,iXAYF6S,GAAY3zB,IAAOC,IAAV,MAUT2zB,GAAyB,SAAC,GAAD,IAAG9S,EAAH,EAAGA,OAAH,OAC7B,cAAC,GAAD,CACE1hB,KAAK,uBACLgyB,SAAU,CACR,qBAAKplB,IAAI,sBAAsBvG,GAAG,oBAAoBoM,IAAI,KAC1D,cAACgf,GAAD,CAAoBltB,MAAO,CAAE+F,MAAO,KAAOjE,GAAG,sBAC9C,cAACkuB,GAAD,CAAWluB,GAAG,oBAAd,mBAEFssB,QAASjR,GAAUA,EAAOiR,QAC1BD,eAAgBhR,GAAUA,EAAOiR,QACjCC,oBAAoB,EACpBC,iBAAkB,OAIhB4B,GAA4B,kBAChC,cADiC,CAChC,GAAD,CAAkB9C,OAAO,QAAzB,UACE,cAAC,KAAD,CACE+C,OAAO,yBACPC,MAAM,4BACN/iB,KAAK,QACLlR,MAAO,GACPk0B,QAAM,IAQR,cAAC,KAAD,CACEF,OAAO,yBACPC,MAAM,4BACN/iB,KAAK,OACLgjB,QAAM,QAUNC,GAAiB,SAAC,GAAD,IAAG/qB,EAAH,EAAGA,OAAH,OACrB,qBAAKvF,MAAO,CAAE+F,MAAO,OAAQR,OAAO,GAAD,OAAKA,EAAL,UAG/BgrB,GAAqB,SAAC,GAAe,IAAbC,EAAY,EAAZA,MACtB3tB,EAAkB,iBAClB4tB,EAAS,CACbC,wBAAyB,CACvB7tB,kBACA8tB,SAAU,iEAEZC,WAAY,CACV/tB,kBACA8tB,SAAU,iDAEZE,aAAc,CACZhuB,kBACA8tB,SACE,mFAEJG,WAAY,CACVjuB,kBACA8tB,SAAU,8CAGd,OACE,sBAAK3wB,MAAO,CAAE+F,MAAO,QAArB,UACE,qBACEsC,IAAG,gCACHrI,MAAO,CACLuF,OAAQ,OACRQ,MAAO,QAETmI,IAAI,KAEN,qBACElO,MAAK,aACHuE,SAAU,WACV6c,IAAK,EACLrb,MAAO,OACPR,OAAQ,OACRqS,WAAY,sBACZ3J,QAASuiB,EAAQ,EAAI,GACjBC,EAAOD,IAAU,UAOzBT,GAAmB,SAAC5S,GACxB,IAAM4T,EAAW,CAAE9iB,QAAS,IAAK2J,WAAY,uBAC7C,OAAOuF,GAAUA,EAAOiR,QAAU2C,EAA3B,2BAA2CA,GAA3C,IAAqD9iB,QAAS,SAGjE+iB,GAAkB30B,IAAOqF,OAAV,MAefuvB,GAAY,SAAC,GAAD,IAAG70B,EAAH,EAAGA,SAAU6mB,EAAb,EAAaA,QAASiO,EAAtB,EAAsBA,SAAtB,OAChB,cAACF,GAAD,CAAiB7N,aAAcF,EAASI,aAAc6N,EAAtD,SACG90B,KAIC+0B,GAAyB,SAAC,GAAD,IAAG/0B,EAAH,EAAGA,SAAUo0B,EAAb,EAAaA,MAAOY,EAApB,EAAoBA,SAApB,OAC7B,cAAC,GAAD,CAAWnO,QAAS,kBAAMmO,EAASZ,IAAQU,SAAU,kBAAME,EAAS,KAApE,SACGh1B,KAICi1B,GAAgBh1B,IAAOC,IAAV,MAIbg1B,GAA6Bj1B,YAAOg1B,GAAPh1B,CAAH,MACnB,gBAAGk1B,EAAH,EAAGA,YAAaC,EAAhB,EAAgBA,SAAhB,OACTD,GAAeA,EAAYlzB,OAASmzB,EAAW,IAAM,SAKnDC,GAAgB,SAAC,GAAgB,IAAdtU,EAAa,EAAbA,OAAa,EACE5hB,qBADF,mBAC7Bg2B,EAD6B,KAChBG,EADgB,OAEVn2B,qBAFU,mBAE7Bi1B,EAF6B,KAEtBY,EAFsB,KAQpC,OALA7nB,qBAAU,WACR6nB,EACEG,GAAoC,MAArBA,EAAYlzB,KAAe,0BAA4B,MAEvE,CAACkzB,IAEF,sBAAKvxB,MAAO+vB,GAAiB5S,GAA7B,UACE,cAACmS,GAAD,+BACA,eAACD,GAAD,WACE,cAACG,GAAD,CAAuBxvB,MAAO,CAAE2xB,UAAW,OAA3C,SACE,eAAC,KAAD,CACEC,YAAaF,EACbG,WAAY,kBAAMH,EAAe,OACjC7E,OAAQ,GAHV,UAKE,cAAC,KAAD,CAAMxuB,KAAK,IAAX,SACE,eAACizB,GAAD,CACEE,SAAS,IACTD,YAAaA,EAFf,UAIE,wEACA,wiBAcJ,cAAC,KAAD,CAAMlzB,KAAK,IAAX,SACE,eAACizB,GAAD,CACEE,SAAS,IACTD,YAAaA,EAFf,UAIE,ogBAUA,cAAC,GAAD,CAAwBpU,OAAQA,SAIpC,cAAC,KAAD,CAAM9e,KAAK,IAAX,SACE,eAACizB,GAAD,CACEE,SAAS,IACTD,YAAaA,EAFf,UAIE,sFACA,iJAGE,cAAC,GAAD,CACEf,MAAM,aACNY,SAAUA,EAFZ,mBAHF,IAUE,cAAC,GAAD,CACEZ,MAAM,eACNY,SAAUA,EAFZ,qBAVF,OAiBE,cAAC,GAAD,CACEZ,MAAM,aACNY,SAAUA,EAFZ,mBAjBF,6GA6BJ,cAAC,KAAD,CAAM/yB,KAAK,IAAX,SACE,eAACizB,GAAD,CACEE,SAAS,IACTD,YAAaA,EAFf,UAIE,+DACA,4eASE,6EAEF,uJAIA,cAAC,GAAD,CAA2BpU,OAAQA,IACnC,kdASE,gFAKN,cAAC,KAAD,CAAM9e,KAAK,IAAX,SACE,eAACizB,GAAD,CACEE,SAAS,IACTD,YAAaA,EAFf,UAIE,iFACA,qSAWR,cAAC9B,GAAD,CACEzvB,MAAO,CACL2xB,UAAW,MACXptB,SAAU,SACVe,UAAW,IAJf,SAOE,cAAC,GAAD,CAAoB6X,OAAQA,EAAQqT,MAAOA,aAO/CsB,GAAgB,SAAC,GAAD,IAAGlpB,EAAH,EAAGA,MAAOxM,EAAV,EAAUA,SAAV,IAAoBilB,cAApB,gBACpB,sBACErhB,MAAO,CAAEiP,QAAS,OAAQC,cAAe,SAAUma,WAAY,UADjE,UAGGzgB,IAAUyY,EAAS,cAAC6N,GAAD,UAAatmB,IAAsB,KACtDxM,EACAwM,GAASyY,EAAS,cAAC6N,GAAD,UAAatmB,IAAsB,SAIpDmpB,GAAe,SAAC,GAAD,IAAG5U,EAAH,EAAGA,OAAQnd,EAAX,EAAWA,MAAX,OACnB,cAAC,GAAD,CACEvE,KAAK,aACLqB,KAAM,CAAEyI,OAAQ,IAAKQ,MAAO,KAC5B/F,MAAOA,EACPytB,SAAU,CACR,CACE3rB,GAAI,iBACJ+sB,QACE,cAAC,GAAD,UACE,qBAAKxmB,IAAI,sBAAsB6F,IAAI,OAGvClO,MAAO,CAAEohB,IAAK,KACdpF,MAAO,CACL,wBAAyB,CACvB8S,YAAa,MACbE,UAAW,OACXlyB,KAAM,GACNpB,MAAO,eACPs2B,SAAU,WACVpzB,KAAM,UAIZ,CACEkD,GAAI,wBACJ+sB,QACE,cAAC,GAAD,CAAejmB,MAAM,eAArB,SACE,qBAAKP,IAAI,6BAA6B6F,IAAI,OAG9ClO,MAAO,CAAE8C,KAAM,IAAKse,IAAK,IACzBpF,MAAO,CACL,qBAAsB,CACpBpd,KAAM,WACNlD,MAAO,WAIb,CACEoG,GAAI,qBACJ+sB,QACE,cAAC,GAAD,CAAejmB,MAAM,aAAayY,QAAM,EAAxC,SACE,qBAAKhZ,IAAI,0BAA0B6F,IAAI,OAG3ClO,MAAO,CAAEuD,MAAO,EAAG6d,IAAK,IAE1B,CACEtf,GAAI,8BACJ+sB,QACE,cAAC,GAAD,CAAejmB,MAAM,qBAAqByY,QAAM,EAAhD,SACE,qBAAKhZ,IAAI,mCAAmC6F,IAAI,OAGpDlO,MAAO,CAAE8C,KAAM,IAAKue,OAAQ,GAC5BrF,MAAO,CACL,iBAAkB,CAChB8S,YAAa,OACbE,UAAW,SACXlyB,KAAM,GACNpB,MAAO,eACPkD,KAAM,QAER,qBAAsB,CACpBkwB,YAAa,QACbE,UAAW,SACXlyB,KAAM,GACNpB,MAAO,eACPkD,KAAM,WAKdwvB,QAASjR,GAAUA,EAAOiR,QAC1BD,eAAgBhR,GAAUA,EAAOiR,WAI/B6D,GAA4B,SAAC,GAAD,IAAG9U,EAAH,EAAGA,OAAH,OAChC,sBAAKnd,MAAO+vB,GAAiB5S,GAA7B,UACE,cAACmS,GAAD,gDAGA,eAACD,GAAD,WACE,cAACG,GAAD,CAAuBxvB,MAAO,CAAE2xB,UAAW,OAA3C,SACE,qBAAK3xB,MAAO,CAAE8V,OAAQ,GAAIvR,SAAU,SAAU6c,IAAK,IAAnD,SACE,cAAC,GAAD,CAAcjE,OAAQA,QAG1B,eAACqS,GAAD,CAAuBxvB,MAAO,CAAE2xB,UAAW,OAA3C,UACE,uWAOA,ijBAUA,4fAeFO,GAAuB,SAAC,GAAD,IAAG/U,EAAH,EAAGA,OAAH,OAC3B,sBAAKnd,MAAO+vB,GAAiB5S,GAA7B,UACE,cAACmS,GAAD,qCACA,sBAAKtvB,MAAO,CAAEiP,QAAS,OAAQ4V,eAAgB,iBAA/C,UACE,qBAAKxc,IAAI,wBAAwBvG,GAAG,UAAUoM,IAAI,KAClD,qBAAKlO,MAAO,CAAE8V,OAAQ,UAAtB,0mBAWA,qBAAKzN,IAAI,qBAAqBvG,GAAG,OAAOoM,IAAI,QAE9C,cAAC,GAAD,CAAgB3I,OAAQ,MACxB,8RAMA,cAAC,GAAD,IAEA,cAAC,GAAD,CAAgBA,OAAQ,MACxB,mrBAYA,wZAQA,qKAIA,cAAC,GAAD,IACA,4LAKA,cAAC8pB,GAAD,UACE,cAACG,GAAD,CAAuBxvB,MAAO,CAAE2xB,UAAW,QAA3C,SACE,cAAC,GAAD,CAAkC5rB,MAAM,iBAM1CosB,GAAmC,SAAC72B,GAAD,OACvC,cAAC,GAAD,UACE,cAAC,GAAD,aACEO,OAAQ,CACN,gEACA,iEACA,iEACA,iEACA,kEACA,mEAEF2hB,KACE,qCACE,qEACA,mBAAGxd,MAAO,CAAE8H,SAAU,SAAUpM,MAAO,kBAAvC,63BAkBAJ,OAKJ0Q,GAAkB,SAAC,GAAD,IAAGmR,EAAH,EAAGA,OAAH,OACtB,sBAAKnd,MAAO+vB,GAAiB5S,GAA7B,UACE,cAACmS,GAAD,wCACA,eAACD,GAAD,WACE,cAACG,GAAD,CAAuBxvB,MAAO,CAAE2xB,UAAW,OAA3C,SACE,sBAAK3xB,MAAO,CAAEuE,SAAU,SAAU6c,IAAK,IAAvC,UACE,yLAKA,+TAOA,4MAGwC,+CAHxC,wGAOA,smBASwD,IACtD,qDAVF,wGAeJ,cAACoO,GAAD,CAAuBxvB,MAAO,CAAE2xB,UAAW,OAA3C,SACE,cAAC,GAAD,aAMFS,GAAY,SAAC,GAAD,IAAGjV,EAAH,EAAGA,OAAH,OAChB,sBAAKnd,MAAO+vB,GAAiB5S,GAA7B,UACE,cAACmS,GAAD,0CACA,eAACD,GAAD,WACE,cAACG,GAAD,CAAuBxvB,MAAO,CAAE2xB,UAAW,OAA3C,SACE,cAACU,GAAD,CACEpS,SAAU,GACVsG,iBAAkB,IAClBpF,YAAY,WACZuE,YAAY,gBAIhB,cAAC8J,GAAD,CAAuBxvB,MAAO,CAAE2xB,UAAW,OAA3C,SACE,sBAAK3xB,MAAO,CAAEuE,SAAU,SAAU6c,IAAK,IAAvC,UACE,cAAC,GAAD,CAAgB7b,OAAQ,KACxB,gZAcJ+sB,GAAgBj2B,IAAOC,IAAV,MAObi2B,GAAW,SAAC,GAAyB,IAAvBC,EAAsB,EAAtBA,UAClB,GADwC,EAAXC,KACnB,OAAO,KACjB,IAAyBz1B,EACzB,OACE,qBACEgD,MAAO,CACLuE,SAAU,QACV6c,IAAK,GACLte,KAAM,GACN4vB,OAAQ,aACR7qB,QAAS,EACTkN,OAAQ,kBACRlS,gBAAiB,QARrB,SAWE,gCACE,cAACyvB,GAAD,oBACCE,EAAUjB,aAAe,OAC1B,uBACA,cAACe,GAAD,uBAjBmBt1B,GAmBhBw1B,EAAUA,EAAUjB,cAAgB,CAAE1B,SAAU,KAAMA,SAnB/B7yB,GAAS,IAAJA,GAASL,UAAY,GAatD,UA8FSg2B,GAhFD,SAAC,GAAgC,IAAD,IAA7BC,sBAA6B,WACIr3B,mBAAS,IADb,mBACrCs3B,EADqC,KACnBC,EADmB,OAEVv3B,mBAAS,IAFC,mBAErCi3B,EAFqC,KAE1BO,EAF0B,KA4B5C,OAfAxpB,qBACE,wBACEspB,EAAiBG,KACbD,EAAa,2BACRP,GADO,uBAETK,EAAiBG,KAFR,YAAC,eAGNR,EAAUK,EAAiBG,OAC3BH,IAJK,4BAMGA,EAAiBG,MANpB,KAQZ,OACN,CAACH,IAID,mCACE,eAACzD,GAAD,WACE,cAACD,GAAD,UACE,eAAC,KAAD,CACEyC,YA7BU,SAAC,GAAD,IAAGvzB,EAAH,EAAGA,KAAH,OAClBy0B,EAAoB,CAAEE,KAAM30B,EAAM+vB,SAAS,KA6BnCyD,WA3BS,SAAC,GAAD,IAAGxzB,EAAH,EAAGA,KAAH,OACjBy0B,EAAoB,CAAEE,KAAM30B,EAAM+vB,SAAS,KA2BnCyB,UAAQ,EACRoD,eA1Ba,SAAC,GAAD,IAAG50B,EAAH,EAAGA,KAAMwxB,EAAT,EAASA,SAAT,OACrBiD,EAAoB,CAAEE,KAAM30B,EAAM+vB,SAAS,EAAMyB,cA0BzChD,OAAQ,GACRqG,MAAON,EANT,UAQE,cAAC,KAAD,CAAMv0B,KAAK,WAAX,SACE,cAACgzB,GAAD,UACE,cAAC,GAAD,CAAgBlU,OAAQqV,EAAS,eAGrC,cAAC,KAAD,CAAMn0B,KAAK,kBAAX,SACE,cAACgzB,GAAD,UACE,cAAC,GAAD,CAAelU,OAAQqV,EAAU,yBAGrC,cAAC,KAAD,CAAMn0B,KAAK,MAAX,SACE,cAACgzB,GAAD,UACE,cAAC,GAAD,CAA2BlU,OAAQqV,EAAS,UAGhD,cAAC,KAAD,CAAMn0B,KAAK,MAAX,SACE,cAACgzB,GAAD,UACE,cAAC,GAAD,CAAiBlU,OAAQqV,EAAU,aAGvC,cAAC,KAAD,CAAMn0B,KAAK,aAAX,SACE,cAACgzB,GAAD,UACE,cAAC,GAAD,CAAWlU,OAAQqV,EAAU,oBAGjC,cAAC,KAAD,CAAMn0B,KAAK,yBAAX,SACE,cAACgzB,GAAD,UACE,cAAC,GAAD,CACElU,OAAQqV,EAAU,qCAM5B,cAAC,GAAD,CAAUC,MAAOG,EAAgBJ,UAAWA,U,qBCl1BpDW,KAAMC,cAAc,SAEpB,IAAMC,GAAa,SAAC,GAAyB,IAAvBzqB,EAAsB,EAAtBA,MAAO0qB,EAAe,EAAfA,SACrBpc,EAAS,CACbT,UAAW,CACTvK,aAAc,GAEhBtD,MAAO,CACLd,SAAU,GACVyrB,WAAY,QAEdD,SAAU,CACRxrB,SAAU,GACVpM,MAAO,SAGX,OACE,sBAAKsE,MAAOkX,EAAOT,UAAnB,UACE,qBAAKzW,MAAOkX,EAAOtO,MAAnB,SAA2BA,IAC3B,sBAAM5I,MAAOkX,EAAOoc,SAApB,SAA+BA,QAK/BE,GAAYC,aAAW,YAAkB,IAAfC,EAAc,EAAdA,QAAc,EACRn4B,oBAAS,GADD,mBACrCo4B,EADqC,KACxBC,EADwB,KAEtCC,EAAc,kBAAMD,GAAcD,IAUxC,OACE,qCACE,eAAC,KAAD,CACEG,OAAQH,EACRI,eAAgBF,EAChBG,aAAa,YAHf,UAKE,cAAC,GAAD,CACEprB,MAAM,2CACN0qB,SAAS,0OAKX,wBACEhwB,QAASuwB,EACT7zB,MAAO,CACLuE,SAAU,WACV6c,IAAK,EACL7d,MAAO,EACPwR,OAAQ,EACRhN,WAAY,QAPhB,SAUE,cAAC,IAAD,CAAarM,MAAM,QAAQwO,YAAY,SAG3C,cAAC,IAAD,CACE+pB,iBAAiB,EACjBC,iBAAkB,CAChBrxB,gBAAiB,aAEnBkU,KAAK,QALP,SAOE,cAAC,IAAD,CAAQvG,KAAK,oBAAoBlN,QA3ClB,WACU,OAAzBkJ,OAAO2nB,SAASC,KAElB5nB,OAAO6nB,SAAS,CAAEjT,IAAK,EAAGte,KAAM,EAAGwxB,SAAU,SAE7CZ,EAAQhzB,KAAK,MAsCX,SACE,cAAC,GAAD,CAAOkD,OAAO,qBAyCT2wB,GAlCE,WACf,OACE,cAAC,EAAD,UACE,eAAC,KAAD,WACE,eAAC,IAAD,WACE,cAAC,IAAD,CAAO31B,KAAK,aAAZ,SACE,cAAC,GAAD,MAEF,cAAC,IAAD,CAAOA,KAAK,YAAZ,SACE,cAAC,GAAD,CAAiByI,SAAS,WAE5B,cAAC,IAAD,CAAOzI,KAAK,YAAZ,SACE,cAAC,GAAD,CAAiByI,SAAS,WAE5B,cAAC,IAAD,CAAOzI,KAAK,eAAZ,SACE,cAAC,GAAD,CAAOyI,SAAS,YAElB,cAAC,IAAD,CAAOzI,KAAK,cAAZ,SACE,cAAC,GAAD,CAAOyI,SAAS,WAElB,cAAC,IAAD,CAAOzI,KAAK,cAAZ,SACE,cAAC,GAAD,CAAOyI,SAAS,WAElB,eAAC,IAAD,CAAOzI,KAAK,IAAZ,UACE,cAAC,GAAD,IACA,cAAC,GAAD,UAGJ,cAAC40B,GAAD,UC1GOgB,GAVH,WACV,OACE,qCACE,cAAC,GAAD,IACA,cAAC,IAAD,CAAcryB,OAAO,cCGZsyB,GAZS,SAAAC,GAClBA,GAAeA,aAAuBC,UACxC,8BAAqBC,MAAK,YAAkD,IAA/CC,EAA8C,EAA9CA,OAAQC,EAAsC,EAAtCA,OAAQC,EAA8B,EAA9BA,OAAQC,EAAsB,EAAtBA,OAAQC,EAAc,EAAdA,QAC3DJ,EAAOH,GACPI,EAAOJ,GACPK,EAAOL,GACPM,EAAON,GACPO,EAAQP,OCFdQ,IAASC,OACP,cAAC,IAAMC,WAAP,UACE,cAAC,GAAD,MAEFC,SAASC,eAAe,SAM1Bb,O","file":"static/js/main.02f82b7e.chunk.js","sourcesContent":["import { useState, createContext } from \"react\"\n\nexport const GameContext = createContext()\n\nexport const GameContextProvider = (props) => {\n  const [gameSettings, setGameSettings] = useState({\n    players: [\n      { name: \"YOU\", color: \"green\", selections: [], score: null },\n      {\n        name: \"CARNAC\",\n        color: \"red\",\n        selections: [],\n        score: null,\n      },\n    ],\n    images: [],\n    previousPracticeRounds: [],\n    practiceRound: {},\n  })\n\n  return (\n    <GameContext.Provider value={[gameSettings, setGameSettings]}>\n      {props.children}\n    </GameContext.Provider>\n  )\n}\n","import styled from \"styled-components\"\n\nconst Container = styled.div`\n  margin-top: 2px;\n  background-color: #444;\n  color: white;\n  display: flex;\n  flex-direction: column;\n  font-family: Futura;\n  min-width: 400px;\n  max-width: 400px;\n  width: 400px;\n`\n\nconst Board = styled.div`\n  margin: 6px;\n  border: 5px solid white;\n  border-radius: 10px;\n  flex-direction: row;\n`\n\nconst SideContainer = styled.div`\n  display: flex;\n  flex-direction: row;\n`\n\nconst Side = styled.div`\n  flex: 1;\n  text-align: center;\n`\nconst Team = styled.div`\n  padding: 10px;\n  text-align: center;\n  font-size: 24pt;\n  border-bottom: 5px solid white;\n  margin: 0;\n  font-weight: bold;\n`\nconst ScoreContainer = styled.div`\n  padding: 10px;\n`\nconst Score = styled.div`\n  font-size: 48pt;\n  font-family: Impact, sans-serif;\n`\nconst Bottom = styled.div`\n  font-size: 18;\n  padding: 5px;\n  border-top: 5px solid white;\n  font-weight: bold;\n  text-align: center;\n`\n\nexport const scoreDisplays = (player, totalPossible) =>\n  player.score\n    ? {\n        score:\n          totalPossible > 0 ? `${player.score}/${totalPossible}` : player.score,\n        percentage:\n          totalPossible > 0\n            ? ((player.score / totalPossible) * 100).toFixed()\n            : null,\n      }\n    : null\n\nconst ScoreBoard = ({\n  home,\n  away,\n  bottomDisplay = () => \"\",\n  totalPossible = 0,\n}) => {\n  const ScoreboardSide = ({ player, style = {} }) => {\n    const displays = scoreDisplays(player, totalPossible)\n    return (\n      <Side style={style}>\n        <Team style={{ color: player.color }}>{player.name}</Team>\n        <ScoreContainer>\n          <Score>{displays.score}</Score>\n          {displays.percentage}\n        </ScoreContainer>\n      </Side>\n    )\n  }\n\n  const bottom = bottomDisplay()\n\n  return (\n    <Container>\n      <Board>\n        <SideContainer>\n          <ScoreboardSide player={home} />\n          <ScoreboardSide\n            player={away}\n            style={{ borderLeft: \"3px solid white\" }}\n          />\n        </SideContainer>\n        {bottom ? <Bottom>{bottom}</Bottom> : null}\n      </Board>\n    </Container>\n  )\n}\n\nexport default ScoreBoard\n","const colors = [\"0,0,255\", \"255,0,0\", \"0,255,0\", \"255,0,255\"]\n\nconst defaultDataSet = {\n  borderWidth: 1,\n}\n\nconst dataSet = (index) => {\n  const color = colors[index]\n  const backgroundColor = `rgba(${color},0.4)`\n  const borderColor = `rgba(${color},0.7)`\n  return {\n    ...defaultDataSet,\n    backgroundColor,\n    borderColor,\n  }\n}\n\nconst selectionData = (data) =>\n  Object.keys(data.MI_class_results || {}).reduce(\n    (all, x) => ({ ...all, [x]: data.MI_class_results[x].mi_auc }),\n    {}\n  )\n\nexport const configurationKeys = (configurations) =>\n  Object.keys(configurations).filter(\n    (x) => typeof configurations[x] === \"object\"\n  )\n\nconst fetchConfigurationData = async (configuration) => {\n  const key = (x) => `${x.flavor}_${x.dataset}_${x.architecture}_${x.train}`\n  const filepath = (name) => `./data/${name}.json`\n  const filekey = key(configuration)\n  let results\n  try {\n    const response = await fetch(filepath(filekey))\n    results = await response.json()\n  } catch (e) {\n    console.log(`No data file available for configuration ${filekey}`)\n    const response = await fetch(filepath(\"missing_data\"))\n    results = await response.json()\n  }\n  return [filekey, results]\n}\n\nexport const configurationData = async (configuration) => {\n  const [key, json] = await fetchConfigurationData(configuration)\n  return {\n    key,\n    data: selectionData(json),\n  }\n}\n\nexport const chartData = (selections) => {\n  const selectionKeys = configurationKeys(selections)\n  const hasData = selectionKeys.reduce(\n    (all, x) => all && \"data\" in selections[x],\n    true\n  )\n  if (hasData) {\n    const labels = [\n      ...new Set(\n        selectionKeys.reduce(\n          (all, x) => [...all, ...Object.keys(selections[x].data || {})],\n          []\n        )\n      ),\n    ].sort((a, b) => parseInt(a) > parseInt(b))\n    const keyData = selectionKeys.reduce(\n      (all, x) => ({\n        ...all,\n        [selections[x].key]: {\n          data: selections[x].data,\n          label: `MI AUC (${selections[x].flavor}/${selections[x].dataset}/${selections[x].architecture}/${selections[x].train})`.toUpperCase(),\n        },\n      }),\n      {}\n    )\n    return {\n      labels,\n      datasets: Object.keys(keyData).map((x, i) => {\n        return {\n          ...dataSet(i),\n          label: keyData[x].label,\n          data: labels.map((y) => keyData[x].data[y]),\n        }\n      }),\n    }\n  } else return {}\n}\n\nconst sample = (items, size) =>\n  items\n    .map((x) => ({ x, r: Math.random() }))\n    .sort((a, b) => a.r - b.r)\n    .map((a) => a.x)\n    .slice(0, size || items.length)\n\nexport const PRACTICE_ROUND_IMAGE_COUNT = 5\nexport const GAME_IMAGE_COUNT = 12\n\nconst sanitizeJson = (obj) => {\n  const stringToBooleanOrOriginal = (p) =>\n    p && (p === \"true\" || p === \"false\") ? p.toLowerCase() === \"true\" : p\n  return Object.keys(obj).reduce(\n    (all, x) => ({\n      ...all,\n      [x]: stringToBooleanOrOriginal(obj[x]),\n    }),\n    {}\n  )\n}\n\nexport const cleanObject = (x) =>\n  Object.keys(x || {})\n    .filter((key) => x[key])\n    .reduce((all, key) => ({ ...all, [key]: x[key] }), {})\n\n// const PRACTICE_SETS = [1, 2]\n// const PRACTICE_SETS = [1, 2, 3, 4, 5]\n\nconst allGroups = (data) =>\n  data.reduce((all, x) => [...new Set([...all, ...(x.groups || [])])], [])\n\nconst practiceSet = (images, groupNumber) => {\n  // setIndex = isDef(setIndex)\n  //   ? setIndex\n  //   : PRACTICE_SETS[Math.floor(Math.random() * PRACTICE_SETS.length)]\n  return images.filter((x) => x.groups && x.groups.includes(groupNumber))\n}\n\nexport const gameData = async ({\n  path = \"./data/game-data.json\",\n  snippetId = null,\n} = {}) => {\n  const fetchPath = snippetId\n    ? `https://gitlab-int.ctc.com/api/v4/snippets/${snippetId}/raw`\n    : path\n  const allOptions = await fetch(fetchPath)\n  const data = await allOptions.json()\n  const correctData = data.map(sanitizeJson)\n  return {\n    practiceOptions: allGroups(correctData).reduce(\n      (all, x) => ({ ...all, [x]: practiceSet(correctData, x) }),\n      {}\n    ),\n    gameOptions: sample(correctData, GAME_IMAGE_COUNT),\n  }\n}\n\nexport const matchData = async () => ({\n  \"bird_image_1.png\": {\n    match: {\n      easy: [\n        \"match_game_cifar_robust_images_bird_threshold_512.png\",\n        \"match_game_cifar_robust_images_bird_0.png\",\n        \"match_game_cifar_robust_images_bird_1.png\",\n        \"match_game_cifar_robust_images_bird_2.png\",\n        \"match_game_cifar_robust_images_bird_3.png\",\n      ],\n      hard: [\n        \"match_game_cifar_diluted_robust_images_bird_threshold_512.png\",\n        \"match_game_cifar_diluted_robust_images_bird_0.png\",\n        \"match_game_cifar_diluted_robust_images_bird_1.png\",\n        \"match_game_cifar_diluted_robust_images_bird_2.png\",\n        \"match_game_cifar_diluted_robust_images_bird_3.png\",\n      ],\n    },\n  },\n  \"cat_image_18.png\": {\n    match: {\n      easy: [\n        \"match_game_cifar_robust_images_cat_threshold_512.png\",\n        \"match_game_cifar_robust_images_cat_0.png\",\n        \"match_game_cifar_robust_images_cat_1.png\",\n        \"match_game_cifar_robust_images_cat_2.png\",\n        \"match_game_cifar_robust_images_cat_3.png\",\n      ],\n      hard: [\n        \"match_game_cifar_diluted_robust_images_cat_threshold_512.png\",\n        \"match_game_cifar_diluted_robust_images_cat_0.png\",\n        \"match_game_cifar_diluted_robust_images_cat_1.png\",\n        \"match_game_cifar_diluted_robust_images_cat_2.png\",\n        \"match_game_cifar_diluted_robust_images_cat_3.png\",\n      ],\n    },\n  },\n  \"deer_image_13.png\": {\n    match: {\n      easy: [\"match_game_cifar_robust_images_deer_threshold_512.png\"],\n      hard: [\"match_game_cifar_diluted_robust_images_deer_threshold_512.png\"],\n    },\n  },\n  \"dog_image_16.png\": {\n    match: {\n      easy: [\"match_game_cifar_robust_images_dog_threshold_512.png\"],\n      hard: [\"match_game_cifar_diluted_robust_images_dog_threshold_512.png\"],\n    },\n  },\n  \"horse_image_16.png\": {\n    match: {\n      easy: [\"match_game_cifar_robust_images_horse_threshold_512.png\"],\n      hard: [\n        \"match_game_cifar_diluted_robust_images_horse_threshold_512-2.png\",\n      ],\n    },\n  },\n  \"boat_image_10.png\": {\n    match: {\n      easy: [\"match_game_cifar_robust_images_boat_threshold_512.png\"],\n      hard: [\"match_game_cifar_diluted_robust_images_boat_threshold_512.png\"],\n    },\n  },\n  \"car_image_1.png\": {\n    match: {\n      easy: [\n        \"match_game_cifar_robust_images_car_threshold_512.png\",\n        \"match_game_cifar_robust_images_car_0.png\",\n        \"match_game_cifar_robust_images_car_1.png\",\n        \"match_game_cifar_robust_images_car_2.png\",\n        \"match_game_cifar_robust_images_car_3.png\",\n      ],\n      hard: [\n        \"match_game_cifar_diluted_robust_images_car_threshold_512.png\",\n        \"match_game_cifar_diluted_robust_images_car_0.png\",\n        \"match_game_cifar_diluted_robust_images_car_1.png\",\n        \"match_game_cifar_diluted_robust_images_car_2.png\",\n        \"match_game_cifar_diluted_robust_images_car_3.png\",\n      ],\n    },\n  },\n  \"plane_image_1.png\": {\n    match: {\n      easy: [\n        \"match_game_cifar_robust_images_plane_0.png\",\n        \"match_game_cifar_robust_images_plane_1.png\",\n        \"match_game_cifar_robust_images_plane_2.png\",\n        \"match_game_cifar_robust_images_plane_3.png\",\n      ],\n      hard: [\n        \"match_game_cifar_diluted_robust_images_plane_0.png\",\n        \"match_game_cifar_diluted_robust_images_plane_1.png\",\n        \"match_game_cifar_diluted_robust_images_plane_2.png\",\n        \"match_game_cifar_diluted_robust_images_plane_3.png\",\n      ],\n    },\n  },\n  \"frog_image_1.png\": {\n    match: {\n      easy: [\n        \"match_game_cifar_robust_images_frog_1.png\",\n        \"match_game_cifar_robust_images_frog_1.png\",\n        \"match_game_cifar_robust_images_frog_2.png\",\n        \"match_game_cifar_robust_images_frog_3.png\",\n      ],\n      hard: [\n        \"match_game_cifar_diluted_robust_images_frog_0.png\",\n        \"match_game_cifar_diluted_robust_images_frog_1.png\",\n        \"match_game_cifar_diluted_robust_images_frog_2.png\",\n        \"match_game_cifar_diluted_robust_images_frog_3.png\",\n      ],\n    },\n  },\n  \"horse_image_1.png\": {\n    match: {\n      learn: [\"horse_image_16.png\", \"horse_image_1.png\"],\n      easy: [\n        \"match_game_cifar_robust_images_horse_threshold_512.png\",\n        \"match_game_cifar_robust_images_horse_0.png\",\n        \"match_game_cifar_robust_images_horse_1.png\",\n        \"match_game_cifar_robust_images_horse_2.png\",\n        \"match_game_cifar_robust_images_horse_3.png\",\n      ],\n      hard: [\n        \"match_game_cifar_diluted_robust_images_horse_threshold_512.png\",\n        \"match_game_cifar_diluted_robust_images_horse_0.png\",\n        \"match_game_cifar_diluted_robust_images_horse_1.png\",\n        \"match_game_cifar_diluted_robust_images_horse_2.png\",\n        \"match_game_cifar_diluted_robust_images_horse_3.png\",\n      ],\n    },\n  },\n  \"truck_image_1.png\": {\n    match: {\n      easy: [\n        \"match_game_cifar_robust_images_truck_0.png\",\n        \"match_game_cifar_robust_images_truck_1.png\",\n        \"match_game_cifar_robust_images_truck_2.png\",\n        \"match_game_cifar_robust_images_truck_3.png\",\n      ],\n      hard: [\n        \"match_game_cifar_diluted_robust_images_truck_0.png\",\n        \"match_game_cifar_diluted_robust_images_truck_1.png\",\n        \"match_game_cifar_diluted_robust_images_truck_2.png\",\n        \"match_game_cifar_diluted_robust_images_truck_3.png\",\n      ],\n    },\n  },\n})\n\nexport const isDefined = (x) => x !== null && x !== undefined\n","export const clean = (obj) =>\n  Object.keys(obj)\n    .filter((k) => obj[k] != null)\n    .reduce((a, k) => ({ ...a, [k]: obj[k] }), {})\n\nexport const styleDiv = (getDiv, style) => {\n  const div = getDiv()\n  Object.keys(style).forEach((k) => (div.style[k] = style[k]))\n}\n\nexport const isDef = (x) => x !== null && x !== undefined\n\n// https://stackoverflow.com/a/56749849/1072068\nexport const shuffle = (arr) =>\n  [...arr].reduceRight(\n    (\n      res,\n      _,\n      __,\n      s // eslint-disable-next-line no-sequences\n    ) => (res.push(s.splice(0 | (Math.random() * s.length), 1)[0]), res),\n    []\n  )\n\nexport const print = console.log.bind(console)\n\nexport const isObject = (x) => typeof x === \"object\" && x !== null\n\nexport const chain = async (fns, duration) => {\n  const delay = (t) =>\n    new Promise((resolve) => {\n      setTimeout(() => {\n        resolve()\n      }, t)\n    })\n\n  for (let x of fns) {\n    x()\n    await delay(duration || 0)\n  }\n}\n\nexport const prettyGoodId = (prefix) =>\n  `${prefix}${Date.now()}${Math.floor(Math.random() * 100)}`\n","import styled from \"styled-components\"\nimport ReactTooltip from \"react-tooltip\"\nimport { prettyGoodId } from \"../../util/misc\"\n\nconst StyledInstructions = styled.div`\n  background-color: antiquewhite;\n  margin: -3px -16px;\n  padding: 5px;\n  border-radius: 2px;\n  text-shadow: none;\n  color: black;\n`\n\nconst Instructions = ({ children }) => (\n  <StyledInstructions>{children}</StyledInstructions>\n)\n\nconst StyledInformationButton = styled.button`\n  display: inline-block;\n  border-radius: 50%;\n  border: 3px solid cornflowerblue;\n  color: cornflowerblue;\n  height: 100%;\n  width: auto;\n  cursor: help;\n  margin: 10px;\n  padding: 0 0.45em;\n  font-size: 0.5em;\n  outline: none;\n`\n\nconst InformationTooltip = ({ children, triggerText = \"i\", triggerStyle }) => {\n  const id = prettyGoodId(\"tooltip\")\n  return (\n    <>\n      <ReactTooltip\n        id={id}\n        getContent={() => <Instructions>{children}</Instructions>}\n        effect=\"solid\"\n        place=\"bottom\"\n      />\n      <StyledInformationButton data-for={id} data-tip style={triggerStyle}>\n        {triggerText}\n      </StyledInformationButton>\n    </>\n  )\n}\n\nexport default InformationTooltip\n","import PropTypes from \"prop-types\"\nimport styled, { keyframes } from \"styled-components\"\nimport \"./Game.css\"\nimport { isDefined } from \"../../util/data\"\nimport { Range } from \"react-range\"\nimport InformationTooltip from \"./InformationTooltip\"\n\nconst CenteredOuter = styled.div`\n  display: flex;\n  justify-content: space-around;\n  flex-direction: column;\n  height: 100%;\n`\nconst CenteredInner = styled.div`\n  display: flex;\n  justify-content: space-around;\n  flex-direction: row;\n  width: 100%;\n`\n\nexport const Centered = ({ children }) => (\n  <CenteredOuter>\n    <CenteredInner>{children}</CenteredInner>\n  </CenteredOuter>\n)\n\nconst ToggleButtonCheckBoxWrapper = styled.div`\n  position: relative;\n  background-color: lightgray;\n  padding: 5px;\n  border-radius: 4px;\n`\n\nconst CheckButton = styled.button`\n  background: ${({ checked, backgroundColor }) =>\n    checked ? backgroundColor : \"gray\"};\n  padding: 5px;\n  color: ${({ checked, color }) => (checked ? color : \"#444\")};\n  outline: none;\n  border: none;\n  border-radius: ${({ left }) => (left ? \"4px 0 0 4px\" : \"0 4px 4px 0\")};\n  transition: text-shadow 0.25s ease;\n  &:hover {\n    cursor: pointer;\n    text-shadow: ${({ checked }) =>\n      checked ? \"1px 1px 1px black;\" : \"1px 1px 1px lightgray;\"};\n  }\n`\n\nexport const ToggleButton = ({\n  trueLabel = \"YES\",\n  falseLabel = \"NO\",\n  trueBgColor,\n  falseBgColor,\n  onToggle,\n  defaultValue,\n}) => {\n  return (\n    <ToggleButtonCheckBoxWrapper>\n      <CheckButton\n        checked={isDefined(defaultValue) && defaultValue}\n        backgroundColor={trueBgColor}\n        onClick={() => onToggle(true)}\n        left={true}\n      >\n        {trueLabel}\n      </CheckButton>\n      <CheckButton\n        checked={isDefined(defaultValue) && !defaultValue}\n        backgroundColor={falseBgColor}\n        onClick={() => onToggle(false)}\n        right={true}\n      >\n        {falseLabel}\n      </CheckButton>\n    </ToggleButtonCheckBoxWrapper>\n  )\n}\n\nToggleButton.propTypes = {\n  onToggle: PropTypes.func.isRequired,\n  trueLabel: PropTypes.oneOfType([PropTypes.string, PropTypes.element]),\n  falseLabel: PropTypes.oneOfType([PropTypes.string, PropTypes.element]),\n}\n\nexport const GameButton = styled.button`\n  border: 1px solid lightgray;\n  text-transform: uppercase;\n  font-family: Futura, sans-serif;\n  font-size: 1.4rem;\n  padding: 5px;\n  border-bottom: 7px solid grey;\n  color: darkslategray;\n  border-radius: 10px 10px 2px 2px;\n  outline: none;\n  cursor: pointer;\n  &:disabled {\n    cursor: default;\n    color: lightgray;\n  }\n  &:hover:enabled {\n    text-shadow: 1px 1px 1px #aaa;\n  }\n`\n\nexport const Emoji = ({ className, style, label, symbol }) => {\n  const symbols = Array.isArray(symbol) ? symbol : [symbol]\n  return (\n    <span className={className} style={style} role=\"img\" aria-label={label}>\n      {symbols.map((x) => String.fromCodePoint(x))}\n    </span>\n  )\n}\n\nexport const Sidecar = styled.div`\n  background-color: white;\n`\n\nconst StyledRangeSlider = styled.div`\n  margin: 10px 10px 0 10px;\n  outline: none;\n`\n\nexport const ControlLabel = styled.div`\n  ${({ position = \"top\" }) =>\n    position === \"top\" ? `margin-bottom: 10px;` : `margin-top: 10px;`}\n  font-size: 0.9rem;\n  text-align: center;\n`\n\nconst RangeTrack = styled.div`\n  height: 6px;\n  width: 100%;\n  background-color: #ccc;\n  border-radius: 3px;\n`\n\nconst RangeHandle = styled.div`\n  height: 18px;\n  width: 18px;\n  color: white;\n  background-color: #999;\n  border: 1px solid #555;\n  font-size: 0.7rem;\n  text-align: center;\n  line-height: 1.7;\n  outline: none;\n  border-radius: 4px;\n`\n\nexport const RangeSlider = ({\n  value,\n  min,\n  max,\n  onChange,\n  style,\n  step = 1,\n  label = null,\n  labelPosition = \"top\",\n  handleStyle,\n}) => {\n  const _label = label ? (\n    <ControlLabel position={labelPosition}>{label}</ControlLabel>\n  ) : null\n  return (\n    <StyledRangeSlider style={style}>\n      {_label && labelPosition === \"top\" ? _label : null}\n      <Range\n        step={step}\n        min={min}\n        max={max}\n        values={[value]}\n        onChange={(values) => {\n          const [_value] = values\n          if (_value !== value) {\n            onChange(_value)\n          }\n        }}\n        renderTrack={({ props, children }) => (\n          <RangeTrack {...props}>{children}</RangeTrack>\n        )}\n        renderThumb={({ props }) => (\n          <RangeHandle {...props} style={handleStyle}>\n            {value}\n          </RangeHandle>\n        )}\n      />\n      {_label && labelPosition === \"bottom\" ? (\n        <div style={{ marginTop: 10 }}>{_label}</div>\n      ) : (\n        <div style={{ height: 7 }}></div>\n      )}\n    </StyledRangeSlider>\n  )\n}\n\nconst StyledGameTitle = styled.div`\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 3rem;\n  text-shadow: 2px 2px 2px slategray;\n  text-align: center;\n`\n\nexport const GameTitle = ({ children, information, style }) => (\n  <StyledGameTitle style={style}>\n    {children}\n    {information ? (\n      <InformationTooltip>{information}</InformationTooltip>\n    ) : null}\n  </StyledGameTitle>\n)\n\nconst fadeIn = keyframes`\n  from { opacity: 0; }\n  to { opacity: 1; }\n`\n\nconst StyledAnswerSvg = styled.div`\n  display: inline-block;\n  animation: ${fadeIn} 0.1s linear;\n`\n\nexport const WrongAnswerX = ({\n  width = 75,\n  height = 100,\n  strokeWidth = 8,\n  color = \"red\",\n}) => {\n  const style = {\n    stroke: color,\n    fill: \"none\",\n    strokeWidth,\n    rx: 1,\n    strokeLinecap: \"round\",\n  }\n  const cornerPadding = strokeWidth * 2.5\n  return (\n    <StyledAnswerSvg style={{ width, height }}>\n      <svg viewBox={`0 0 ${width} ${height}`}>\n        <rect\n          style={style}\n          x={strokeWidth}\n          y={strokeWidth}\n          width={width - strokeWidth * 2}\n          height={height - strokeWidth * 2}\n        />\n        <line\n          x1={cornerPadding}\n          y1={cornerPadding}\n          x2={width - cornerPadding}\n          y2={height - cornerPadding}\n          style={style}\n        />\n        <line\n          x1={width - cornerPadding}\n          y1={cornerPadding}\n          x2={cornerPadding}\n          y2={height - cornerPadding}\n          style={style}\n        />\n      </svg>\n    </StyledAnswerSvg>\n  )\n}\n\nexport const RightAnswerCheck = ({\n  width = 50,\n  height = 50,\n  strokeWidth = 6,\n  color = \"green\",\n}) => {\n  const style = {\n    stroke: color,\n    fill: \"none\",\n    strokeWidth,\n    strokeLinejoin: \"round\",\n  }\n  const checkPoints = [\n    `${width * 0.3},${height * 0.5}`,\n    `${width * 0.45},${height * 0.65}`,\n    `${width * 0.7},${height * 0.32}`,\n  ]\n  return (\n    <StyledAnswerSvg style={{ width, height }}>\n      <svg viewBox={`0 0 ${width} ${height}`}>\n        <circle\n          style={style}\n          cx={width / 2}\n          cy={height / 2}\n          r={width / 2 - 5}\n        />\n        <polyline style={style} points={checkPoints.join(\" \")} />\n      </svg>\n    </StyledAnswerSvg>\n  )\n}\n","import { GameContext } from \"../../context/GameContext\"\nimport { useContext, useEffect, useState } from \"react\"\nimport styled from \"styled-components\"\nimport Gallery from \"react-grid-gallery\"\nimport { scoreDisplays } from \"./Scoreboard\"\nimport {\n  Centered,\n  GameButton,\n  RangeSlider,\n  WrongAnswerX,\n  RightAnswerCheck,\n} from \"./Util\"\nimport {\n  gameData,\n  isDefined,\n  cleanObject,\n  GAME_IMAGE_COUNT,\n} from \"../../util/data\"\nimport { GameTitle } from \"./Util\"\nimport \"./Game.css\"\n\nconst SIZES = {\n  thumbnail: {\n    height: 32,\n    width: 32,\n  },\n  grid: {\n    width: 710,\n  },\n}\n\nconst generateGameData = async (gameMode) => {\n  const gameDataModels = {\n    easy: { path: \"./data/game-data.json\" },\n    hard: { path: \"./data/game-data-20q-hard.json\" },\n  }\n  const gameDataModel = gameDataModels[gameMode || \"easy\"]\n  const _gameData = await gameData(gameDataModel)\n  const images = _gameData.gameOptions.reduce(\n    (all, x, i) => ({ ...all, [i]: x }),\n    {}\n  )\n  return {\n    gameData: _gameData,\n    images,\n    correctAnswers: Object.keys(images)\n      .filter((i) => images[i].correct)\n      .map((i) => parseInt(i)),\n  }\n}\n\nconst labelStyle = {\n  padding: \"5px\",\n  fontSize: \"75%\",\n  color: \"white\",\n  background: \"rgba(0,0,0,0.5)\",\n}\n\nconst toImage = (image, index, tags = () => []) => {\n  const img = {\n    src: `img/${image.path}`,\n    thumbnail: `img/${image.path}`,\n    thumbnailWidth: SIZES.thumbnail.width,\n    thumbnailHeight: SIZES.thumbnail.height,\n    index,\n    correct: image.correct,\n    customOverlay: <AnswersOverlay index={index} />,\n  }\n  img.tags = tags(img) || []\n  return cleanObject(img)\n}\nconst toDeerImage = (img, index) =>\n  toImage(img, index, (_img) => [\n    {\n      value: `${img.label}`,\n      title: `COMPY Says: ${img.label}`,\n    },\n  ])\n\nconst findYouPlayer = (gameSettings) =>\n  gameSettings && gameSettings.players && gameSettings.players.length\n    ? gameSettings.players[0]\n    : null\n\nconst StyledAnswersOverlay = styled.div`\n  color: red;\n  font-weight: bold;\n  text-align: right;\n  position: absolute;\n  top: 0;\n  right: 0;\n  background-color: ${({ correct }) =>\n    correct ? \"rgba(75, 75, 75, 0.8)\" : \"rgba(75, 75, 75, 0.0)\"};\n  width: 100%;\n  height: 100%;\n`\n\nconst AnswerOverlay = styled.div`\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  align-content: center;\n  height: 100%;\n`\n\nconst AnswersOverlay = ({ index }) => {\n  const [gameSettings] = useContext(GameContext)\n  const _you = findYouPlayer(gameSettings)\n  const shouldShowAnswers = isDefined(_you.score)\n  const correct =\n    (_you.selections.includes(index) && gameSettings.images[index].correct) ||\n    (!_you.selections.includes(index) && !gameSettings.images[index].correct)\n  return (\n    <StyledAnswersOverlay\n      correct={isDefined(_you.score) && !gameSettings.images[index].correct}\n    >\n      <AnswerOverlay>\n        {shouldShowAnswers ? (\n          correct ? (\n            <RightAnswerCheck />\n          ) : (\n            <WrongAnswerX />\n          )\n        ) : null}\n      </AnswerOverlay>\n    </StyledAnswersOverlay>\n  )\n}\n\nconst Choices = ({ settings: { noise }, gameMode }) => {\n  const [gameSettings, setGameSettings] = useContext(GameContext)\n\n  useEffect(() => {\n    resetGame(gameMode, gameSettings, setGameSettings) // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [])\n\n  useEffect(() => {\n    if (gameSettings.originalImages) {\n      const noiseKey = `noise${noise}`\n      const hasVariant = (image, variant) =>\n        \"variants\" in image && variant in image.variants\n      setGameSettings({\n        ...gameSettings,\n        images: gameSettings.originalImages\n          .map((image) =>\n            hasVariant(image, noiseKey) ? image.variants[noiseKey] : image\n          )\n          .map((image, i) => ({\n            ...gameSettings.images[i],\n            ...toDeerImage(image, i),\n          })),\n      })\n    } // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [noise])\n\n  const onSelectImage = (index) => {\n    const updated = { ...gameSettings }\n    const you = findYouPlayer(updated)\n    if (you.score) return\n    var img = updated.images[index]\n    if (img.hasOwnProperty(\"isSelected\")) img.isSelected = !img.isSelected\n    else img.isSelected = true\n    you.selections = updated.images\n      .map((x, index) => ({ ...x, index }))\n      .filter((x) => x.isSelected)\n      .map((x) => x.index)\n    setGameSettings(updated)\n  }\n\n  const you = findYouPlayer(gameSettings)\n  return (\n    <div style={{ height: 550 }}>\n      <Gallery\n        images={gameSettings.images}\n        enableImageSelection={!you.score}\n        onSelectImage={onSelectImage}\n        onClickThumbnail={onSelectImage}\n        tagStyle={labelStyle}\n        showLightboxThumbnails={true}\n        enableLightbox={false}\n      />\n    </div>\n  )\n}\n\nconst resetGame = async (mode, original, updateFn) => {\n  const updated = { ...original }\n  const currentGameData = await generateGameData(mode)\n  updated.currentGameData = currentGameData\n  updated.originalImages = Object.keys(currentGameData.images).map(\n    (k) => currentGameData.images[k]\n  )\n  updated.images = updated.originalImages.map(toDeerImage)\n  const _you = findYouPlayer(updated)\n  _you.score = null\n  _you.selections = []\n  updateFn(updated)\n}\n\nconst calculateScore = (gameData, selections) => {\n  const _selections = selections || []\n  const wrongAnswers = _selections.filter(\n    (x) => !gameData.correctAnswers.includes(x)\n  )\n  const omittedAnswers = gameData.correctAnswers.filter(\n    (x) => !_selections.includes(x)\n  )\n\n  return (\n    Object.keys(gameData.images).length -\n    wrongAnswers.length -\n    omittedAnswers.length\n  )\n}\n\nconst StyledControls = styled.div`\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin: 0 2px;\n  padding: 15px;\n  border: 1px solid lightgray;\n  background-color: white;\n  border-bottom-left-radius: 15px;\n  border-bottom-right-radius: 15px;\n`\n\nconst StyledControlEnd = styled.div`\n  width: 150px;\n  margin: 0 15px;\n  min-height: 50px;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  align-content: center;\n`\n\nconst Score = styled.div`\n  color: white;\n  font-weight: bold;\n  background-color: black;\n  border-radius: 3px;\n  font-size: 1.2rem;\n  padding: 10px;\n`\n\nconst Controls = ({ gameMode, onSettingsUpdated = () => null }) => {\n  const [gameSettings, setGameSettings] = useContext(GameContext)\n  const [noiseLevel, setNoiseLevel] = useState(0)\n  const [score, setScore] = useState()\n  const [showRetryButton, setShowRetryButton] = useState(false)\n  const changeNoiseLevel = (level) => {\n    setNoiseLevel(level)\n    onSettingsUpdated({ noise: level })\n  }\n\n  const selectionCount = gameSettings.players[0].selections.length\n  const loadScores = () => {\n    const updated = { ...gameSettings }\n    const _you = findYouPlayer(updated)\n    _you.score = calculateScore(gameSettings.currentGameData, _you.selections)\n    setScore(scoreDisplays(_you, GAME_IMAGE_COUNT))\n    setGameSettings(updated)\n    setShowRetryButton(true)\n  }\n  const playAgain = () => {\n    resetGame(gameMode, gameSettings, setGameSettings)\n    setScore(null)\n    setShowRetryButton(false)\n  }\n\n  return (\n    <StyledControls>\n      <StyledControlEnd>\n        {gameMode === \"hard\" ? (\n          <RangeSlider\n            label=\"Add Noise\"\n            labelPosition=\"bottom\"\n            min={0}\n            max={6}\n            step={1}\n            value={noiseLevel}\n            onChange={changeNoiseLevel}\n            style={{ width: \"100%\" }}\n          />\n        ) : null}\n      </StyledControlEnd>\n      {showRetryButton ? (\n        <GameButton onClick={playAgain}>Play Again!</GameButton>\n      ) : (\n        <GameButton onClick={loadScores} disabled={selectionCount === 0}>\n          Submit Answers\n        </GameButton>\n      )}\n      <StyledControlEnd>\n        {score ? (\n          <Score>\n            {score.score} ({score.percentage}%)\n          </Score>\n        ) : null}\n      </StyledControlEnd>\n    </StyledControls>\n  )\n}\n\nconst StyledGame = styled.div`\n  display: flex;\n  flex-direction: row;\n`\n\nconst Game = styled.div`\n  min-width: ${SIZES.grid.width}px;\n  max-width: ${SIZES.grid.width}px;\n`\n\nconst GameInformation = () => (\n  <>\n    <p>\n      COMPY has seen a lot of deer images before, and he is really good at\n      identifying a deer when he sees one.\n    </p>\n    <p>\n      Can you tell which of the following deer images COMPY may have seen? There\n      is at least one.\n    </p>\n    <p>Select them and then hit the \"Submit Answers\" button (below).</p>\n    <p>If you were to guess randomly, you would expect to get half correct.</p>\n  </>\n)\n\nconst TwentyQuestions = ({ gameMode }) => {\n  const [settings, setSettings] = useState(0)\n  const settingsUpdated = (_settings) => setSettings(_settings)\n\n  return (\n    <Centered>\n      <StyledGame>\n        <Game>\n          <GameTitle\n            information={<GameInformation />}\n            style={{ marginBottom: 10 }}\n          >\n            20 Questions\n          </GameTitle>\n          <Choices settings={settings} gameMode={gameMode} />\n          <Controls gameMode={gameMode} onSettingsUpdated={settingsUpdated} />\n        </Game>\n      </StyledGame>\n    </Centered>\n  )\n}\n\nexport default TwentyQuestions\n","import { useState, useEffect } from \"react\"\n\n// https://usehooks.com/useWindowSize/\nconst useWindowSize = () => {\n  // Initialize state with undefined width/height so server and client renders match\n  // Learn more here: https://joshwcomeau.com/react/the-perils-of-rehydration/\n  const [windowSize, setWindowSize] = useState({\n    width: undefined,\n    height: undefined,\n  })\n\n  useEffect(() => {\n    // Handler to call on window resize\n    function handleResize() {\n      // Set window width/height to state\n      setWindowSize({\n        width: window.innerWidth,\n        height: window.innerHeight,\n      })\n    }\n\n    // Add event listener\n    window.addEventListener(\"resize\", handleResize)\n\n    // Call handler right away so state gets updated with initial window size\n    handleResize()\n\n    // Remove event listener on cleanup\n    return () => window.removeEventListener(\"resize\", handleResize)\n  }, []) // Empty array ensures that effect is only run on mount\n\n  return windowSize\n}\n\nexport default useWindowSize\n","import { useEffect, useCallback, useMemo, useState } from \"react\"\nimport styled from \"styled-components\"\nimport { shuffle } from \"../../util/misc\"\nimport useWindowSize from \"../../hooks/useWindowSize\"\nimport { DndProvider, useDrag, useDrop } from \"react-dnd\"\nimport { HTML5Backend } from \"react-dnd-html5-backend\"\nimport Xarrow from \"react-xarrows\"\nimport { matchData } from \"../../util/data\"\nimport { GameTitle, WrongAnswerX } from \"./Util\"\n\nconst SIZES = {\n  tile: {\n    height: 100,\n    width: 100,\n  },\n}\n\nconst DraggableImageBase = styled.div`\n  height: ${SIZES.tile.height}px;\n  width: ${SIZES.tile.width}px;\n  border: 1px solid slategray;\n  border-radius: 5px;\n  background-image: ${({ src }) => `url(${src})`};\n  background-size: cover;\n`\n\nconst StyledDraggableImage = styled(DraggableImageBase)`\n  border-color: black;\n`\n\nconst DraggableImage = ({\n  index,\n  image,\n  attempt,\n  correctTarget,\n  disabled,\n  onGuess = () => null,\n}) => {\n  const draggableId = `draggable${index}`\n  const [{ isDragging }, drag] = useDrag(() => ({\n    type: \"draggable\",\n    item: { name: image },\n    end: (item, monitor) => {\n      const dropResult = monitor.getDropResult()\n      if (item && dropResult) {\n        onGuess(draggableId, {\n          guess: correctTarget === dropResult.name,\n          source: { id: draggableId, img: item.name },\n          target: { id: dropResult.name, img: dropResult.name },\n        })\n      }\n    },\n    collect: (monitor) => ({\n      isDragging: monitor.isDragging(),\n    }),\n  }))\n  const opacity = isDragging ? 0.4 : 1\n  return (\n    <StyledDraggableImage\n      id={draggableId}\n      role=\"draggable\"\n      src={`match-img/${image}`}\n      alt={image}\n      ref={disabled ? null : drag}\n      style={{ opacity }}\n    />\n  )\n}\n\nconst DraggableContainer = styled.div`\n  height: 100%;\n  width: 100%;\n  display: flex;\n  flex-direction: row;\n  justify-content: space-around;\n`\n\nconst DraggableTargetDrop = styled(DraggableImageBase)`\n  background-color: #ddd;\n  border: 1px dashed black;\n`\n\nconst DraggableTarget = ({ id, image, matches }) => {\n  const [{ canDrop, isOver }, drop] = useDrop(() => {\n    return {\n      accept: \"draggable\",\n      drop: () => ({ name: id }),\n      collect: (monitor) => ({\n        isOver: monitor.isOver(),\n        canDrop: monitor.canDrop(),\n      }),\n    }\n  })\n  const isActive = canDrop && isOver\n  const from = (\n    Object.values(matches).find((x) => x.to.id === id) || {\n      from: null,\n    }\n  ).from\n\n  const backgroundColor = from\n    ? null\n    : isActive\n    ? \"#aaa\"\n    : canDrop\n    ? \"#ddd\"\n    : \"white\"\n\n  return (\n    <div style={{ display: \"flex\", flexDirection: \"row\" }}>\n      <DraggableTargetDrop\n        id={id}\n        ref={drop}\n        style={{\n          backgroundColor,\n          backgroundImage: from ? `url(match-img/${from.img})` : null,\n        }}\n      />\n      <DraggableImageBase\n        src={`match-img/${image}`}\n        alt={image}\n        style={{\n          marginLeft: 10,\n        }}\n      />\n    </div>\n  )\n}\n\nconst SideContainer = styled.div`\n  display: flex;\n  flex-direction: column;\n  justify-content: space-evenly;\n  background-color: steelblue;\n  padding: 25px;\n  border-radius: 10px;\n  border: 1px solid gray;\n  margin: 20px 0;\n`\n\nconst toKey = (x, index) => `${x}_${index}`\n\nconst MiddleSection = styled.div`\n  width: 500px;\n`\n\nconst GameInformation = () => (\n  <>\n    <p>On the left are image represenations for class labels of a data set</p>\n    <p>used to train a machine learning model.</p>\n    <p>\n      Drag each class prototype image on the left to their match on the right.\n    </p>\n    <p>\n      <b> You have three strikes before you are out! </b>\n    </p>\n    <p></p>\n  </>\n)\n\nconst GameInfo = {\n  learn: { title: \"Learn to Match\", matchCount: 3 },\n  easy: { title: \"Easy Match Game\", matchCount: 5 },\n  hard: { title: \"Hard Match Game\", matchCount: 3, targetCount: 6 },\n}\n\nconst Centered = styled.div`\n  margin-top: 10px;\n  text-align: center;\n`\n\nconst ScoreBoard = ({ guesses }) => (\n  <>\n    <div style={{ textAlign: \"center\", height: 100, marginTop: 5 }}>\n      {new Array(guesses.incorrect).fill().map((_, i) => (\n        <WrongAnswerX key={`incorrect-x-${i}`} />\n      ))}\n    </div>\n  </>\n)\n\nconst RetryButton = styled.button`\n  height: 50px;\n  border: 3px solid #111;\n  border-radius: 25px;\n  font-size: 1.5rem;\n  padding: 0 20px;\n  font-family: Futura;\n  background-color: ${({ won }) => (won ? \"green\" : \"slategray\")};\n  color: white;\n  cursor: pointer;\n  outline: none;\n  position: relative;\n  z-index: 9999;\n`\n\nconst Options = ({ guesses, onGameOver, onRetry }) => {\n  const [won, setWon] = useState(false)\n  const [buttonText, setButtonText] = useState(null)\n  useEffect(() => {\n    const winner = () =>\n      guesses.total > 0 &&\n      Object.keys(guesses.correct).filter((x) => guesses.correct[x]).length ===\n        guesses.total\n    const loser = () => guesses.incorrect >= guesses.maxStrikes\n    const won = winner()\n    setWon(won)\n    const text = loser() ? \"Try again?\" : won ? \"You won! Play again?\" : null\n    setButtonText(text)\n    if (text) onGameOver()\n  }, [guesses, onGameOver])\n  return buttonText ? (\n    <Centered>\n      <RetryButton onClick={onRetry} won={won}>\n        {buttonText}\n      </RetryButton>\n    </Centered>\n  ) : null\n}\n\nconst MatchLayout = ({ model, gameMode, onRetry, maxStrikes = 3 }) => {\n  useWindowSize() // Re-render the arrows\n  const [disabled, setDisabled] = useState(false)\n  const findTargetId = (image) =>\n    Object.keys(model.images).find((key) => model.images[key] === image)\n\n  const onGameOver = () => setDisabled((_) => true)\n  const _onRetry = () => {\n    setGuesses(resetGuesses())\n    setMatches({})\n    onRetry()\n  }\n\n  const images = useMemo(() => (model || {}).images || {}, [model])\n  const sources = useMemo(() => Object.values(images).filter((x) => x), [\n    images,\n  ])\n  const targetIds = useMemo(() => shuffle(Object.keys(images)), [images])\n  const [matches, setMatches] = useState({})\n\n  const resetGuesses = useCallback(\n    () => ({\n      maxStrikes,\n      total: sources.length,\n      correct: {},\n      incorrect: 0,\n    }),\n    [sources, maxStrikes]\n  )\n\n  useEffect(() => {\n    setDisabled(false)\n    setGuesses(resetGuesses())\n  }, [model, resetGuesses])\n\n  const [guesses, setGuesses] = useState(resetGuesses())\n  const onGuess = (sourceId, { guess, source, target }) => {\n    setMatches((prev) => ({\n      ...prev,\n      [sourceId]: {\n        from: source,\n        to: target,\n        color: guess ? \"green\" : \"red\",\n      },\n    }))\n    setGuesses((prev) => ({\n      ...prev,\n      correct:\n        guess === true\n          ? { ...prev.correct, [sourceId]: guess }\n          : guess === null\n          ? { ...prev.correct, [sourceId]: false }\n          : prev.correct,\n      incorrect:\n        guess === false\n          ? Math.min(prev.incorrect + 1, prev.total)\n          : prev.incorrect,\n    }))\n  }\n\n  return (\n    <DraggableContainer>\n      <SideContainer>\n        {sources.map((x, i) => (\n          <DraggableImage\n            key={toKey(x, i)}\n            index={i}\n            image={x}\n            attempt={model.attempt}\n            disabled={disabled}\n            targetIds={targetIds}\n            correctTarget={findTargetId(x)}\n            onGuess={onGuess}\n          />\n        ))}\n      </SideContainer>\n      <MiddleSection>\n        <ScoreBoard guesses={guesses} />\n        <GameTitle information={<GameInformation />}>\n          {GameInfo[gameMode].title || \"Match Game\"}\n        </GameTitle>\n        <Options guesses={guesses} onRetry={_onRetry} onGameOver={onGameOver} />\n      </MiddleSection>\n      <SideContainer key={new Date().getTime()}>\n        {targetIds.map((x, i) => (\n          <DraggableTarget\n            key={toKey(x, i)}\n            id={x}\n            image={x}\n            matches={matches}\n          />\n        ))}\n      </SideContainer>\n      {Object.values(matches).map((x) => (\n        <Xarrow\n          key={`line-${x.from.id}-${x.to.id}`}\n          start={`${x.from.id}`}\n          end={`${x.to.id}`}\n          color={x.color}\n          path=\"straight\"\n          animateDrawing=\"200ms\"\n        />\n      ))}\n    </DraggableContainer>\n  )\n}\n\nconst Match = ({\n  gameMode = \"easy\",\n  matchCount = GameInfo[gameMode].matchCount,\n  targetCount = GameInfo[gameMode].targetCount || GameInfo[gameMode].matchCount,\n}) => {\n  const [retries, setRetries] = useState(0)\n  const [model, setModel] = useState({})\n  const [allImages, setAllImages] = useState({})\n  const resetModel = useCallback(() => {\n    const targets = shuffle(Object.keys(allImages)).slice(0, targetCount)\n    const matchImage = (key) => {\n      return allImages[key].match[gameMode]\n        ? allImages[key].match[gameMode].length\n          ? shuffle(allImages[key].match[gameMode]).slice(0, 1)[0]\n          : null\n        : key\n    }\n    return targets.reduce(\n      (all, x, i) => {\n        return {\n          ...all,\n          images: {\n            ...all.images,\n            [x]: i < matchCount ? matchImage(x) : null,\n          },\n        }\n      },\n      { attempt: retries }\n    )\n  }, [allImages, matchCount, retries, gameMode, targetCount])\n\n  useEffect(() => {\n    const getMatchData = async () => {\n      const _matchData = await matchData()\n      setAllImages(_matchData)\n    }\n\n    getMatchData() // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [])\n\n  useEffect(() => {\n    setModel(resetModel())\n  }, [retries, resetModel])\n\n  if (matchCount > targetCount) {\n    return <div>targetCount must be more than matchCount</div>\n  }\n\n  const retryGame = () => setRetries((prev) => prev + 1)\n  return (\n    <DndProvider backend={HTML5Backend}>\n      <MatchLayout\n        model={model}\n        gameMode={gameMode}\n        onRetry={retryGame}\n        sourceCount={matchCount}\n        targetCount={matchCount}\n      />\n    </DndProvider>\n  )\n}\n\nexport default Match\n","import { GameContext } from \"../../context/GameContext\"\nimport { useContext, useState, useEffect, useRef, useMemo } from \"react\"\nimport { Link } from \"react-router-dom\"\nimport styled from \"styled-components\"\nimport { gameData, isDefined } from \"../../util/data\"\nimport { clean, styleDiv, isDef } from \"../../util/misc\"\nimport {\n  Centered,\n  ToggleButton,\n  GameButton,\n  Sidecar,\n  RangeSlider,\n  ControlLabel,\n} from \"./Util\"\nimport { PieChart } from \"react-minimal-pie-chart\"\nimport SimpleImageSlider from \"react-simple-image-slider\"\nimport Select from \"react-select\"\nimport \"./Game.css\"\n\nconst PRACTICE_IMAGE_SIZE = {\n  container: {\n    width: 661,\n    height: 600,\n  },\n  image: {\n    width: 300,\n    height: 300,\n  },\n}\n\nconst AI_NAME = \"COMPY\"\nconst COLORS = {\n  yes: \"#4caf50\",\n  no: \"#dc004d\",\n  neutral: \"antiquewhite\",\n}\n\nconst resetGame = async (original, updateFn, setCurrentIndex, demo) => {\n  const updated = { ...original }\n  updated.version = isDefined(updated.version) ? updated.version + 1 : 1\n  updated.practiceRoundNumber = demo\n    ? 3\n    : updated.practiceRoundNumber === 1\n    ? 2\n    : 1\n  console.log(`Practice reset to Round ${updated.practiceRoundNumber}`)\n  const currentGameData = await generateGameData(updated.practiceRoundNumber)\n  if (updated.practiceRound && Object.keys(updated.practiceRound).length) {\n    updated.previousPracticeRounds.push({ ...updated.practiceRound })\n  }\n  updated.currentGameData = currentGameData\n  setCurrentIndex(0)\n  updated.practiceRound = currentGameData.scrollingImages.reduce(\n    (all, x, i) => ({\n      ...all,\n      [x.path]: { ...x },\n    }),\n    {}\n  )\n  updateFn(updated)\n}\n\nconst generateGameData = async (practiceRoundNumber) => {\n  const _gameData = await gameData()\n  const images = _gameData.practiceOptions[practiceRoundNumber].reduce(\n    (all, x, i) => ({ ...all, [i]: x }),\n    {}\n  )\n  const scrollingImages = Object.keys(images).map((i) => ({\n    ...images[i],\n    url: `img/${images[i].path}`,\n  }))\n  return {\n    gameData: _gameData,\n    images,\n    scrollingImages,\n    correctAnswers: Object.keys(images)\n      .filter((i) => images[i].correct)\n      .map((i) => parseInt(i)),\n  }\n}\n\nconst answer = (property, gameSettings, img) =>\n  !(img in gameSettings.practiceRound)\n    ? null\n    : gameSettings.practiceRound[img][property]\n\nconst allQuestionsAnswered = (gameSettings) =>\n  Object.keys(gameSettings.practiceRound).reduce(\n    (all, x) => all && isDefined(gameSettings.practiceRound[x].seenbefore),\n    true\n  )\n\nconst StyledPracticeResult = styled.div`\n  display: flex;\n  flex-direction: column;\n  padding: 10px 0 10px 10px;\n  border-top: 1px solid lightgray;\n  background-color: ${(props) => (props.current ? \"lightgray\" : \"none\")};\n  transition: background-color 1s ease;\n`\n\nconst PracticeResultTitle = styled.b`\n  color: ${(props) => props.color};\n  &:before {\n    content: \"${(props) => (props.current ? \"> \" : \"\")}\";\n  }\n`\n\nconst PracticeResult = ({\n  question: { path, correct, agree, seenbefore },\n  questionNumber,\n  isCurrentImage,\n}) => {\n  const answer = !isDefined(seenbefore)\n    ? \"waiting\"\n    : (seenbefore && correct) || (!seenbefore && !correct)\n    ? \"correct\"\n    : \"incorrect\"\n  const displaySettings = {\n    waiting: {\n      text: \"Waiting on your guess...\",\n    },\n    correct: {\n      text: `You know ${AI_NAME} pretty well!`,\n      color: COLORS.yes,\n    },\n    incorrect: {\n      text: `Sorry, you don't know ${AI_NAME} very well.`,\n      color: COLORS.no,\n    },\n  }\n  const display = displaySettings[answer]\n  return (\n    <StyledPracticeResult current={isCurrentImage}>\n      <PracticeResultTitle\n        color={display.color}\n        current={isCurrentImage}\n        title={path}\n      >\n        Image {questionNumber}\n      </PracticeResultTitle>\n      <div>{display.text}</div>\n    </StyledPracticeResult>\n  )\n}\n\nconst StyledEndButtons = styled.div`\n  display: flex;\n  flex-direction: column;\n  button {\n    margin-top: 5px;\n  }\n`\nconst EndButtons = ({ resetGame }) => {\n  const [gameSettings, setGameSettings] = useContext(GameContext)\n  const playGame = () => {\n    const updated = { ...gameSettings }\n    updated.previousPracticeRounds.push({ ...updated.practiceRound })\n    updated.practiceRound = {}\n    setGameSettings(updated)\n  }\n  return (\n    <StyledEndButtons>\n      <GameButton onClick={resetGame}>More Practice</GameButton>\n      <Link to=\"/20q/easy\">\n        <GameButton onClick={playGame}>Play Game!</GameButton>\n      </Link>\n    </StyledEndButtons>\n  )\n}\n\nconst StylePracticeResults = styled(Sidecar)`\n  border-top: 1px solid slategray;\n  border-bottom: 1px solid slategray;\n  border-right: 1px solid slategray;\n  border-top-right-radius: 15px;\n  padding: 10px;\n  border-bottom-right-radius: 15px;\n  min-width: 350px;\n  max-width: 350px;\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n`\n\nconst PracticeResultsTitle = styled.div`\n  border-bottom: 2px solid darkgray;\n  font-size: 1.9rem;\n  font-weight: 500;\n  text-align: center;\n  padding-bottom: 12px;\n  margin: 10px 0;\n  text-shadow: 2px 2px 2px slategray;\n`\n\nconst PracticeResultsSubtitle = styled.h4`\n  margin: 10px;\n`\n\nconst PracticeResults = ({ resetGame, currentImageIndex, demo }) => {\n  const [gameSettings] = useContext(GameContext)\n  return (\n    <StylePracticeResults>\n      <div>\n        <PracticeResultsTitle>\n          Practice Round {!demo ? gameSettings.practiceRoundNumber : null}\n        </PracticeResultsTitle>\n        <PracticeResultsSubtitle>\n          Make a selection for each image:\n        </PracticeResultsSubtitle>\n        {Object.keys(gameSettings.practiceRound).map((x, i) => (\n          <PracticeResult\n            key={i}\n            questionNumber={i + 1}\n            isCurrentImage={i === currentImageIndex}\n            question={gameSettings.practiceRound[x]}\n          />\n        ))}\n      </div>\n      <div>\n        {!demo && allQuestionsAnswered(gameSettings) ? (\n          <EndButtons resetGame={resetGame} />\n        ) : null}\n      </div>\n    </StylePracticeResults>\n  )\n}\n\nconst ImageSliderOverrideStyles = ({ images, currentIndex }) => {\n  const [gameSettings] = useContext(GameContext)\n  const Selectors = {\n    bullet: (index) =>\n      `#practice-container button[data-id*=\"bullet\"]:nth-child(${index + 1})`,\n    image: () =>\n      '#practice-container div[style*=\"background-size: cover\"][style*=\"background-image:\"][style*=\".png\"]',\n  }\n\n  const _bulletStyle = (index, colors) => {\n    const border =\n      currentIndex === index ? \"; border: 2px solid blue !important;\" : \"\"\n    return `${Selectors.bullet(index)} { background-color: ${\n      colors[0]\n    } !important; ${border} }\n        `\n  }\n  const bulletStyles = () =>\n    images.map((_, i) => {\n      const seenbefore = answer(\"seenbefore\", gameSettings, images[i].path)\n      const toColor = (x) => (x == null ? \"white\" : x ? COLORS.yes : COLORS.no)\n      return _bulletStyle(i, [toColor(seenbefore)])\n    })\n\n  const imageSize = {\n    width:\n      PRACTICE_IMAGE_SIZE.image.width / PRACTICE_IMAGE_SIZE.container.width,\n    height:\n      PRACTICE_IMAGE_SIZE.image.height / PRACTICE_IMAGE_SIZE.container.height,\n  }\n  const imagePercent = {\n    width: parseInt(imageSize.width * 100),\n    height: parseInt(imageSize.height * 100),\n  }\n  const paddingLeft =\n    (PRACTICE_IMAGE_SIZE.container.width - PRACTICE_IMAGE_SIZE.image.width) / 2\n  const paddingTop =\n    (PRACTICE_IMAGE_SIZE.container.height - PRACTICE_IMAGE_SIZE.image.height) /\n    2\n\n  const imageStyles = () => [\n    `${Selectors.image()} {left: ${paddingLeft}px !important; top: ${paddingTop}px !important; width: ${\n      imagePercent.width\n    }% !important; height: ${\n      imagePercent.height\n    }% !important; border-radius: 5px; box-shadow: 0 0 5px #000000;}`,\n  ]\n  return (\n    <style\n      dangerouslySetInnerHTML={{\n        __html: [...bulletStyles(), ...imageStyles()].join(\"\\n\"),\n      }}\n    />\n  )\n}\n\nconst StyledQuestionWithButtons = styled.div`\n  display: flex;\n  flex-direction: column;\n  background-color: slategray;\n  color: white;\n  padding: 10px;\n  border-radius: 10px;\n  height: 60px;\n  margin-bottom: 45px;\n  pointer-events: all;\n  &:first-child {\n    margin-left: 15px;\n  }\n  &:last-child {\n    margin-right: 15px;\n  }\n`\nconst StyledQuestionWithButtonsButton = styled.div`\n  padding-top: 5px;\n  padding-bottom: 0;\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n`\nconst QuestionText = styled.div`\n  font-size: 0.9rem;\n`\nconst QuestionWithButtons = ({ question, onAnswer, defaultValue }) => (\n  <StyledQuestionWithButtons>\n    <QuestionText>{question}</QuestionText>\n    <StyledQuestionWithButtonsButton>\n      <ToggleButton\n        defaultValue={defaultValue}\n        onToggle={onAnswer}\n        trueBgColor=\"white\"\n        falseBgColor=\"white\"\n        trueLabel=\"YES\"\n        falseLabel=\"NO\"\n      />\n    </StyledQuestionWithButtonsButton>\n  </StyledQuestionWithButtons>\n)\n\nconst StyledTuningSideTile = styled.div`\n  position: absolute;\n  z-index: 2;\n  top: 130px;\n  width: 180px;\n  height: 295px;\n`\n\nconst TuningSideTile = styled.div`\n  display: flex;\n  flex-direction: column;\n  background-color: slategray;\n  padding: 10px;\n  color: white;\n  border-radius: 15px;\n  width: 75%;\n  text-align: center;\n`\n\nconst StyledProbability = styled(StyledTuningSideTile)`\n  right: 0px;\n`\n\nconst Probability = ({ previousLabel, label, value }) => {\n  const percent = (value * 100).toFixed(1)\n  return (\n    <StyledProbability>\n      <Centered>\n        <TuningSideTile>\n          <div>\n            {AI_NAME} says <br />\n            <PictureLabel\n              changed={isDef(previousLabel) && label !== previousLabel}\n            >\n              {label}\n            </PictureLabel>{\" \"}\n            with a confidence of\n          </div>\n          <div style={{ margin: \"0 30px 0 30px\" }}>\n            <PieChart\n              animate\n              reveal={100}\n              data={[\n                { value: percent, color: \"#ccc\" },\n                { value: 100 - percent, color: \"#777\", hideLabel: true },\n              ]}\n              totalValue={100}\n              lineWidth={30}\n              label={({ dataEntry }) =>\n                dataEntry.hideLabel ? null : `${dataEntry.value}%`\n              }\n              labelStyle={{\n                fontSize: \"1.1rem\",\n                fill: \"white\",\n              }}\n              labelPosition={0}\n            />\n          </div>\n        </TuningSideTile>\n      </Centered>\n    </StyledProbability>\n  )\n}\n\nconst StyledTuningsOuter = styled(StyledTuningSideTile)`\n  left: 0px;\n`\n\nconst StyledTuningSelect = styled.div`\n  display: flex;\n  flex-direction: row;\n  align-items: stretch;\n`\n\nconst TuningSelect = (props) => {\n  const selectStyles = {\n    container: (provided) => ({ ...provided, width: \"100%\" }),\n    indicatorSeparator: (provided) => ({ ...provided, display: \"none\" }),\n    option: (provided, { data }) => ({\n      ...provided,\n      textAlign: \"left\",\n      whiteSpace: \"nowrap\",\n      color: \"black\",\n      fontSize: \"0.9rem\",\n      \":before\": {\n        content: `${data.icon ? `'${data.icon}'` : \"''\"}`,\n        width: \"15px\",\n        padding: \"0 5px 0 0 !important\",\n        display: \"inline-block\",\n        textAlign: \"center\",\n      },\n    }),\n    menu: (provided) => ({\n      ...provided,\n      width: \"fit-content\",\n    }),\n    singleValue: (provided) => ({\n      ...provided,\n      fontSize: \"0.8rem\",\n    }),\n  }\n\n  return <Select styles={selectStyles} isSearchable={false} {...props} />\n}\n\nconst Tunings = ({ image, getImageDiv, onLoadImageVariant }) => {\n  const defaultStyle = {\n    noise: 0,\n  }\n  const [styles, setStyles] = useState(defaultStyle)\n  const [selectedVariant, setSelectedVariant] = useState(null)\n  const changeImage = (key) =>\n    styleDiv(getImageDiv, {\n      transition: \"none\",\n      \"background-image\":\n        !styles[key] && key in image.variants && \"path\" in image.variants[key]\n          ? `url(\"img/${image.variants[key].path}\")`\n          : `url(\"img/${image.path}\")`,\n    })\n\n  const variantLabel = (key) => {\n    return (image.variants[key] || image).label\n  }\n  const resetImage = () => {\n    console.log(\"Resetting image....\")\n    changeImage(\"unknown\")\n    onLoadImageVariant({})\n    setStyles({ ...defaultStyle })\n  }\n\n  const updateImage = (key, additionalStyles = {}) => {\n    const toggle = !styles[key]\n    changeImage(key)\n    onLoadImageVariant(\n      clean({\n        probability: toggle\n          ? key in image.variants\n            ? image.variants[key].probability\n            : null\n          : null,\n        label: variantLabel(key),\n      })\n    )\n    setStyles({ ...defaultStyle, [key]: toggle, ...additionalStyles })\n  }\n  const addNoise = (noiseLevel) =>\n    updateImage(`noise${noiseLevel}`, { noise: noiseLevel })\n\n  const augmentVariants = Object.keys(image.variants || {}).filter(\n    (x) => !x.startsWith(\"noise\")\n  )\n  const optionDecorations = {\n    hflip: {\n      label: () => \"Horizontal Flip\",\n      icon: () => \"\\\\21C4\",\n    },\n    vflip: {\n      label: () => \"Vertical Flip\",\n      icon: () => \"\\\\21C5\",\n    },\n    \"rot*\": {\n      label: (x) => `${x.replace(\"rot\", \"Rotate \")}°`,\n      icon: () => \"\\\\21BB\",\n    },\n  }\n\n  const noop = () => undefined\n  const decorate = (object, property, decoration, key) =>\n    (object[property] = (decoration[property] || noop)(key))\n\n  const decorateOption = (key) => {\n    const defaults = {\n      value: key,\n      label: key,\n      fn: updateImage.bind(null, key),\n    }\n    let decoration = undefined\n    if (key in optionDecorations) {\n      decoration = optionDecorations[key]\n    } else {\n      const decorationKey = Object.keys(optionDecorations)\n        .filter((x) => x.includes(\"*\"))\n        .find((x) => key.startsWith(x.replace(\"*\", \"\")))\n      if (decorationKey) {\n        decoration = optionDecorations[decorationKey]\n      }\n    }\n\n    if (decoration) {\n      decorate(defaults, \"label\", decoration, key)\n      decorate(defaults, \"icon\", decoration, key)\n    }\n\n    return defaults\n  }\n\n  const options = [\n    {\n      value: \"normal\",\n      label: \"Normal\",\n      fn: resetImage,\n    },\n    ...augmentVariants.map(decorateOption),\n  ]\n\n  const noiseLevelVariants = Object.keys(image.variants || {})\n    .filter((x) => x.startsWith(\"noise\"))\n    .map((x) => parseInt(x.replace(\"noise\", \"\")))\n  const noiseLevels = [0, ...noiseLevelVariants]\n\n  return (\n    <StyledTuningsOuter>\n      <Centered>\n        <TuningSideTile>\n          <ControlLabel>Apply Filter:</ControlLabel>\n          <StyledTuningSelect>\n            <TuningSelect\n              options={options}\n              value={selectedVariant || options[0]}\n              onChange={(x) => {\n                setSelectedVariant(x)\n                x.fn()\n              }}\n            />\n          </StyledTuningSelect>\n          <RangeSlider\n            label=\"Add Noise:\"\n            step={1}\n            min={0}\n            max={Math.max(...noiseLevels)}\n            value={styles.noise}\n            onChange={(level) => {\n              setSelectedVariant(null)\n              addNoise(level)\n            }}\n          />\n        </TuningSideTile>\n      </Centered>\n    </StyledTuningsOuter>\n  )\n}\n\nconst Caption = styled.div`\n  position: absolute;\n  z-index: 5;\n  background-color: slategray;\n  color: white;\n  padding: 8px;\n  height: 35px;\n  border-bottom-right-radius: 8px;\n  border-top-left-radius: 15px;\n  font-size: 1.4rem;\n  display: flex;\n  flex-direction: column;\n  justify-content: space-around;\n`\n\nconst StyledSwitchMode = styled.div`\n  position: absolute;\n  right: 0;\n  z-index: 5;\n  background-color: slategray;\n  color: white;\n  padding: 8px;\n  border-bottom-left-radius: 8px;\n  font-size: 1.2rem;\n  height: 35px;\n  display: flex;\n  flex-direction: column;\n  justify-content: space-around;\n`\n\nconst SwitchModeButton = styled.button`\n  border: 0;\n  outline: none;\n  background: none;\n  font-size: 1.2rem;\n  color: ${({ selected }) => (selected ? \"black\" : \"white\")};\n  flex: 1;\n  font-family: Futura;\n  transition: text-shadow 0.25s ease;\n  &:hover {\n    cursor: pointer;\n    text-shadow: 1px 1px 1px black;\n  }\n`\n\nconst SwitchMode = ({ mode, onSwitchMode }) => {\n  const labels = {\n    trick: \"Back to Game\",\n  }\n  // const label = mode in labels ? labels[mode] : `Trick ${AI_NAME}?`\n  const label = mode in labels ? labels[mode] : `Learn More`\n  const toModes = {\n    trick: null,\n  }\n  const toMode = mode in toModes ? toModes[mode] : \"trick\"\n  return (\n    <StyledSwitchMode>\n      <SwitchModeButton onClick={() => onSwitchMode(toMode)}>\n        {label}\n      </SwitchModeButton>\n    </StyledSwitchMode>\n  )\n}\n\nconst StyledPracticeVoteButtons = styled.div`\n  display: flex;\n  flex-direction: row;\n  justify-content: space-around;\n  position: absolute;\n  pointer-events: none;\n  width: 100%;\n  bottom: 0px;\n  z-index: 1;\n`\n\nconst PictureLabel = styled.div`\n  border-radius: 5px;\n  display: inline-block;\n  padding-left: 4px;\n  padding-right: 4px;\n  color: ${(props) => (props.changed ? \"white\" : \"#333\")};\n  background-color: ${(props) => (props.changed ? \"#dc004d\" : \"white\")};\n  border: 1px solid lightgray;\n  border-color: ${(props) => (props.changed ? \"antiquewhite\" : \"lightgray\")};\n  transition: background-color 1s ease;\n  font-style: italic;\n`\n\nconst ImageControls = ({ getImageDiv, images, index, onChange }) => {\n  const [gameSettings, setGameSettings] = useContext(GameContext)\n  const fallbackProbability = 0.5\n  const [displayMode, setDisplayMode] = useState(null)\n  const [loadedImage, setLoadedImage] = useState({})\n  const image = images[index]\n  const defaultLoadedImageState = useMemo(\n    () =>\n      image\n        ? {\n            probability: image.probability || fallbackProbability,\n            label: image.label,\n          }\n        : { probability: fallbackProbability, label: \"unknown\" },\n    [image]\n  )\n  useEffect(() => {\n    setLoadedImage(defaultLoadedImageState)\n  }, [index, defaultLoadedImageState])\n\n  if (!images) return null\n\n  const resetImage = () => {\n    styleDiv(getImageDiv, {\n      \"background-image\": `url(\"img/${image.path}\")`,\n    })\n    setLoadedImage(defaultLoadedImageState)\n  }\n  const onClickUpdateProperty = (property, guessed) => {\n    const updated = { ...gameSettings }\n    updated.practiceRound[images[index].path][property] = guessed\n    setGameSettings(updated)\n  }\n  const onSeenBeforeClick = onClickUpdateProperty.bind(null, \"seenbefore\")\n\n  const question = gameSettings.practiceRound[images[index].path]\n  const caption =\n    loadedImage.label === \"deer\" ? (\n      <div>This is a deer, and {AI_NAME} agrees</div>\n    ) : (\n      <div>\n        This is a deer, but {AI_NAME} thinks its a{\" \"}\n        <PictureLabel\n          changed={\n            isDef(loadedImage.previousLabel) &&\n            loadedImage.label !== loadedImage.previousLabel\n          }\n          title={`Previous: ${loadedImage.previousLabel || \"none\"}`}\n        >\n          {loadedImage.label}\n        </PictureLabel>\n      </div>\n    )\n  return (\n    <>\n      {displayMode !== \"trick\" ? <Caption>{caption}</Caption> : null}\n      {images[index].variants ? (\n        <SwitchMode\n          mode={displayMode}\n          onSwitchMode={(mode) => {\n            resetImage()\n            setDisplayMode(mode)\n            onChange(clean({ displayMode: mode }))\n          }}\n        />\n      ) : null}\n      {displayMode && displayMode === \"trick\" ? (\n        <Tunings\n          image={images[index]}\n          getImageDiv={getImageDiv}\n          onLoadImageVariant={(x) => {\n            setLoadedImage({\n              ...defaultLoadedImageState,\n              ...x,\n              previousLabel: loadedImage.label,\n            })\n            onChange({ ...defaultLoadedImageState, ...x, displayMode })\n          }}\n          probability={loadedImage.probability}\n        />\n      ) : null}\n      {displayMode && displayMode === \"trick\" ? (\n        <Probability\n          value={loadedImage.probability}\n          previousLabel={loadedImage.previousLabel}\n          label={loadedImage.label}\n        />\n      ) : null}\n      <ImageSliderOverrideStyles images={images} currentIndex={index} />\n      {displayMode !== \"trick\" ? (\n        <StyledPracticeVoteButtons>\n          <QuestionWithButtons\n            question={`Do you think ${AI_NAME} was trained on this image?`}\n            onAnswer={onSeenBeforeClick.bind(null)}\n            defaultValue={question.seenbefore}\n          />\n        </StyledPracticeVoteButtons>\n      ) : null}\n    </>\n  )\n}\n\nconst StyledPractice = styled.div`\n  display: flex;\n  flex-direction: row;\n`\n\nconst StyledPracticeGame = styled.div`\n  position: relative;\n`\n\nconst TwentyQuestionsPractice = ({ demo, hideSideBar }) => {\n  const [currentIndex, setCurrentIndex] = useState(0)\n  const [gameSettings, setGameSettings] = useContext(GameContext)\n  const [imageState, setImageState] = useState({})\n  const reset = () =>\n    resetGame(gameSettings, setGameSettings, setCurrentIndex, demo)\n  const sliderRef = useRef()\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  useEffect(reset, [])\n\n  const currentImage = () => {\n    const img = sliderRef.current.querySelectorAll(\n      'div[style*=\"background-image:\"][style*=\".png\"]'\n    )[1] // Take the second image, the first is the transition image\n    return img\n  }\n\n  if (\n    !gameSettings.currentGameData ||\n    !gameSettings.currentGameData.scrollingImages\n  )\n    return null\n\n  return gameSettings.currentGameData ? (\n    <Centered>\n      <StyledPractice id=\"practice-container\">\n        <StyledPracticeGame ref={sliderRef}>\n          <ImageControls\n            getImageDiv={currentImage}\n            images={gameSettings.currentGameData.scrollingImages}\n            index={currentIndex}\n            onChange={setImageState}\n          />\n          <SimpleImageSlider\n            key={gameSettings.version}\n            width={PRACTICE_IMAGE_SIZE.container.width}\n            height={PRACTICE_IMAGE_SIZE.container.height}\n            images={gameSettings.currentGameData.scrollingImages}\n            showBullets={false}\n            showNavs={imageState.displayMode !== \"trick\"}\n            navStyle={2}\n            onStartSlide={(idx) => {\n              setCurrentIndex(idx - 1)\n            }}\n            style={{\n              borderBottomLeftRadius: !hideSideBar ? 15 : null,\n              borderTopLeftRadius: !hideSideBar ? 15 : null,\n              backgroundColor: null,\n              border: \"1px solid slategray\",\n            }}\n          />\n        </StyledPracticeGame>\n        {!hideSideBar ? (\n          <PracticeResults\n            resetGame={reset}\n            currentImageIndex={currentIndex}\n            demo={demo}\n          />\n        ) : null}\n      </StyledPractice>\n    </Centered>\n  ) : null\n}\n\nexport default TwentyQuestionsPractice\n","import { Centered, GameButton } from \"./Util\"\nimport styled from \"styled-components\"\nimport { Link } from \"react-router-dom\"\n\nconst Container = styled.div`\n  border-radius: 10px;\n  background-color: antiquewhite;\n  box-shadow: 0 0 4px gray;\n  text-align: center;\n  padding: 40px;\n`\n\nconst Title = styled.h1`\n  font-family: Futura;\n  font-size: 4rem;\n`\n\nconst GameCards = styled.div`\n  display: inline;\n`\n\nconst GameCardContainer = styled.div`\n  display: inline-block;\n  border: 1px solid gray;\n  background-color: lightslategray;\n  color: white;\n  text-shadow: 2px 2px 2px darkslategray;\n  border-radius: 15px;\n  padding: 10px;\n  /* width: 180px; */\n  margin-right: 10px;\n  box-shadow: 1px 1px 4px grey;\n`\n\nconst GameCardTitle = styled.div`\n  font-size: 1.6rem;\n  margin: 15px;\n`\n\nconst GameCardButton = styled(GameButton)`\n  margin-right: 10px;\n`\n\nconst ButtonContainer = styled.div`\n  display: flex;\n  flex-direction: row;\n  justify-content: space-evenly;\n  margin-right: -10px;\n`\n\nconst GameCard = ({ title, links }) => {\n  return (\n    <GameCardContainer>\n      <GameCardTitle>{title}</GameCardTitle>\n      <ButtonContainer>\n        {links.map((x) => (\n          <Link key={x.to} to={x.to}>\n            <GameCardButton\n              {...{ \"data-tip\": x.disabled ? \"Coming soon\" : null }}\n            >\n              {x.title || \"Play\"}\n            </GameCardButton>\n          </Link>\n        ))}\n      </ButtonContainer>\n    </GameCardContainer>\n  )\n}\n\nconst games = [\n  {\n    title: \"20 Questions\",\n    links: [\n      { title: \"Learn\", to: \"/20q/learn\" },\n      { title: \"Easy\", to: \"/20q/easy\" },\n      { title: \"Hard\", to: \"/20q/hard\" },\n    ],\n  },\n  {\n    title: \"Match Game\",\n    links: [\n      { title: \"Learn\", to: \"/match/learn\" },\n      { title: \"Easy\", to: \"/match/easy\" },\n      { title: \"Hard\", to: \"/match/hard\" },\n    ],\n  },\n]\n\nconst Stack = styled.div`\n  display: flex;\n  flex-direction: column;\n`\nconst OrScroll = styled.div`\n  margin: 20px;\n  text-align: center;\n  &::after {\n    font-size: 1.4rem;\n    content: \"or scroll down to learn the story behind the games...\";\n  }\n`\n\nconst Menu = () => {\n  return (\n    <>\n      <Centered>\n        <Stack>\n          <Container>\n            <Title>Play A Game</Title>\n            <GameCards>\n              {games.map((x) => (\n                <GameCard key={x.title} {...x} />\n              ))}\n            </GameCards>\n            {/* <p title={`Running in ${process.env.NODE_ENV} mode`}>\n          COMPY has seen a lot of deer images before, and he is really good at\n          identifying a deer when he sees one.\n        </p>\n        <p>\n          Can you tell which of the following deer images COMPY may have seen?\n        </p>\n        <p>\n          Click Practice to scroll through the pictures one at a time and test\n          your knowledge about COMPY.\n        </p>\n        <p>\n          When you are ready, you can click Play to play a game of who knows\n          COMPY best.\n        </p>\n        */}\n          </Container>\n          <OrScroll />\n        </Stack>\n      </Centered>\n    </>\n  )\n}\n\nexport default Menu\n","import React, { useState } from \"react\"\nimport styled from \"styled-components\"\nimport { Emoji } from \"./game/Util\"\n\n// Inspired by https://github.com/distillpub/post--communicating-with-interactive-articles/blob/master/src/diagrams/horse.svelte\n\nconst Container = styled.div`\n  border: 1px solid gray;\n  border-radius: 5px;\n  background-color: whitesmoke;\n`\nconst PictureAndInformation = styled.div`\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n`\nconst Picture = styled.img`\n  margin: 25px;\n  height: 250px;\n  width: auto;\n  border-radius: 5px;\n`\nconst Information = styled.div`\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  margin: 0 15px 15px 0;\n  /* padding: 15px; */\n`\nconst Controls = styled.div`\n  display: flex;\n  flex-direction: row;\n`\nconst Slides = styled.div`\n  text-align: center;\n  padding: 10px;\n  border-top: 1px solid gray;\n`\nconst Slide = styled.img`\n  height: 100px;\n  width: auto;\n  margin-right: 5px;\n  cursor: crosshair;\n  padding-bottom: 3px;\n  border-bottom: ${({ selected }) =>\n    selected ? \"5px solid midnightblue\" : \"5px solid rgba(0,0,0,0)\"};\n`\n\nconst Rotated = ({ rotation = 90, children, style }) => (\n  <div style={{ ...style, transform: `rotate(${rotation}deg)` }}>\n    {children}\n  </div>\n)\n\nconst RotatedText = (props) => (\n  <Rotated style={{ fontSize: props.size }} {...props}></Rotated>\n)\n\nconst StyledAnimateButton = styled.button`\n  border: 2px solid slategray;\n  border-radius: 50%;\n  outline: none;\n  height: 30px;\n  width: 30px;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n`\n\nconst ButtonSymbols = {\n  play: <Emoji symbol=\"0x25B6\" style={{ paddingLeft: 3 }} />,\n  pause: <RotatedText size={23}>=</RotatedText>,\n}\n\nconst AnimateButton = ({ status = \"stopped\", onClick }) => {\n  const stateSymbols = {\n    stopped: ButtonSymbols.play,\n    playing: ButtonSymbols.pause,\n  }\n  return (\n    <StyledAnimateButton onClick={onClick}>\n      {stateSymbols[status]}\n    </StyledAnimateButton>\n  )\n}\n\nconst ImageAnimation = ({ images, info, width, delay = 150 }) => {\n  const [selectedIndex, setSelectedIndex] = useState(0)\n  const [animating, setAnimating] = useState(false)\n  React.useEffect(() => {\n    if (animating) {\n      const nextIndex =\n        selectedIndex < images.length - 1 ? selectedIndex + 1 : 0\n      setTimeout(() => setSelectedIndex(nextIndex), delay)\n    }\n  }, [animating, selectedIndex, setSelectedIndex, images, delay])\n\n  return (\n    <Container style={{ width }}>\n      <PictureAndInformation>\n        <Picture src={images[selectedIndex]} alt=\"\" />\n        <Information>\n          <div>{info}</div>\n          <Controls>\n            <AnimateButton\n              selectedIndex={selectedIndex}\n              status={animating ? \"playing\" : \"stopped\"}\n              onClick={() => setAnimating(!animating)}\n            />\n            <input\n              type=\"range\"\n              min={0}\n              max={images.length - 1}\n              step={1}\n              value={selectedIndex}\n              style={{ outline: \"none\" }}\n              onInput={(e) => setSelectedIndex(parseInt(e.target.value))}\n            />\n          </Controls>\n        </Information>\n      </PictureAndInformation>\n      <Slides>\n        {images.map((x, i) => (\n          <Slide\n            key={`slide-${i}`}\n            src={x}\n            onMouseOver={() => {\n              if (!animating) setSelectedIndex(i)\n            }}\n            selected={i === selectedIndex}\n          />\n        ))}\n      </Slides>\n    </Container>\n  )\n}\n\nexport default ImageAnimation\n","import styled from \"styled-components\"\nimport { ResponsiveScatterPlot } from \"@nivo/scatterplot\"\nimport { ResponsiveWaffle } from \"@nivo/waffle\"\nimport { ResponsivePie } from \"@nivo/pie\"\nimport { isDef } from \"../../util/misc\"\nimport { RangeSlider } from \"../game/Util\"\n\nexport const ChartData = {\n  closestX: (x) => Math.round(x * 2) / 2,\n  dotPlot: (results, { groups }) => {\n    const filtered = (data, filterFn) =>\n      Object.keys(data)\n        .map((x) => data[x].map((y, i) => ({ x: x, y: i + 1, label: y })))\n        .flat()\n        .filter(filterFn)\n\n    const binned = results.reduce(\n      (all, x) => ({\n        ...all,\n        [x.errorRounded]: [...(all[x.errorRounded] || []), x.path],\n      }),\n      {}\n    )\n    return {\n      groups,\n      colors: groups.map((x) => x.color),\n      maxX: Object.keys(binned).length ? Math.max(...Object.keys(binned)) : 0,\n      data: groups.map((x) => ({\n        id: x.label,\n        data: filtered(binned, x.fn),\n      })),\n    }\n  },\n  rollup: (results, { title, groups }, threshold) => {\n    const starterBin = groups.reduce((all, x) => ({ ...all, [x.label]: 0 }), {})\n    const binned = results.reduce(\n      (binned, x) =>\n        (groups || []).reduce(\n          (all, g) =>\n            g.fn(x, threshold)\n              ? { ...all, [g.label]: (all[g.label] || 0) + 1 }\n              : { ...all },\n          binned\n        ),\n      starterBin\n    )\n    return {\n      groups,\n      title,\n      colors: groups.map((x) => x.color),\n      data: groups.map((g) => ({\n        id: g.label,\n        label: g.label,\n        value: binned[g.label],\n      })),\n      total: results.length,\n    }\n  },\n}\n\nconst Tooltip = styled.div`\n  background-color: white;\n  border-radius: 3px;\n  padding: 5px;\n  border: 1px solid gray;\n`\n\nconst ChartContainer = styled.div`\n  height: ${({ height = 150 }) => `${height}px`};\n  width: ${({ width = 150 }) => `${width}px`};\n  background-color: white;\n  border: 1px solid lightgray;\n  border-radius: 5px;\n  margin: 5px;\n`\n\nconst reducePropWithFn = (fn, propKey, data) =>\n  data && data.length\n    ? data.reduce(\n        (cumulative, v) => fn(...v.data.map((d) => d[propKey]), cumulative),\n        0\n      )\n    : 0\n\nconst Thresholds = {\n  maxXValue: reducePropWithFn.bind(null, Math.max, \"x\"),\n  maxYValue: reducePropWithFn.bind(null, Math.max, \"y\"),\n  minXValue: reducePropWithFn.bind(null, Math.min, \"x\"),\n  minYValue: reducePropWithFn.bind(null, Math.min, \"y\"),\n  yCount: (data, x) =>\n    data && data.length\n      ? data.reduce(\n          (count, set) =>\n            set.data.filter((item) => item.x.toString() === x.toString())\n              .length + count,\n          0\n        )\n      : 0,\n}\nconst Threshold = ({ data, threshold, xScale, yScale, nodeSize }) => {\n  const beyondYBuffer = 5\n  if (!isDef(data) || !isDef(threshold) || !isDef(nodeSize)) return null\n\n  const [columnX1, columnY1, columnX2, columnY2] = [\n    xScale(threshold),\n    yScale(-beyondYBuffer),\n    xScale(threshold),\n    yScale(Thresholds.maxYValue(data) + beyondYBuffer),\n  ]\n\n  const columnCount = Thresholds.yCount(data, threshold)\n\n  const minX = Thresholds.minXValue(data)\n  const maxX = Thresholds.maxXValue(data)\n  const minXEdge = minX - 1\n  const maxXEdge = maxX + 2\n  const linePadding = nodeSize / 2.0 + 1\n  const columnPolyPoints = [\n    `${columnX1 - linePadding},${columnY1}`,\n    `${columnX1 - linePadding},${columnY2}`,\n    `${columnX2 + linePadding},${columnY2}`,\n    `${columnX2 + linePadding},${columnY1}`,\n  ]\n  // const inAreaPolyPoints = [\n  //   `${columnX2 + linePadding},${columnY2}`,\n  //   `${columnX2 + linePadding},${columnY1}`,\n  //   `${xScale(maxX)},${columnY1}`,\n  //   `${xScale(maxX)},${columnY2}`,\n  // ]\n  const outAreaPolyPoints = [\n    `${xScale(minXEdge)},${columnY1}`,\n    `${xScale(minXEdge)},${columnY2}`,\n    `${columnX1 - linePadding},${columnY2}`,\n    `${columnX1 - linePadding},${columnY1}`,\n  ]\n  const inLabelX = columnX2 + (xScale(maxXEdge) - columnX2) / 2.0\n  const outLabelX = columnX1 - (columnX1 - xScale(minXEdge)) / 2.0\n  return isNaN(columnX1) ||\n    isNaN(columnX2) ||\n    isNaN(columnY1) ||\n    isNaN(columnY2) ? null : (\n    <>\n      <>\n        {threshold > minX ? (\n          <text\n            x={outLabelX}\n            y={-10}\n            textAnchor=\"middle\"\n            style={{ fontSize: \".7rem\" }}\n          >\n            &#8592; OUT\n          </text>\n        ) : null}\n        {columnCount ? (\n          <text\n            x={columnX1}\n            y={-10}\n            textAnchor=\"middle\"\n            style={{ fontSize: \".63rem\" }}\n          >\n            {columnCount}\n          </text>\n        ) : null}\n        {threshold <= maxX ? (\n          <text\n            x={inLabelX}\n            y={-10}\n            textAnchor=\"middle\"\n            style={{ fontSize: \".7rem\" }}\n          >\n            IN &#8594;\n          </text>\n        ) : null}\n      </>\n      <polygon\n        points={columnPolyPoints.join(\" \")}\n        fill=\"rgba(0,0,0,0)\"\n        stroke=\"rgba(20,20,20,1)\"\n        strokeWidth=\"1.5\"\n      />\n      <polygon points={outAreaPolyPoints.join(\" \")} fill=\"rgba(0,0,0,.15)\" />\n    </>\n  )\n}\n\nconst DotPlot = ({\n  model,\n  nodeSize = 13,\n  threshold,\n  maxX = \"auto\",\n  minX = \"auto\",\n  colorFn,\n  bottomLabel,\n}) => (\n  <ResponsiveScatterPlot\n    data={model.data}\n    margin={{ top: 20, bottom: 50, right: 20, left: 20 }}\n    xScale={{ type: \"linear\", min: minX, max: maxX }}\n    colors={colorFn || model.colors}\n    tooltip={(x) => <Tooltip>{x.node.data.label}</Tooltip>}\n    nodeSize={nodeSize}\n    axisBottom={{\n      orient: \"bottom\",\n      legend: bottomLabel,\n      legendPosition: \"middle\",\n      legendOffset: 35,\n    }}\n    axisLeft={false}\n    threshold={threshold}\n    layers={[\"axes\", \"nodes\", Threshold]}\n    legends={[\n      {\n        anchor: \"top-right\",\n        direction: \"column\",\n        translateX: 110,\n        translateY: 0,\n        itemWidth: 90,\n        itemHeight: 12,\n        itemsSpacing: 5,\n        symbolSize: nodeSize,\n        symbolShape: \"circle\",\n        effects: [\n          {\n            on: \"hover\",\n            style: {\n              itemTextColor: \"#000\",\n              itemBackground: \"#f7fafb\",\n            },\n          },\n        ],\n      },\n    ]}\n  />\n)\n\nconst StyledChartTitle = styled.div`\n  font-weight: bold;\n  font-size: 0.8rem;\n  text-align: center;\n  margin: 5px 0;\n`\nconst WaffleDot = ({\n  size,\n  x,\n  y,\n  color,\n  fill,\n  opacity,\n  borderWidth,\n  borderColor,\n  onHover,\n  onLeave,\n}) => (\n  <circle\n    r={size / 2}\n    cx={x + size / 2}\n    cy={y + size / 2}\n    fill={fill || color}\n    strokeWidth={borderWidth}\n    stroke={borderColor}\n    opacity={opacity}\n    onMouseEnter={onHover}\n    onMouseMove={onHover}\n    onMouseLeave={onLeave}\n  />\n)\nconst Waffle = ({ model }) => {\n  if (!model.total) return null\n  return (\n    <>\n      {model.title ? <StyledChartTitle>{model.title}</StyledChartTitle> : null}\n      <ResponsiveWaffle\n        data={model.data}\n        total={model.total}\n        rows={model.total / 10 + 1}\n        columns={10}\n        colors={model.colors}\n        margin={{ top: 0 }}\n        cellComponent={WaffleDot}\n        fillDirection=\"top\"\n        emptyColor=\"rgba(0,0,0,0)\"\n      />\n    </>\n  )\n}\n\nconst PieCenterTotal = ({ dataWithArc, centerX, centerY }) => {\n  const total = dataWithArc.reduce((all, x) => all + x.value, 0)\n  return (\n    <text\n      x={centerX}\n      y={centerY}\n      textAnchor=\"middle\"\n      dominantBaseline=\"central\"\n      style={{\n        fontSize: \"1.5rem\",\n      }}\n    >\n      {total}\n    </text>\n  )\n}\n\nconst Pie = ({ model, showTotal = true }) => {\n  return (\n    <>\n      {model.title ? <StyledChartTitle>{model.title}</StyledChartTitle> : null}\n      <ResponsivePie\n        data={model.data}\n        margin={{ top: 35, right: 120, bottom: 80, left: 120 }}\n        colors={model.colors}\n        innerRadius={0.6}\n        enableRadialLabels={false}\n        padAngle={0.5}\n        cornerRadius={2}\n        layers={[\n          \"slices\",\n          \"sliceLabels\",\n          \"radialLabels\",\n          \"legends\",\n          showTotal ? PieCenterTotal : null,\n        ]}\n        sliceLabel={(x) => (x.value ? x.value : null)}\n        sliceLabelsTextColor=\"white\"\n      />\n    </>\n  )\n}\n\nconst LegendPart = ({ color, text, colorPosition = \"left\" }) => {\n  const swatch = (\n    <div\n      style={{\n        width: 14,\n        height: 14,\n        borderRadius: \"50%\",\n        backgroundColor: color,\n        margin: \"0 5px\",\n      }}\n    />\n  )\n  return (\n    <div\n      style={{\n        display: \"flex\",\n        textAlign: colorPosition,\n        justifyContent: colorPosition === \"left\" ? \"flex-start\" : \"flex-end\",\n        padding: \"1px 0\",\n      }}\n    >\n      {colorPosition === \"left\" ? swatch : null}\n      <span style={{ fontSize: \".6rem\" }}>{text}</span>\n      {colorPosition === \"right\" ? swatch : null}\n    </div>\n  )\n}\n\nconst Legend = ({ model }) => (\n  <div\n    style={{\n      display: \"grid\",\n      gridTemplateColumns: \"50% 50%\",\n    }}\n  >\n    <LegendPart colorPosition=\"right\" {...model.negativeBelowThreshold} />\n    <LegendPart {...model.positiveBelowThreshold} />\n    <LegendPart colorPosition=\"right\" {...model.negativeAboveThreshold} />\n    <LegendPart {...model.positiveAboveThreshold} />\n  </div>\n)\n\nconst FlexDiv = styled.div`\n  display: flex;\n`\nconst FlexColumns = styled(FlexDiv)`\n  flex-direction: column;\n`\nconst FlexRows = styled(FlexDiv)`\n  flex-direction: row;\n`\nconst ThresholdChartSet = ({\n  nodeSize = 10,\n  height = 300,\n  width = 600,\n  threshold,\n  models,\n  dotPlotMaxX,\n  bottomLabel,\n  sliderLabel,\n  setThreshold,\n  dotPlotColorFn,\n  legendModel,\n}) => {\n  const dotPlotWidth = width / 2\n  const smallChartHeight = height / 2 - 6\n  return (\n    <FlexDiv>\n      {dotPlotMaxX ? (\n        <FlexColumns>\n          <ChartContainer height={height} width={dotPlotWidth}>\n            <DotPlot\n              model={models.dotPlot}\n              nodeSize={nodeSize}\n              threshold={threshold}\n              minX={0}\n              maxX={dotPlotMaxX}\n              colorFn={dotPlotColorFn}\n              bottomLabel={bottomLabel}\n              legendModel={legendModel}\n            />\n          </ChartContainer>\n          <RangeSlider\n            label={sliderLabel}\n            labelPosition=\"bottom\"\n            min={0}\n            max={dotPlotMaxX}\n            step={0.5}\n            value={threshold}\n            style={{\n              outline: \"none\",\n              width: dotPlotWidth - 40,\n              marginLeft: 26,\n              marginTop: 4,\n            }}\n            handleStyle={{\n              padding: 3,\n              borderRadius: \"0 0 50% 50%\",\n            }}\n            onChange={(level) => setThreshold(level)}\n          />\n        </FlexColumns>\n      ) : null}\n      <FlexColumns>\n        <FlexRows>\n          <ChartContainer height={smallChartHeight}>\n            <Waffle model={models.correct} />\n          </ChartContainer>\n          <ChartContainer height={smallChartHeight}>\n            <Waffle model={models.incorrect} />\n          </ChartContainer>\n        </FlexRows>\n        <FlexRows>\n          <ChartContainer height={smallChartHeight}>\n            <Pie model={models.truePositive} />\n          </ChartContainer>\n          <ChartContainer height={smallChartHeight}>\n            <Pie model={models.positive} />\n          </ChartContainer>\n        </FlexRows>\n        <Legend model={legendModel} />\n      </FlexColumns>\n    </FlexDiv>\n  )\n}\n\n////////////////////////////////////////////////////////////////////////////////////\n// Specific Experiment Config below\n////////////////////////////////////////////////////////////////////////////////////\n\n// const Colors = {\n//   red: \"#FF4136\",\n//   blue: \"#0074D9\",\n//   lightgray: \"lightgray\",\n//   gray: \"gray\",\n// }\n\n// const LegendModel = {\n//   positiveAboveThreshold: { color: Colors.blue, text: \"IN - Above Threshold\" },\n//   positiveBelowThreshold: { color: Colors.gray, text: \"IN - Below Threshold\" },\n//   negativeAboveThreshold: { color: Colors.red, text: \"OUT - Above Threshold\" },\n//   negativeBelowThreshold: {\n//     color: Colors.lightgray,\n//     text: \"OUT - Below Threshold\",\n//   },\n// }\n\n// const ChartModels = {\n//   dotPlot: {\n//     groups: [\n//       {\n//         label: \"In Distances\",\n//         fn: (x) => x.label.includes(\"_train_\"),\n//         color: Colors.blue,\n//       },\n//       {\n//         label: \"Out Distances\",\n//         fn: (x) => x.label.includes(\"_out_\"),\n//         color: Colors.red,\n//       },\n//     ],\n//   },\n//   correct: {\n//     title: \"Correct\",\n//     groups: [\n//       {\n//         label: \"Incorrect\",\n//         fn: (x, t) => x.errorRounded < t && x.path.includes(\"_out_\"),\n//         color: Colors.lightgray,\n//       },\n//       {\n//         label: \"Correct\",\n//         fn: (x, t) => x.errorRounded >= t && x.path.includes(\"_train_\"),\n//         color: Colors.blue,\n//       },\n//     ],\n//   },\n//   incorrect: {\n//     title: \"Incorrect\",\n//     groups: [\n//       {\n//         label: \"Incorrect\",\n//         fn: (x, t) => x.errorRounded >= t && x.path.includes(\"_out_\"),\n//         color: Colors.red,\n//       },\n//       {\n//         label: \"Correct\",\n//         fn: (x, t) => x.errorRounded < t && x.path.includes(\"_train_\"),\n//         color: Colors.gray,\n//       },\n//     ],\n//   },\n//   truePositive: {\n//     title: \"True Positive Rate\",\n//     groups: [\n//       {\n//         label: \"In\",\n//         fn: (x, t) => x.errorRounded >= t && x.path.includes(\"_train_\"),\n//         color: Colors.blue,\n//       },\n//       {\n//         label: \"In Below Threshold\",\n//         fn: (x, t) => x.errorRounded < t && x.path.includes(\"_train_\"),\n//         color: Colors.gray,\n//       },\n//     ],\n//   },\n//   positive: {\n//     title: \"Positive Rate\",\n//     groups: [\n//       {\n//         label: \"In\",\n//         fn: (x, t) => x.errorRounded >= t && x.path.includes(\"_train_\"),\n//         color: Colors.blue,\n//       },\n//       {\n//         label: \"In Below Threshold\",\n//         fn: (x, t) => x.errorRounded < t && x.path.includes(\"_train_\"),\n//         color: Colors.gray,\n//       },\n//       {\n//         label: \"Out\",\n//         fn: (x, t) => x.errorRounded >= t && x.path.includes(\"_out_\"),\n//         color: Colors.red,\n//       },\n//       {\n//         label: \"Out Below Threshold\",\n//         fn: (x, t) => x.errorRounded < t && x.path.includes(\"_out_\"),\n//         color: Colors.lightgray,\n//       },\n//     ],\n//   },\n// }\n// const ExperimentThresholdChartSet = ({\n//   nodeSize = 10,\n//   defaultThreshold = 4.5,\n//   height = 300,\n//   width = 600,\n//   thresholdPercent,\n//   bottomLabel,\n//   sliderLabel,\n// }) => {\n//   const [rawData, setRawData] = useState([])\n//   const [models, setModels] = useState({\n//     dotPlot: { data: [] },\n//     correct: { data: [], total: 0 },\n//     incorrect: { data: [], total: 0 },\n//     truePositive: { data: [], total: 0 },\n//     positive: { data: [], total: 0 },\n//   })\n//   const [dotPlotMaxX, setDotPlotMaxX] = useState(0)\n//   const [threshold, setThreshold] = useState(defaultThreshold)\n\n//   useEffect(() => {\n//     const getRawData = async () => {\n//       const result = await fetch(\"./data/dot-plot-results.json\")\n//       const data = await result.json()\n//       setRawData(\n//         data.results.map((x) => ({ ...x, errorRounded: closestX(x.error) }))\n//       )\n//     }\n\n//     getRawData()\n//   }, [])\n\n//   useEffect(() => {\n//     const _dotPlotData = ChartData.dotPlot(rawData, ChartModels.dotPlot)\n//     setModels({\n//       dotPlot: _dotPlotData,\n//       correct: ChartData.rollup(rawData, ChartModels.correct, defaultThreshold),\n//       incorrect: ChartData.rollup(\n//         rawData,\n//         ChartModels.incorrect,\n//         defaultThreshold\n//       ),\n//       truePositive: ChartData.rollup(\n//         rawData,\n//         ChartModels.truePositive,\n//         defaultThreshold\n//       ),\n//       positive: ChartData.rollup(\n//         rawData,\n//         ChartModels.positive,\n//         defaultThreshold\n//       ),\n//     })\n\n//     setThreshold(defaultThreshold)\n//     if (_dotPlotData.maxX) setDotPlotMaxX(_dotPlotData.maxX + 1)\n//   }, [rawData, defaultThreshold])\n\n//   useEffect(() => {\n//     let _threshold = threshold\n//     if (thresholdPercent) {\n//       _threshold = closestX(dotPlotMaxX * thresholdPercent)\n//       setThreshold(_threshold)\n//     }\n//     setModels({\n//       ...models,\n//       correct: ChartData.rollup(rawData, ChartModels.correct, _threshold),\n//       incorrect: ChartData.rollup(rawData, ChartModels.incorrect, _threshold),\n//       truePositive: ChartData.rollup(\n//         rawData,\n//         ChartModels.truePositive,\n//         _threshold\n//       ),\n//       positive: ChartData.rollup(rawData, ChartModels.positive, _threshold),\n//     }) // eslint-disable-next-line react-hooks/exhaustive-deps\n//   }, [threshold, thresholdPercent])\n//   return (\n//     <ThresholdChartSet\n//       nodeSize={nodeSize}\n//       height={height}\n//       width={width}\n//       threshold={threshold}\n//       models={models}\n//       legendModel={LegendModel}\n//       dotPlotMaxX={dotPlotMaxX}\n//       bottomLabel={bottomLabel}\n//       sliderLabel={sliderLabel}\n//       setThreshold={setThreshold}\n//       dotPlotColorFn={(x) =>\n//         x.x < threshold\n//           ? x.label.includes(\"out\")\n//             ? \"lightgray\"\n//             : \"gray\"\n//           : x.label && x.label.includes(\"out\")\n//           ? Colors.red\n//           : Colors.blue\n//       }\n//     />\n//   )\n// }\n\nexport default ThresholdChartSet\n","import { useEffect, useState } from \"react\"\nimport ThresholdChartSet, { ChartData } from \"./ThresholdChartSet\"\n\nconst Colors = {\n  red: \"#FF4136\",\n  blue: \"#0074D9\",\n  lightgray: \"lightgray\",\n  gray: \"gray\",\n}\n\nconst LegendModel = {\n  positiveAboveThreshold: { color: Colors.blue, text: \"IN - Above Threshold\" },\n  positiveBelowThreshold: { color: Colors.gray, text: \"IN - Below Threshold\" },\n  negativeAboveThreshold: { color: Colors.red, text: \"OUT - Above Threshold\" },\n  negativeBelowThreshold: {\n    color: Colors.lightgray,\n    text: \"OUT - Below Threshold\",\n  },\n}\n\nconst ChartModels = {\n  dotPlot: {\n    groups: [\n      {\n        label: \"In Distances\",\n        fn: (x) => x.label.includes(\"_train_\"),\n        color: Colors.blue,\n      },\n      {\n        label: \"Out Distances\",\n        fn: (x) => x.label.includes(\"_out_\"),\n        color: Colors.red,\n      },\n    ],\n  },\n  correct: {\n    title: \"Correct\",\n    groups: [\n      {\n        label: \"Incorrect\",\n        fn: (x, t) => x.errorRounded < t && x.path.includes(\"_out_\"),\n        color: Colors.lightgray,\n      },\n      {\n        label: \"Correct\",\n        fn: (x, t) => x.errorRounded >= t && x.path.includes(\"_train_\"),\n        color: Colors.blue,\n      },\n    ],\n  },\n  incorrect: {\n    title: \"Incorrect\",\n    groups: [\n      {\n        label: \"Incorrect\",\n        fn: (x, t) => x.errorRounded >= t && x.path.includes(\"_out_\"),\n        color: Colors.red,\n      },\n      {\n        label: \"Correct\",\n        fn: (x, t) => x.errorRounded < t && x.path.includes(\"_train_\"),\n        color: Colors.gray,\n      },\n    ],\n  },\n  truePositive: {\n    title: \"True Positive Rate\",\n    groups: [\n      {\n        label: \"In\",\n        fn: (x, t) => x.errorRounded >= t && x.path.includes(\"_train_\"),\n        color: Colors.blue,\n      },\n      {\n        label: \"In Below Threshold\",\n        fn: (x, t) => x.errorRounded < t && x.path.includes(\"_train_\"),\n        color: Colors.gray,\n      },\n    ],\n  },\n  positive: {\n    title: \"Positive Rate\",\n    groups: [\n      {\n        label: \"In\",\n        fn: (x, t) => x.errorRounded >= t && x.path.includes(\"_train_\"),\n        color: Colors.blue,\n      },\n      {\n        label: \"In Below Threshold\",\n        fn: (x, t) => x.errorRounded < t && x.path.includes(\"_train_\"),\n        color: Colors.gray,\n      },\n      {\n        label: \"Out\",\n        fn: (x, t) => x.errorRounded >= t && x.path.includes(\"_out_\"),\n        color: Colors.red,\n      },\n      {\n        label: \"Out Below Threshold\",\n        fn: (x, t) => x.errorRounded < t && x.path.includes(\"_out_\"),\n        color: Colors.lightgray,\n      },\n    ],\n  },\n}\nconst ExperimentThresholdChartSet = ({\n  nodeSize = 10,\n  defaultThreshold = 4.5,\n  height = 300,\n  width = 600,\n  thresholdPercent,\n  bottomLabel,\n  sliderLabel,\n}) => {\n  const [rawData, setRawData] = useState([])\n  const [models, setModels] = useState({\n    dotPlot: { data: [] },\n    correct: { data: [], total: 0 },\n    incorrect: { data: [], total: 0 },\n    truePositive: { data: [], total: 0 },\n    positive: { data: [], total: 0 },\n  })\n  const [dotPlotMaxX, setDotPlotMaxX] = useState(0)\n  const [threshold, setThreshold] = useState(defaultThreshold)\n\n  useEffect(() => {\n    const getRawData = async () => {\n      const result = await fetch(\"./data/dot-plot-results.json\")\n      const data = await result.json()\n      setRawData(\n        data.results.map((x) => ({\n          ...x,\n          errorRounded: ChartData.closestX(x.error),\n        }))\n      )\n    }\n\n    getRawData()\n  }, [])\n\n  useEffect(() => {\n    const _dotPlotData = ChartData.dotPlot(rawData, ChartModels.dotPlot)\n    setModels({\n      dotPlot: _dotPlotData,\n      correct: ChartData.rollup(rawData, ChartModels.correct, defaultThreshold),\n      incorrect: ChartData.rollup(\n        rawData,\n        ChartModels.incorrect,\n        defaultThreshold\n      ),\n      truePositive: ChartData.rollup(\n        rawData,\n        ChartModels.truePositive,\n        defaultThreshold\n      ),\n      positive: ChartData.rollup(\n        rawData,\n        ChartModels.positive,\n        defaultThreshold\n      ),\n    })\n\n    setThreshold(defaultThreshold)\n    if (_dotPlotData.maxX) setDotPlotMaxX(_dotPlotData.maxX + 1)\n  }, [rawData, defaultThreshold])\n\n  useEffect(() => {\n    let _threshold = threshold\n    if (thresholdPercent) {\n      _threshold = ChartData.closestX(dotPlotMaxX * thresholdPercent)\n      setThreshold(_threshold)\n    }\n    setModels({\n      ...models,\n      correct: ChartData.rollup(rawData, ChartModels.correct, _threshold),\n      incorrect: ChartData.rollup(rawData, ChartModels.incorrect, _threshold),\n      truePositive: ChartData.rollup(\n        rawData,\n        ChartModels.truePositive,\n        _threshold\n      ),\n      positive: ChartData.rollup(rawData, ChartModels.positive, _threshold),\n    }) // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [threshold, thresholdPercent])\n  return (\n    <ThresholdChartSet\n      nodeSize={nodeSize}\n      height={height}\n      width={width}\n      threshold={threshold}\n      models={models}\n      legendModel={LegendModel}\n      dotPlotMaxX={dotPlotMaxX}\n      bottomLabel={bottomLabel}\n      sliderLabel={sliderLabel}\n      setThreshold={setThreshold}\n      dotPlotColorFn={(x) =>\n        x.x < threshold\n          ? x.label.includes(\"out\")\n            ? \"lightgray\"\n            : \"gray\"\n          : x.label && x.label.includes(\"out\")\n          ? Colors.red\n          : Colors.blue\n      }\n    />\n  )\n}\n\nexport default ExperimentThresholdChartSet\n","import { useState, useEffect } from \"react\"\nimport styled from \"styled-components\"\nimport { Centered, RangeSlider } from \"./game/Util\"\nimport { gameData } from \"../util/data\"\n\nconst toNoiseImage = (image, index) => ({\n  index,\n  src: `img/${image.path}`,\n  label: image.label,\n})\n\nconst Container = styled.div`\n  display: flex;\n  flex-direction: column;\n  background-color: whitesmoke;\n  padding: 10px;\n  border: 1px solid gray;\n  border-radius: 5px;\n`\n\nconst StyledImageTile = styled.div`\n  position: relative;\n  display: inline-block;\n  height: ${({ size = {} }) => size.height || \"180px\"};\n  width: ${({ size = {} }) => size.width || \"180px\"};\n  margin: 2px;\n`\n\nconst StyledImageTileImage = styled.img`\n  height: 100%;\n  width: 100%;\n  border-radius: ${({ rounded }) => (rounded ? \"5px\" : \"none\")};\n`\n\nconst StyledImageLabel = styled.div`\n  position: absolute;\n  bottom: 0;\n  right: 0;\n  padding: 5px;\n  font-size: 75%;\n  color: white;\n  background: rgba(0, 0, 0, 0.5);\n  border-top-left-radius: 3px;\n  border-bottom-right-radius: ${({ rounded }) => (rounded ? \"5px\" : \"none\")};\n`\n\nconst ImageTile = ({ image, size, rounded }) => (\n  <StyledImageTile size={size}>\n    <StyledImageLabel title={image.title} rounded={rounded}>\n      {image.label}\n    </StyledImageLabel>\n    <StyledImageTileImage src={image.src} alt=\"\" rounded={rounded} />\n  </StyledImageTile>\n)\n\nconst ImageTiles = ({ images, tileSize, rounded }) => (\n  <div>\n    {images.map((x, i) => (\n      <ImageTile\n        key={`image-tile-${x}-${i}`}\n        image={x}\n        size={tileSize}\n        rounded={rounded}\n      />\n    ))}\n  </div>\n)\n\nconst ImageNoise = ({ imageSetNumber = 3, rounded = true }) => {\n  const [rawImages, setRawImages] = useState([])\n  const [images, setImages] = useState([])\n  const [noiseLevel, setNoiseLevel] = useState(0)\n  const [noiseLevelRange, setNoiseLevelRange] = useState([0, 0])\n  useEffect(() => {\n    const getImageData = async () => {\n      const _gameData = await gameData()\n      const _rawImages = _gameData.practiceOptions[imageSetNumber]\n      setRawImages(_rawImages)\n      const noiseLevels = [\n        ...new Set(\n          _rawImages.reduce(\n            (all, x) => [\n              ...all,\n              ...Object.keys(x.variants || {})\n                .filter((x) => x.startsWith(\"noise\"))\n                .map((x) => parseInt(x.replace(\"noise\", \"\"))),\n            ],\n            []\n          )\n        ),\n      ]\n      setNoiseLevelRange([0, Math.max(...noiseLevels)])\n      setImages(_rawImages.map(toNoiseImage))\n    }\n\n    getImageData() // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [])\n\n  useEffect(() => {\n    if (noiseLevel === 0) return\n    const noisyImages = rawImages.map(\n      (x, i) => toNoiseImage(x.variants[`noise${noiseLevel}`], i) // TODO What if there is no noise level for this image?\n    )\n    setImages(noisyImages) // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [noiseLevel])\n\n  const [sliderMin, sliderMax] = noiseLevelRange\n  return images && images.length ? (\n    <Centered>\n      <Container>\n        <ImageTiles\n          images={images}\n          tileSize={{ height: \"180px\", width: \"180px\" }}\n          rounded={rounded}\n        />\n        {sliderMax > 0 ? (\n          <div style={{ display: \"flex\", justifyContent: \"center\" }}>\n            <RangeSlider\n              label=\"Add Noise\"\n              labelPosition=\"bottom\"\n              min={sliderMin}\n              max={sliderMax}\n              step={1}\n              value={noiseLevel}\n              style={{\n                outline: \"none\",\n                width: \"100%\",\n              }}\n              onChange={setNoiseLevel}\n            />\n          </div>\n        ) : null}\n      </Container>\n    </Centered>\n  ) : null\n}\n\nexport default ImageNoise\n","import { useState, useEffect } from \"react\"\nimport styled from \"styled-components\"\nimport { TagCloud } from \"react-tagcloud\"\n\nconst Model = [\n  { img: \"story-img/class-arch.png\", label: \"Arch\", tagSize: 25 },\n  { img: \"story-img/class-barn.png\", label: \"Barn\", tagSize: 35 },\n  { img: \"story-img/class-beach.png\", label: \"Beach\", tagSize: 25 },\n  { img: \"story-img/class-beetle.png\", label: \"Beetle\", tagSize: 35 },\n  { img: \"story-img/class-broom.png\", label: \"Broom\", tagSize: 25 },\n  { img: \"story-img/class-candle.png\", label: \"Candle\", tagSize: 35 },\n  { img: \"story-img/class-lamp.png\", label: \"Lamp\", tagSize: 25 },\n  { img: \"story-img/class-phone.png\", label: \"Phone\", tagSize: 35 },\n  { img: \"story-img/class-pool-table.png\", label: \"Pool Table\", tagSize: 25 },\n  { img: \"story-img/class-ship.png\", label: \"Ship\", tagSize: 35 },\n  { img: \"story-img/class-skunk.png\", label: \"Skunk\", tagSize: 35 },\n  { img: \"story-img/class-toaster.png\", label: \"Toaster\", tagSize: 25 },\n]\n\nconst data = Model.map((x, i) => ({ value: x.label, count: x.tagSize }))\n\nconst StyledImg = styled.img`\n  border-radius: 5px;\n  margin: 0 2px 0 2px;\n  display: inline-block;\n`\n\nconst Image = ({\n  details: { img, label },\n  imageWidth,\n  onSelect = () => null,\n}) => {\n  const [hovered, setHovered] = useState(false)\n  const onMouseOver = (label) => {\n    setHovered(label ? true : false)\n    onSelect(label)\n  }\n\n  const style = () => ({\n    width: imageWidth,\n    height: \"auto\",\n    boxShadow: hovered ? \"1px 1px 5px gray\" : \"none\",\n  })\n\n  return (\n    <StyledImg\n      onMouseOver={() => onMouseOver(label)}\n      onMouseOut={() => onMouseOver()}\n      src={img}\n      alt={label}\n      style={style()}\n    />\n  )\n}\n\nconst Images = ({ images, width = 640, imageWidth = 130, onSelect }) => {\n  return (\n    <div style={{ width }}>\n      {images.map((x) => (\n        <Image\n          key={`card-${x.label}`}\n          details={x}\n          imageWidth={imageWidth}\n          onSelect={onSelect}\n        />\n      ))}\n    </div>\n  )\n}\n\nconst Tag = styled.div`\n  display: inline-block;\n  margin: 3px 10px;\n  padding: 0 4px;\n  border: 3px solid ${({ color }) => color};\n  border-radius: 3px;\n  font-size: ${({ size }) => size}pt;\n  transition: border 0.2s linear;\n`\n\nconst customRenderer = (tag, size, color) => {\n  return (\n    <Tag key={tag.value} size={size} color={color}>\n      {tag.value}\n    </Tag>\n  )\n}\nconst ImageClasses = ({ model = Model }) => {\n  const [selected, setSelected] = useState()\n  const [images, setImages] = useState([])\n\n  useEffect(() => {\n    setImages(model) // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [])\n\n  return (\n    <div\n      style={{\n        display: \"flex\",\n        justifyContent: \"center\",\n        alignItems: \"center\",\n      }}\n    >\n      <Images images={images} onSelect={(label) => setSelected(label)} />\n      <div style={{ display: \"flex\", alignContent: \"center\" }}>\n        <TagCloud\n          style={{ width: 400, textAlign: \"center\" }}\n          tags={data}\n          minSize={25}\n          maxSize={35}\n          renderer={(tag) =>\n            customRenderer(\n              tag,\n              tag.count,\n              tag.value === selected ? \"orange\" : \"rgba(0,0,0,0)\"\n            )\n          }\n        />\n      </div>\n    </div>\n  )\n}\n\nexport default ImageClasses\n","const Model = {\n  columns: [\n    { cx: 10, fill: \"rgb(157,157,144)\", yValues: [10, 30, 50, 70, 90] },\n    { cx: 40, fill: \"rgb(158,170,190)\", yValues: [30, 50, 70] },\n    { cx: 70, fill: \"rgb(240,161,112)\", yValues: [40, 60] },\n    {\n      cx: 100,\n      yValues: [\n        { cy: 10, fill: \"rgb(176,0,4)\" },\n        { cy: 26, r: 1 },\n        { cy: 30, r: 1 },\n        { cy: 34, r: 1 },\n        { cy: 50, fill: \"rgb(0,0,0)\" },\n        { cy: 70, fill: \"rgb(255,226,129)\" },\n        { cy: 90, fill: \"rgb(130,201,63)\" },\n      ],\n    },\n    {\n      cx: 130,\n      yValues: [\n        { cy: 10, fill: \"rgb(222,93,97)\" },\n        { cy: 26, r: 1 },\n        { cy: 30, r: 1 },\n        { cy: 34, r: 1 },\n        { cy: 50, fill: \"rgb(129,134,133)\" },\n        { cy: 70, fill: \"rgb(255,239,185)\" },\n        { cy: 90, fill: \"rgb(186,227,146)\" },\n      ],\n    },\n  ],\n  arrows: [\n    { from: [0, 0], to: [1, 0] },\n    { from: [0, 0], to: [1, 1] },\n    { from: [0, 1], to: [1, 0] },\n    { from: [0, 1], to: [1, 1] },\n    { from: [0, 1], to: [1, 2] },\n    { from: [0, 2], to: [1, 0] },\n    { from: [0, 2], to: [1, 1] },\n    { from: [0, 2], to: [1, 2] },\n    { from: [0, 3], to: [1, 0] },\n    { from: [0, 3], to: [1, 1] },\n    { from: [0, 3], to: [1, 2] },\n    { from: [0, 4], to: [1, 1] },\n    { from: [0, 4], to: [1, 2] },\n    { from: [1, 0], to: [2, 0] },\n    { from: [1, 0], to: [2, 1] },\n    { from: [1, 1], to: [2, 0] },\n    { from: [1, 1], to: [2, 1] },\n    { from: [1, 2], to: [2, 0] },\n    { from: [1, 2], to: [2, 1] },\n    { from: [2, 0], to: [3, 0] },\n    { from: [2, 0], to: [3, 4] },\n    { from: [2, 0], to: [3, 5] },\n    { from: [2, 0], to: [3, 6] },\n    { from: [2, 1], to: [3, 0] },\n    { from: [2, 1], to: [3, 4] },\n    { from: [2, 1], to: [3, 5] },\n    { from: [2, 1], to: [3, 6] },\n  ],\n}\n\nconst defaultCircleProps = {\n  r: 8,\n  fill: \"black\",\n}\n\nconst circleProps = ({ index, override }) => ({\n  ...defaultCircleProps,\n  key: `circle-${index}-${override.cy}`,\n  ...override,\n})\n\nconst Column = ({ index, cx, yValues, r = 8, fill }) =>\n  yValues.map((cy) => {\n    const props =\n      typeof cy === \"object\"\n        ? circleProps({\n            index,\n            override: { cx, ...cy },\n          })\n        : circleProps({\n            index,\n            override: { cx, cy, r, fill },\n          })\n    return <circle {...props} />\n  })\n\nconst TargetModelArrow = ({ from, to }) => {\n  const lineY = (col, i) => {\n    const yValue = Model.columns[col].yValues[i]\n    return typeof yValue === \"object\" ? yValue.cy : yValue\n  }\n  const lineX = (col) => Model.columns[col].cx + defaultCircleProps.r\n  const lineEndX = (col) => Model.columns[col].cx - defaultCircleProps.r\n  return (\n    <line\n      x1={lineX(from[0])}\n      y1={lineY(from[0], from[1])}\n      x2={lineEndX(to[0])}\n      y2={lineY(to[0], to[1])}\n      stroke=\"#000\"\n      strokeWidth={0.7}\n      markerEnd=\"url(#arrowhead)\"\n    />\n  )\n}\n\nconst TargetModelDiagram = ({ style, id, additionalShapes = [] }) => (\n  <div style={style} id={id}>\n    <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 140 100\">\n      <defs>\n        <marker\n          id=\"arrowhead\"\n          markerWidth=\"6\"\n          markerHeight=\"6\"\n          refX=\"12\"\n          refY=\"3\"\n          orient=\"auto\"\n        >\n          <polygon points=\"0 0, 6 3, 0 6\" />\n        </marker>\n      </defs>\n      {Model.columns.map((c, i) => (\n        <Column key={`column-${i}`} {...c} />\n      ))}\n\n      {Model.arrows.map((a, i) => (\n        <TargetModelArrow key={`target-model-arrow-${i}`} {...a} />\n      ))}\n\n      {additionalShapes}\n    </svg>\n  </div>\n)\n\nexport default TargetModelDiagram\n","import { useState, useEffect, useRef, useCallback } from \"react\"\nimport styled, { keyframes } from \"styled-components\"\nimport Xarrow from \"react-xarrows\"\nimport TargetModelDiagram from \"./TargetModel\"\nimport { Emoji } from \"../game/Util\"\n\nconst fadeIn = keyframes`\n  from { opacity: 0; }\n  to { opacity: 1; }\n`\n\nconst Input = styled.div`\n  height: 100px;\n  width: 100px;\n  background-color: gray;\n  margin: 10px;\n  margin-left: 35px;\n  font-size: 1.2rem;\n  &::before {\n    content: \"x\\\\208${({ index }) => index}\";\n    position: relative;\n    left: -65%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    height: inherit;\n  }\n`\n\nconst Inputs = ({ count, images }) => {\n  const inputs = new Array(count).fill(0)\n  return (\n    <div\n      style={{\n        display: \"flex\",\n        flexDirection: \"column\",\n      }}\n    >\n      {inputs.map((_, i) => (\n        <Input\n          key={`input-${i + 1}`}\n          index={i + 1}\n          id={`input-${i + 1}`}\n          style={{\n            backgroundImage: images[i] ? `url(story-img/${images[i]})` : null,\n          }}\n        />\n      ))}\n    </div>\n  )\n}\n\nconst StyledOutputDiagram = styled.div`\n  position: absolute;\n  top: 0;\n  left: 0;\n  animation: ${fadeIn} 0.1s linear;\n`\n\nconst OutputDiagram = ({ width = \"100%\", height = \"100%\", index }) => {\n  const boxStyle = (heightOffset) => ({\n    height: 10 + (heightOffset || 0),\n    rx: 1,\n    y: 40 - (heightOffset || 0),\n  })\n  const ellipseStyle = {\n    stroke: \"rgb(63,108,175)\",\n    strokeWidth: 4,\n    fill: \"none\",\n  }\n  return (\n    <StyledOutputDiagram\n      style={{ width, height, position: \"absolute\" }}\n      id={`output-${index}`}\n    >\n      {/* <svg viewBox={`0 0 ${width} ${height}`}> */}\n      <svg viewBox={`0 0 100 85`}>\n        <rect fill=\"rgb(176,0,4)\" style={boxStyle()} x={2} width={15} />\n        <rect fill=\"#eee\" style={boxStyle()} x={20} width={22} />\n        <rect fill=\"black\" x={21} y={44} height={2} width={2} />\n        <rect fill=\"black\" x={25} y={44} height={2} width={2} />\n        <rect fill=\"black\" x={29} y={44} height={2} width={2} />\n        <rect\n          fill=\"black\"\n          style={boxStyle((index - 1) * 5)}\n          x={43}\n          width={15}\n        />\n        <rect fill=\"rgb(255,226,129)\" style={boxStyle()} x={61} width={19} />\n        <rect fill=\"rgb(130,201,63)\" style={boxStyle()} x={80} width={18} />\n        <ellipse cx=\"50\" cy=\"42\" rx=\"15\" ry=\"40\" style={ellipseStyle} />\n        <text x=\"50\" y=\"72\" textAnchor=\"middle\" style={{ font: \"14px arial\" }}>\n          ?\n        </text>\n      </svg>\n    </StyledOutputDiagram>\n  )\n}\n\nconst Output = styled.div`\n  position: relative;\n  height: 100px;\n  min-height: 100px;\n  margin-top: -25px;\n  padding: 0.25em;\n  width: 120px;\n  border: 3px solid #333;\n  background-color: white;\n  font-size: 1.3rem;\n  &::before {\n    /* content: \"\\\\1D453(x\\\\208${({ index }) => index})\"; */\n    position: relative;\n    left: -80%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    height: inherit;\n  }\n  &:nth-child(odd) {\n    left: 150px;\n    margin-left: 30px;\n  }\n  &:nth-child(even) {\n    left: 35px;\n  }\n`\n\nconst Outputs = ({ count }) => {\n  const inputs = new Array(count).fill(0)\n  return (\n    <div\n      style={{\n        display: \"flex\",\n        flexDirection: \"column\",\n        maxHeight: 200,\n        paddingTop: 25,\n        justifyContent: \"space-evenly\",\n      }}\n    >\n      {inputs.map((_, i) => (\n        <Output index={i + 1} key={`output-${i + 1}`}>\n          <OutputDiagram index={i + 1} />\n        </Output>\n      ))}\n    </div>\n  )\n}\n\nconst lineColors = [\n  \"\",\n  \"black\",\n  \"rgb(130,120,66)\",\n  \"rgb(252,0,26)\",\n  \"rgb(58,105,173)\",\n]\n// Can't figure out how to send unicode to LeaderLine labels\nconst HACK_lineLabels = [\"\", \"𝑓(x₁)\", \"𝑓(x₂)\", \"𝑓(x₃)\", \"𝑓(x₄)\"]\n\nconst LineLabel = ({ index }) => (\n  <div style={{ color: lineColors[index], marginTop: 15 }}>\n    {HACK_lineLabels[index]}\n  </div>\n)\n\nconst inputImages = [\n  null,\n  \"input-output-input-2.png\",\n  \"input-output-input-3.png\",\n  \"input-output-input-4.png\",\n]\n\nconst ActionButton = styled.button`\n  background-color: rgb(63, 108, 175);\n  color: white;\n  border: none;\n  padding: 8px;\n  border-radius: 5px;\n  font-size: 16pt;\n  outline: none;\n  vertical-align: top;\n  height: 42px;\n  &:disabled {\n    pointer-events: none;\n    color: gray;\n  }\n  &:hover {\n    text-shadow: 1px 1px 1px black;\n  }\n  &:nth-child(odd) {\n    border-top-right-radius: 0;\n    border-bottom-right-radius: 0;\n    border-right: 2px solid gray;\n  }\n  &:nth-child(even) {\n    border-top-left-radius: 0;\n    border-bottom-left-radius: 0;\n  }\n`\n\nconst Buttons = ({ onClick, actionDisabled }) => {\n  return (\n    <div style={{ textAlign: \"center\", marginBottom: 15 }}>\n      <ActionButton onClick={() => onClick(1)} disabled={actionDisabled}>\n        <Emoji symbol=\"0x203A\" /> Step Inversion\n      </ActionButton>\n      <ActionButton onClick={() => onClick()} title=\"Reset\">\n        <Emoji symbol=\"0x21BB\" />\n      </ActionButton>\n    </div>\n  )\n}\n\nconst InputOutput = () => {\n  const [inputCount, setInputCount] = useState(0)\n  const linesOld = useRef([])\n  const [lines, setLines] = useState([])\n\n  useEffect(() => {\n    setTimeout(() => setInputCount(1), 1000) // HACK, can't figure out how to wait on rendering lines\n  }, [])\n\n  const drawLines = useCallback(() => {\n    if (inputCount > 0) {\n      const _lines = []\n\n      for (let i = 1; i <= inputCount; i++) {\n        const lineOptions = {\n          color: lineColors[i],\n          size: 2.5,\n          animateDrawing: \"0.5s\",\n          strokeWidth: 2,\n          path: \"straight\",\n        }\n        _lines.push({\n          ...lineOptions,\n          start: `input-${i}`,\n          end: \"target-model\",\n        })\n        _lines.push({\n          ...lineOptions,\n          startAnchor: { position: \"auto\", offset: { rightness: -54 } },\n          start: \"target-model\",\n          end: `output-${i}`,\n          label: { end: <LineLabel index={i} /> },\n        })\n      }\n      setLines(_lines)\n    }\n  }, [inputCount])\n\n  useEffect(() => {\n    drawLines()\n  }, [drawLines])\n\n  const updateInputCount = (delta) =>\n    setInputCount((prev) => {\n      if (delta === null || delta === undefined) setInputCount(1)\n      else {\n        const updated = prev + delta\n        setInputCount(Math.min(Math.max(1, updated), 4))\n      }\n    })\n\n  return (\n    <div style={{ marginBottom: 300 }}>\n      <Buttons onClick={updateInputCount} actionDisabled={inputCount === 4} />\n      <div\n        style={{\n          display: \"flex\",\n          justifyContent: \"space-around\",\n          alignItems: \"center\",\n          minWidth: 900,\n          maxWidth: \"90%\",\n        }}\n        ref={linesOld}\n      >\n        <Inputs count={inputCount} images={inputImages} />\n        <TargetModelDiagram\n          style={{ width: 275 }}\n          id=\"target-model\"\n          additionalShapes={[\n            <circle\n              key=\"circled-output-shape\"\n              cx=\"100\"\n              cy=\"50\"\n              r=\"12\"\n              stroke=\"rgb(63,108,175)\"\n              strokeWidth={2}\n              fill=\"none\"\n            />,\n          ]}\n        />\n        <Outputs count={inputCount} />\n        {lines.map((x) => (\n          <Xarrow key={`xarrow-${x.start}-${x.end}`} {...x} />\n        ))}\n      </div>\n      {/* <img src=\"story-img/SGD4.png\" id=\"sgd4\" alt=\"\" /> */}\n    </div>\n  )\n}\n\nexport default InputOutput\n","import { useState, useEffect } from \"react\"\nimport { chain } from \"../../util/misc\"\nimport styled from \"styled-components\"\nimport Xarrow from \"react-xarrows\"\n// import { usePrevious } from \"../../hooks\"\n\nconst RowFlexContainer = styled.div`\n  display: flex;\n  flex-direction: row;\n  justify-content: space-evenly;\n  align-items: ${({ valign = \"center\" }) => valign};\n`\n\nconst defaultLinkConfig = {\n  size: 4,\n  head: 3,\n  color: \"coral\",\n}\n\nconst FlowCharts = {\n  validate: (elements) => {\n    const issues = []\n    elements.forEach((x) => {\n      if (!x.id && !x.props.id)\n        issues.push(`FlowChart element [${x.type}] is missing id`)\n    })\n    return issues\n  },\n  hasPosition: (x) =>\n    x.style &&\n    (\"top\" in x.style ||\n      \"bottom\" in x.style ||\n      \"left\" in x.style ||\n      \"right\" in x.style),\n  hasPositionedElements: (elements) =>\n    elements.reduce((all, x) => all || FlowCharts.hasPosition(x), false),\n  hasUserDefinedLinks: (elements) =>\n    elements.reduce((all, x) => all || \"links\" in x, false),\n  buildLinks: (elements) => {\n    const userDefined = FlowCharts.hasUserDefinedLinks(elements)\n    if (userDefined) {\n      return elements\n        .map((x) =>\n          (Object.keys(x.links || {}) || []).map((l) => ({\n            from: x.id,\n            to: l,\n            config: { ...defaultLinkConfig, ...x.links[l] },\n          }))\n        )\n        .flat()\n    } else {\n      // Build links from element to element in order given\n      return elements.reduce((all, x, i) => {\n        if (i === elements.length - 1) return all\n        return [\n          ...all,\n          {\n            from: x.props.id,\n            to: elements[i + 1].props.id,\n            config: defaultLinkConfig,\n          },\n        ]\n      }, [])\n    }\n  },\n}\n\nconst StyledFlowChartElement = styled.div`\n  display: flex;\n  justify-content: space-around;\n  & * {\n    display: block;\n  }\n`\n\nconst FlowChart = ({\n  name,\n  elements,\n  size,\n  style,\n  startAnimating,\n  visible,\n  chainLinkAnimation,\n  betweenLinkDelay = 0,\n}) => {\n  const shouldAnimate = visible && startAnimating\n  const [links, setLinks] = useState([])\n  const issues = FlowCharts.validate(elements)\n  if (issues.length) {\n    console.error(issues.join(\"\\n\"))\n  }\n\n  const linkId = (x) => `${x.from}-${x.to}`\n  useEffect(() => {\n    if (shouldAnimate) {\n      if (chainLinkAnimation) {\n        setLinks((prev) => [])\n        const fns = FlowCharts.buildLinks(elements).map((x) => () =>\n          setLinks((prev) =>\n            prev.find((l) => linkId(l) === linkId(x)) ? prev : [...prev, x]\n          )\n        )\n        chain(fns, betweenLinkDelay)\n      } else {\n        setLinks(FlowCharts.buildLinks(elements))\n      }\n    } else if (!visible) {\n      setLinks([])\n    }\n  }, [\n    setLinks,\n    elements,\n    shouldAnimate,\n    visible,\n    betweenLinkDelay,\n    chainLinkAnimation,\n  ])\n\n  const containerStyle = FlowCharts.hasPositionedElements(elements)\n    ? { position: \"relative\", ...size }\n    : {\n        display: \"flex\",\n        justifyContent: \"space-evenly\",\n        alignItems: \"center\",\n        flex: 1,\n      }\n\n  const elementStyle = (x) =>\n    FlowCharts.hasPosition(x) ? { position: \"absolute\", ...x.style } : null\n\n  return (\n    <RowFlexContainer style={style}>\n      <div style={containerStyle}>\n        {elements.map((x, i) => (\n          <StyledFlowChartElement\n            key={`${name}-${i}`}\n            id={x.id}\n            style={elementStyle(x)}\n          >\n            {x.element ? x.element : x}\n          </StyledFlowChartElement>\n        ))}\n        {links.map((x) => {\n          return (\n            <Xarrow\n              key={`${name}-line-${x.from}-${x.to}`}\n              start={`${x.from}`}\n              end={`${x.to}`}\n              color={x.config.color}\n              path={x.config.path}\n              strokeWidth={x.config.size}\n              startAnchor={x.config.startSocket}\n              endAnchor={x.config.endSocket}\n              headSize={x.config.head}\n              animateDrawing={shouldAnimate ? \"0.5s\" : false}\n            />\n          )\n        })}\n      </div>\n    </RowFlexContainer>\n  )\n}\n\nexport default FlowChart\n","import { useState, useEffect } from \"react\"\nimport { Scrollama, Step } from \"react-scrollama\"\nimport ImageDiff from \"react-image-diff\"\nimport ImageAnimation from \"./ImageAnimation\"\nimport styled from \"styled-components\"\nimport ExperimentThresholdCharts from \"./chart/ExperimentThresholdCharts\"\nimport ImageNoise from \"./ImageNoise\"\nimport ImageClasses from \"./story/ImageClasses\"\nimport InputOutput from \"./story/InputOutput\"\nimport TargetModelDiagram from \"./story/TargetModel\"\nimport { Centered } from \"./game/Util\"\nimport FlowChart from \"./story/FlowChart\"\n\nconst ImageTitle = styled.h4`\n  text-align: center;\n  margin: 0 0 5px 0;\n`\n\nconst Scroller = styled.div`\n  flex-basis: 100%;\n`\n\nconst ScrollerContainer = styled.div`\n  padding: 40vh 2vw 70vh;\n  display: flex;\n  justify-content: space-between;\n`\n\nconst ScrollContainer = styled.div`\n  display: flex;\n  justify-content: space-between;\n`\n\nconst ScrollyHeaderSection = styled.h2``\nconst ScrollyContentSection = styled.div``\nconst ScrollyImageSectionContainer = styled.div`\n  margin-top: 20px;\n  position: sticky;\n  top: 10px;\n  height: 50%;\n`\n\nconst ScrollySectionWithBackgroundImage = ({\n  width = \"50%\",\n  minWidth = 700,\n  img,\n  title,\n  children,\n  status,\n  sizePercent = 60,\n  imageOpacity = 0.2,\n}) => {\n  const imageWidth =\n    status && status.progress\n      ? sizePercent + status.progress * (100 - sizePercent)\n      : sizePercent\n  return (\n    <Centered>\n      <div\n        style={{\n          width,\n          minWidth,\n          height: 400,\n          position: \"relative\",\n        }}\n      >\n        <img\n          src={`story-img/${img}`}\n          alt=\"\"\n          style={{\n            position: \"absolute\",\n            width: `${imageWidth}%`,\n            height: \"auto\",\n            opacity: imageOpacity,\n            top: \"50%\",\n            left: \"50%\",\n            transform: \" translate(-50%, -50%)\",\n          }}\n        />\n        <div\n          style={{\n            position: \"absolute\",\n            width: \"100%\",\n            top: \"50%\",\n            left: \"50%\",\n            transform: \" translate(-50%, -50%)\",\n          }}\n        >\n          <ScrollyHeaderSection>{title}</ScrollyHeaderSection>\n          <ScrollContainer>\n            <ScrollyContentSection style={{}}>{children}</ScrollyContentSection>\n          </ScrollContainer>\n        </div>\n      </div>\n    </Centered>\n  )\n}\n\nconst RowFlexContainer = styled.div`\n  display: flex;\n  flex-direction: row;\n  justify-content: space-evenly;\n  align-items: ${({ valign = \"center\" }) => valign};\n`\n\nconst WeaknessWithAI = ({ status }) => {\n  return (\n    <div style={stepOpacityStyle(status)}>\n      <ScrollySectionWithBackgroundImage\n        title=\"The Weakness with AI\"\n        img=\"weakness.png\"\n        width=\"50%\"\n        status={status}\n      >\n        <p>\n          The ability of deep neural network (DNN) machine learning (ML) models\n          to achieve human or above-human task performance is a result of the\n          availability of vast amounts of data. As organizations dedicate\n          expensive resources to data acquisition, processing, labeling and\n          storage and training of DNNs, the data must be treated as sensitive\n          proprietary information. These facts are often expressed as “data is\n          the new oil” and “data is the new source code,” respectively.\n        </p>\n        <p>\n          However, recent demonstrations have shown how DNN characteristics and\n          behaviors can be leveraged by malicious actors to make the DNN reveal,\n          learn, or do the wrong thing. To see how DNNs can be exploited, we\n          will first set the stage with an example of a successful machine\n          learning application within the field of computer vision.\n        </p>\n      </ScrollySectionWithBackgroundImage>\n    </div>\n  )\n}\n\nconst LabelTile = styled.div`\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  border: 10px solid #0074d9;\n  font-size: 1.2em;\n  background-color: white;\n  padding: 30px;\n`\n\nconst PuppiesToFoodFlowChart = ({ status }) => (\n  <FlowChart\n    name=\"puppies-or-food-flow\"\n    elements={[\n      <img src=\"story-img/puppy.png\" id=\"puppies-or-food-1\" alt=\"\" />,\n      <TargetModelDiagram style={{ width: 180 }} id=\"puppies-or-food-2\" />,\n      <LabelTile id=\"puppies-or-food-3\">food</LabelTile>,\n    ]}\n    visible={status && status.visible}\n    startAnimating={status && status.visible}\n    chainLinkAnimation={true}\n    betweenLinkDelay={1000}\n  />\n)\n\nconst PuppiesVsCroissantsImages = (/*{ status }*/) => (\n  <RowFlexContainer valign=\"start\">\n    <ImageDiff\n      before=\"story-img/2puppies.png\"\n      after=\"story-img/2croissants.png\"\n      type=\"swipe\"\n      value={0.5}\n      slider\n      // animation={\n      //   status && status.visible && status.progress > 0.5\n      //     ? { end: 0, step: -0.02 }\n      //     : null\n      // }\n      // animation\n    />\n    <ImageDiff\n      before=\"story-img/2puppies.png\"\n      after=\"story-img/2croissants.png\"\n      type=\"fade\"\n      slider\n    />\n    {/* <ImageDiff\n      before=\"story-img/2puppies.png\"\n      after=\"story-img/2croissants.png\"\n      type=\"difference\"\n    /> */}\n  </RowFlexContainer>\n)\n\nconst VerticalSpacer = ({ height }) => (\n  <div style={{ width: \"100%\", height: `${height}px` }}></div>\n)\n\nconst PuppiesOrFoodImage = ({ cover }) => {\n  const backgroundColor = \"rgba(0,0,0,.7)\"\n  const Covers = {\n    securityPrivacyConcerns: {\n      backgroundColor,\n      clipPath: \"polygon(0% 33%, 50% 33%, 50% 0%, 100% 0%, 100% 100%, 0% 100%)\",\n    },\n    hoverShape: {\n      backgroundColor,\n      clipPath: \"polygon(0% 33%, 100% 33%, 100% 100%, 0% 100%)\",\n    },\n    hoverTexture: {\n      backgroundColor,\n      clipPath:\n        \"polygon(0% 0%, 100% 0%, 100% 33%, 0% 33%, 0% 66%, 100% 66%, 100% 100%, 0% 100%)\",\n    },\n    hoverColor: {\n      backgroundColor,\n      clipPath: \"polygon(0% 66%, 0% 0%, 100% 0%, 100% 66%)\",\n    },\n  }\n  return (\n    <div style={{ width: \"100%\" }}>\n      <img\n        src={`story-img/puppies-or-food.png`}\n        style={{\n          height: \"auto\",\n          width: \"100%\",\n        }}\n        alt=\"\"\n      />\n      <div\n        style={{\n          position: \"absolute\",\n          top: 0,\n          width: \"100%\",\n          height: \"100%\",\n          transition: \"opacity 0.1s linear\",\n          opacity: cover ? 1 : 0,\n          ...(Covers[cover] || {}),\n        }}\n      />\n    </div>\n  )\n}\n\nconst stepOpacityStyle = (status) => {\n  const _default = { opacity: \"1\", transition: \"opacity 0.3s linear\" }\n  return status && status.visible ? _default : { ..._default, opacity: \"0.1\" }\n}\n\nconst StyledHoverLink = styled.button`\n  cursor: pointer;\n  background-color: gold;\n  color: #444;\n  border: none;\n  font-family: Futura;\n  font-weight: bold;\n  border-radius: 4px;\n  padding: 0 3px;\n  margin-left: 2px;\n  &:hover {\n    color: #000;\n  }\n`\n\nconst HoverLink = ({ children, onHover, offHover }) => (\n  <StyledHoverLink onMouseEnter={onHover} onMouseLeave={offHover}>\n    {children}\n  </StyledHoverLink>\n)\n\nconst PuppiesOrFoodHoverLink = ({ children, cover, setCover }) => (\n  <HoverLink onHover={() => setCover(cover)} offHover={() => setCover(\"\")}>\n    {children}\n  </HoverLink>\n)\n\nconst StepContainer = styled.div`\n  margin-bottom: 100px;\n`\n\nconst PuppiesOrFoodStepContainer = styled(StepContainer)`\n  opacity: ${({ currentView, viewName }) =>\n    currentView && currentView.data === viewName ? \"1\" : \"0.3\"};\n  padding-bottom: 400px;\n  margin-bottom: 100px;\n`\n\nconst PuppiesOrFood = ({ status }) => {\n  const [currentView, setCurrentView] = useState()\n  const [cover, setCover] = useState()\n  useEffect(() => {\n    setCover(\n      currentView && currentView.data === \"4\" ? \"securityPrivacyConcerns\" : \"\"\n    )\n  }, [currentView])\n  return (\n    <div style={stepOpacityStyle(status)}>\n      <ScrollyHeaderSection>Puppies or Food?</ScrollyHeaderSection>\n      <ScrollContainer>\n        <ScrollyContentSection style={{ flexBasis: \"50%\" }}>\n          <Scrollama\n            onStepEnter={setCurrentView}\n            onStepExit={() => setCurrentView(null)}\n            offset={0.4}\n          >\n            <Step data=\"1\">\n              <PuppiesOrFoodStepContainer\n                viewName=\"1\"\n                currentView={currentView}\n              >\n                <h4>Classification: Still a Tough Problem </h4>\n                <p>\n                  Undoubtedly, one of the most successful applications of\n                  artificial intelligence involves classification within\n                  computer vision. In computer vision, the DNN task is to take a\n                  new image and categorize it into one of several known classes\n                  that it has been trained on. On the right, there are a number\n                  of images, some of which are puppies, and some of which are\n                  food. Modern day machine learning models can typically perform\n                  this classification task so well that it is easy to forget\n                  that this is not a solved problem.\n                </p>\n                {/* <VerticalSpacer height={600} /> */}\n              </PuppiesOrFoodStepContainer>\n            </Step>\n            <Step data=\"2\">\n              <PuppiesOrFoodStepContainer\n                viewName=\"2\"\n                currentView={currentView}\n              >\n                <p>\n                  These specific images were collated by Karen Zack, with the\n                  Twitter handle of “@teenybiscuit.” It is interesting that you\n                  may not be able to classify each image with the same level of\n                  ease or confidence. This is true for DNNs as well, epsecially\n                  with images with feautures they have not seen before. If you\n                  take these images and pass them through modern deep neural\n                  networks to see how they perform, don’t be surprised to learn\n                  that some of them may also get confused.\n                </p>\n                <PuppiesToFoodFlowChart status={status} />\n                {/* <VerticalSpacer height={600} /> */}\n              </PuppiesOrFoodStepContainer>\n            </Step>\n            <Step data=\"3\">\n              <PuppiesOrFoodStepContainer\n                viewName=\"3\"\n                currentView={currentView}\n              >\n                <h4> Interpretability: Tough to Explain What is Learned </h4>\n                <p>\n                  These images indicate that DNNs may learn how to identify\n                  objects in ways similar to human vision, for instance,\n                  <PuppiesOrFoodHoverLink\n                    cover=\"hoverShape\"\n                    setCover={setCover}\n                  >\n                    shape\n                  </PuppiesOrFoodHoverLink>\n                  ,\n                  <PuppiesOrFoodHoverLink\n                    cover=\"hoverTexture\"\n                    setCover={setCover}\n                  >\n                    texture\n                  </PuppiesOrFoodHoverLink>\n                  , or\n                  <PuppiesOrFoodHoverLink\n                    cover=\"hoverColor\"\n                    setCover={setCover}\n                  >\n                    color\n                  </PuppiesOrFoodHoverLink>\n                  . However, within the field there is not a common\n                  understanding of what these models are learning.\n                </p>\n                {/* <VerticalSpacer height={600} /> */}\n              </PuppiesOrFoodStepContainer>\n            </Step>\n            <Step data=\"4\">\n              <PuppiesOrFoodStepContainer\n                viewName=\"4\"\n                currentView={currentView}\n              >\n                <h4> Security & Privacy Concerns </h4>\n                <p>\n                  Beyond their inherent fun and quality of fooling modern day\n                  models, there are a few other lessons that these images\n                  highlight. First, you should be aware that for any model,\n                  similar examples can always be found – ones that make a model\n                  do the wrong thing despite our attempts to make them extremely\n                  accurate. This means that it is likely that our application\n                  can be intentionally circumvented by those using it, with\n                  possibly unexpected things occurring.\n                  <b> This presents a security vulnerability. </b>\n                </p>\n                <p>\n                  We can try to avoid this vulnerability while also increasing\n                  the accuracy by training with examples such as these two:\n                </p>\n                <PuppiesVsCroissantsImages status={status} />\n                <p>\n                  While learning, the model must extract more information about\n                  these two images in order to correctly differentiate between\n                  them. Often, the model learns characteristics of these\n                  specific images, storing what we would consider sensitive\n                  information. When this occurs, the model may exhibit different\n                  output behavior for those images. This indicates that the DNN\n                  is leaking information about specific images, revealing the\n                  wrong thing.\n                  <b> Ths presents a privacy vulnerability. </b>\n                </p>\n                {/* <VerticalSpacer height={600} /> */}\n              </PuppiesOrFoodStepContainer>\n            </Step>\n            <Step data=\"5\">\n              <PuppiesOrFoodStepContainer\n                viewName=\"5\"\n                currentView={currentView}\n              >\n                <h4>ML is inherently fragile with unstable behavior</h4>\n                <p>\n                  All of these observations point out a key characteristic of\n                  modern day deep neural networks – they are inherently fragile\n                  and will exhibit unstable behavior. This cannot be avoided and\n                  must be considered when building and deploying applications.\n                </p>\n                {/* <VerticalSpacer height={300} /> */}\n              </PuppiesOrFoodStepContainer>\n            </Step>\n          </Scrollama>\n        </ScrollyContentSection>\n        <ScrollyImageSectionContainer\n          style={{\n            flexBasis: \"48%\",\n            position: \"sticky\",\n            marginTop: 10,\n          }}\n        >\n          <PuppiesOrFoodImage status={status} cover={cover} />\n        </ScrollyImageSectionContainer>\n      </ScrollContainer>\n    </div>\n  )\n}\n\nconst TitledElement = ({ title, children, bottom = false }) => (\n  <div\n    style={{ display: \"flex\", flexDirection: \"column\", alignItems: \"center\" }}\n  >\n    {title && !bottom ? <ImageTitle>{title}</ImageTitle> : null}\n    {children}\n    {title && bottom ? <ImageTitle>{title}</ImageTitle> : null}\n  </div>\n)\n\nconst MiaFlowChart = ({ status, style }) => (\n  <FlowChart\n    name=\"mia-layout\"\n    size={{ height: 325, width: 500 }}\n    style={style}\n    elements={[\n      {\n        id: \"mia-flow-horse\",\n        element: (\n          <TitledElement>\n            <img src=\"story-img/horse.png\" alt=\"\" />\n          </TitledElement>\n        ),\n        style: { top: 140 },\n        links: {\n          \"mia-flow-target-model\": {\n            startSocket: \"top\",\n            endSocket: \"left\",\n            size: 10,\n            color: \"midnightblue\",\n            endLabel: \"Classify\",\n            path: \"grid\",\n          },\n        },\n      },\n      {\n        id: \"mia-flow-target-model\",\n        element: (\n          <TitledElement title=\"Target Model\">\n            <img src=\"story-img/target-model.png\" alt=\"\" />\n          </TitledElement>\n        ),\n        style: { left: 150, top: 10 },\n        links: {\n          \"mia-flow-bar-chart\": {\n            path: \"straight\",\n            color: \"black\",\n          },\n        },\n      },\n      {\n        id: \"mia-flow-bar-chart\",\n        element: (\n          <TitledElement title=\"Yes or No?\" bottom>\n            <img src=\"story-img/bar-chart.png\" alt=\"\" />\n          </TitledElement>\n        ),\n        style: { right: 0, top: 1 },\n      },\n      {\n        id: \"mia-flow-compliance-officer\",\n        element: (\n          <TitledElement title=\"Compliance Officer\" bottom>\n            <img src=\"story-img/compliance-officer.png\" alt=\"\" />\n          </TitledElement>\n        ),\n        style: { left: 150, bottom: 0 },\n        links: {\n          \"mia-flow-horse\": {\n            startSocket: \"left\",\n            endSocket: \"bottom\",\n            size: 10,\n            color: \"midnightblue\",\n            path: \"grid\",\n          },\n          \"mia-flow-bar-chart\": {\n            startSocket: \"right\",\n            endSocket: \"bottom\",\n            size: 10,\n            color: \"midnightblue\",\n            path: \"grid\",\n          },\n        },\n      },\n    ]}\n    visible={status && status.visible}\n    startAnimating={status && status.visible}\n  />\n)\n\nconst MembershipInferenceAttack = ({ status }) => (\n  <div style={stepOpacityStyle(status)}>\n    <ScrollyHeaderSection>\n      Membership Inference Attack (MIA)\n    </ScrollyHeaderSection>\n    <ScrollContainer>\n      <ScrollyContentSection style={{ flexBasis: \"50%\" }}>\n        <div style={{ margin: 20, position: \"sticky\", top: 10 }}>\n          <MiaFlowChart status={status} />\n        </div>\n      </ScrollyContentSection>\n      <ScrollyContentSection style={{ flexBasis: \"50%\" }}>\n        <p>\n          In the membership inference attack, we want to answer the question of\n          whether a specific piece of data was in the training data set for the\n          machine learning model. Here, one does not necessarily need to have\n          access to the original data set, though we have the ability to query\n          the model with input data and obtain the outputs.\n        </p>\n        <p>\n          There are several operational scenarios in which we need to answer\n          this question. First, we may have a deployed model that has been\n          supporting an application for some time. If the data point was used to\n          train that model, it could make the model noncompliant and we would\n          have to terminate its use. Furthermore, any actions previously taken\n          or data previously collected based upon the model could also be\n          noncompliant. Right now, legal precedence says to throw out the model\n          and any evidence that may have been collected with it.\n        </p>\n        <p>\n          Second, you may have a trained a model using a small amount of data\n          that was collected with NTM and as such, it has a higher\n          classification given its relationship to TTP, sources and methods.\n          Given that you do not own the data, it is feasible that others will\n          have access to the data as well. For example, 2nd and 3rd party\n          partners where this model will be deployed into. If that sensitive\n          data can be readily identified from the model output, it puts NTM at\n          risk.\n        </p>\n      </ScrollyContentSection>\n    </ScrollContainer>\n  </div>\n)\n\nconst ModelInversionAttack = ({ status }) => (\n  <div style={stepOpacityStyle(status)}>\n    <ScrollyHeaderSection>Model Inversion Attack</ScrollyHeaderSection>\n    <div style={{ display: \"flex\", justifyContent: \"space-between\" }}>\n      <img src=\"story-img/Shallow.png\" id=\"shallow\" alt=\"\" />\n      <div style={{ margin: \"0 50px\" }}>\n        There is no consensus in the machine learning community about what data\n        features DNNs learn while training, which makes it tough to interpret\n        them. However, the work Zeiler and Fergus in the field of visual\n        interpretations of DNNs is a useful starting point. Their method\n        “transposes” DNNs to find which image patches are responsible for\n        certain neural activations. With the associated results, they argued the\n        shallow layers identify rough features such as edges and colors in the\n        training data set and the deeper layers combine these features into\n        higher level shapes and object abstractions.\n      </div>\n      <img src=\"story-img/Deep.png\" id=\"deep\" alt=\"\" />\n    </div>\n    <VerticalSpacer height={300} />\n    <p>\n      Here are some class prototypes from the Zeieler and Fergus paper. These\n      images are not real and would never be found in any data set that was\n      generated via imagery collection. However, can you understand what the DNN\n      is looking for in each output class?\n    </p>\n    <ImageClasses />\n    {/* <img src=\"story-img/ClassPrototypes.png\" id=\"class prototypes\" alt=\"\" /> */}\n    <VerticalSpacer height={300} />\n    <p>\n      In the model inversion attack, the output nodes of a DNN are used to\n      reconstruct a prototype represenation of each class. The optimization\n      process used to accomplish this is very similar to the one used in the\n      training of the DNN and the technqiue used by Zeiler and Fergus. In the\n      case of image classification, a DNN is a function, f, that maps\n      high-dimensional input image features of height H, width W, and D\n      channels, to a probability vector with dimensions, d, matching the number\n      of possible categories. Model inversion seeks to find an image such that\n      the output probability for that class is maximized, while the other\n      possible outputs are minimized.\n    </p>\n    <p>\n      Stochastic gradient ascent can be used with an associated cost function to\n      iteratively transform a proposed image to the local maxima of the\n      differentiable function, f. This is very similar to how weight updates\n      occur in neural network training, where the inputs and outputs are\n      constant. In this case, the weights and output class are held constant and\n      the input is updated.\n    </p>\n    <p>\n      These class prototypes are images represent the extracted features that\n      allow the network to best differentiate amongst the classes.\n    </p>\n    <InputOutput />\n    <p>\n      However, anyone can perform model inversion against any model. Below we\n      include an example of audio inversion. Can you hear what each class is\n      looking for?\n    </p>\n    <ScrollContainer>\n      <ScrollyContentSection style={{ flexBasis: \"100%\" }}>\n        <ReverseEngineeringDataPrototypes width=\"60vw\" />\n      </ScrollyContentSection>\n    </ScrollContainer>\n  </div>\n)\n\nconst ReverseEngineeringDataPrototypes = (props) => (\n  <RowFlexContainer>\n    <ImageAnimation\n      images={[\n        \"story-img/match_game_cifar_robust_images_deer_threshold_1.png\",\n        \"story-img/match_game_cifar_robust_images_deer_threshold_16.png\",\n        \"story-img/match_game_cifar_robust_images_deer_threshold_32.png\",\n        \"story-img/match_game_cifar_robust_images_deer_threshold_64.png\",\n        \"story-img/match_game_cifar_robust_images_deer_threshold_128.png\",\n        \"story-img/match_game_cifar_robust_images_deer_threshold_256.png\",\n      ]}\n      info={\n        <>\n          <h3>Reverse Engineering Data Prototypes</h3>\n          <p style={{ fontSize: \".85rem\", color: \"lightslategray\" }}>\n            The model inversion attack seeks to reconstruct representations of\n            the training data in order to glean information about sensitive\n            data-collection tools, techniques and tradecraft. For computer\n            vision models, inversion can produce image representations for every\n            class label in the model. The interactive figure below demonstrates\n            real images formed during an inversion of the deer class. The\n            inversion process is an optimization problem similar to that used to\n            train the model in the first place. Here, the image inversion is\n            randomly initialized and a new image is saved at each stage. In the\n            early stages of inversion optimization, these images typically\n            remain gray and not visually interpretable and thus we refer to\n            these generated images \"gray data\". However, as the inversion\n            process continues, these images can have significant elements that\n            are human interpretable.\n          </p>\n        </>\n      }\n      {...props}\n    />\n  </RowFlexContainer>\n)\n\nconst TwentyQuestions = ({ status }) => (\n  <div style={stepOpacityStyle(status)}>\n    <ScrollyHeaderSection>A game of 20 Questions...</ScrollyHeaderSection>\n    <ScrollContainer>\n      <ScrollyContentSection style={{ flexBasis: \"60%\" }}>\n        <div style={{ position: \"sticky\", top: 10 }}>\n          <p>\n            If DNNs did not leak any information about it's training set, there\n            would be no way to answer this question better than randomly\n            guessing 'yes' or 'no'.\n          </p>\n          <p>\n            Thus, perhaps the easiest strategy for an attacker is to predict\n            'no' everytime the model gets the class prediction wrong. This\n            strategy is based upon the notion that since the DNN is good at this\n            task, if it gets the prediction wrong, then most likely it has not\n            seen the image before.\n          </p>\n          <p>\n            This is problematic for models that are severely overfit, where\n            there is a large gap between the accuracy of training images and new\n            images. As such, this is known as the <b> 'Gap Attack' </b> and it\n            will have results better than random guessing by an amount related\n            to the size of the gap.\n          </p>\n          <p>\n            However, even for models that are not overfit and only output the\n            predicted label, there is a way to perform a successful membership\n            attack. By adding noise to the input, it is possible to trick the\n            model into a wrong classification. To see this, add noise to the\n            images on the right. One image was in the training data set and the\n            other was not. But by adding enough noise to the images, a\n            successful misclassification will occur. See if you can determine a\n            noise level that gives you strong confidence about whether the image\n            was used in the training or not. This is known as the{\" \"}\n            <b>'Label-Only Attack' </b> since it can be performed even when the\n            model's output is nothing more than the class label.\n          </p>\n        </div>\n      </ScrollyContentSection>\n      <ScrollyContentSection style={{ flexBasis: \"40%\" }}>\n        <ImageNoise />\n      </ScrollyContentSection>\n    </ScrollContainer>\n  </div>\n)\n\nconst DotMatrix = ({ status }) => (\n  <div style={stepOpacityStyle(status)}>\n    <ScrollyHeaderSection>Label-Only Attack Threshold</ScrollyHeaderSection>\n    <ScrollContainer>\n      <ScrollyContentSection style={{ flexBasis: \"55%\" }}>\n        <ExperimentThresholdCharts\n          nodeSize={13}\n          defaultThreshold={4.5}\n          bottomLabel=\"Distance\"\n          sliderLabel=\"Threshold\"\n          // thresholdPercent={status && status.progress ? status.progress : null}\n        />\n      </ScrollyContentSection>\n      <ScrollyContentSection style={{ flexBasis: \"50%\" }}>\n        <div style={{ position: \"sticky\", top: 10 }}>\n          <VerticalSpacer height={75} />\n          <p>\n            For images that the model has been trained on, the amount of noise\n            needed to fool the model is typically higher. In other words, for\n            images not in the training, it is easier to obtain an incorrect\n            label. By using your own data, you can determine the noise level\n            that will give optimal attack results. This can be used in the\n            attack of other target models.\n          </p>\n        </div>\n      </ScrollyContentSection>\n    </ScrollContainer>\n  </div>\n)\n\nconst DebuggerTitle = styled.div`\n  width: 45px;\n  display: inline-block;\n  font-weight: bold;\n  margin-right: 15px;\n`\n\nconst Debugger = ({ viewState, hide }) => {\n  if (hide) return null\n  const progressPercent = (x) => (x ? (x * 100).toFixed() : 0)\n  return (\n    <div\n      style={{\n        position: \"fixed\",\n        top: 50,\n        left: 50,\n        zIndex: 999999999999,\n        padding: 5,\n        border: \"1px solid black\",\n        backgroundColor: \"pink\",\n      }}\n    >\n      <div>\n        <DebuggerTitle>View:</DebuggerTitle>\n        {viewState.currentView || \"None\"}\n        <br />\n        <DebuggerTitle>Scroll:</DebuggerTitle>\n        {progressPercent(\n          (viewState[viewState.currentView] || { progress: \"\" }).progress\n        )}\n        %\n      </div>\n    </div>\n  )\n}\n\nconst Story = ({ debugScrolling = false }) => {\n  const [currentViewState, setCurrentViewState] = useState({})\n  const [viewState, setViewState] = useState({})\n\n  const onStepEnter = ({ data }) =>\n    setCurrentViewState({ view: data, visible: true })\n\n  const onStepExit = ({ data }) =>\n    setCurrentViewState({ view: data, visible: false })\n\n  const onStepProgress = ({ data, progress }) =>\n    setCurrentViewState({ view: data, visible: true, progress })\n\n  useEffect(\n    () =>\n      currentViewState.view\n        ? setViewState({\n            ...viewState,\n            [currentViewState.view]: {\n              ...viewState[currentViewState.view],\n              ...currentViewState,\n            },\n            currentView: currentViewState.view,\n          })\n        : null, // eslint-disable-next-line react-hooks/exhaustive-deps\n    [currentViewState]\n  )\n\n  return (\n    <>\n      <ScrollerContainer>\n        <Scroller>\n          <Scrollama\n            onStepEnter={onStepEnter}\n            onStepExit={onStepExit}\n            progress\n            onStepProgress={onStepProgress}\n            offset={0.4}\n            debug={debugScrolling}\n          >\n            <Step data=\"weakness\">\n              <StepContainer>\n                <WeaknessWithAI status={viewState[\"weakness\"]} />\n              </StepContainer>\n            </Step>\n            <Step data=\"puppies-or-food\">\n              <StepContainer>\n                <PuppiesOrFood status={viewState[\"puppies-or-food\"]} />\n              </StepContainer>\n            </Step>\n            <Step data=\"mia\">\n              <StepContainer>\n                <MembershipInferenceAttack status={viewState[\"mia\"]} />\n              </StepContainer>\n            </Step>\n            <Step data=\"20q\">\n              <StepContainer>\n                <TwentyQuestions status={viewState[\"20q\"]} />\n              </StepContainer>\n            </Step>\n            <Step data=\"dot-matrix\">\n              <StepContainer>\n                <DotMatrix status={viewState[\"dot-matrix\"]} />\n              </StepContainer>\n            </Step>\n            <Step data=\"model-inversion-attack\">\n              <StepContainer>\n                <ModelInversionAttack\n                  status={viewState[\"model-inversion-attack\"]}\n                />\n              </StepContainer>\n            </Step>\n          </Scrollama>\n        </Scroller>\n        <Debugger hide={!debugScrolling} viewState={viewState} />\n      </ScrollerContainer>\n    </>\n  )\n}\n\nexport default Story\n","import { GameContextProvider } from \"../context/GameContext\"\nimport { useState } from \"react\"\nimport { withRouter } from \"react-router-dom\"\nimport CheckButton from \"react-grid-gallery/lib/CheckButton\"\nimport { Fab, Action } from \"react-tiny-fab\"\nimport \"react-tiny-fab/dist/styles.css\"\nimport TwentyQuestions from \"../components/game/TwentyQuestions\"\nimport Match from \"../components/game/Match\"\nimport TwentyQuestionsPractice from \"../components/game/TwentyQuestionsPractice\"\nimport Menu from \"../components/game/Menu\"\nimport Story from \"../components/Story\"\nimport { Emoji } from \"../components/game/Util\"\nimport Modal from \"react-modal\"\nimport { HashRouter as Router, Switch, Route } from \"react-router-dom\"\n\nModal.setAppElement(\"#root\")\n\nconst PageHeader = ({ title, subtitle }) => {\n  const styles = {\n    container: {\n      marginBottom: 5,\n    },\n    title: {\n      fontSize: 20,\n      fontWeight: \"bold\",\n    },\n    subtitle: {\n      fontSize: 14,\n      color: \"gray\",\n    },\n  }\n  return (\n    <div style={styles.container}>\n      <div style={styles.title}>{title}</div>\n      <span style={styles.subtitle}>{subtitle}</span>\n    </div>\n  )\n}\n\nconst GameModal = withRouter(({ history }) => {\n  const [isModalOpen, setModalOpen] = useState(false)\n  const toggleModal = () => setModalOpen(!isModalOpen)\n  const returnToMenu = () => {\n    if (window.location.hash === \"#/\") {\n      // Already on the main page, scroll up to the menu\n      window.scrollTo({ top: 0, left: 0, behavior: \"auto\" })\n    } else {\n      history.push(\"/\")\n    }\n  }\n\n  return (\n    <>\n      <Modal\n        isOpen={isModalOpen}\n        onRequestClose={toggleModal}\n        contentLabel=\"My dialog\"\n      >\n        <PageHeader\n          title=\"A game of 16 questions…beat Carnac!\"\n          subtitle=\"AI Jimmy is really good at identifying the object in images that he\n            has seen before. Select (check) which of the following images you\n            think Jimmy remembers. You will be playing against Carnac and who\n            ever gets more correct, wins!\"\n        />\n        <button\n          onClick={toggleModal}\n          style={{\n            position: \"absolute\",\n            top: 5,\n            right: 5,\n            border: 0,\n            background: \"none\",\n          }}\n        >\n          <CheckButton color=\"black\" isSelected={true} />\n        </button>\n      </Modal>\n      <Fab\n        alwaysShowTitle={true}\n        mainButtonStyles={{\n          backgroundColor: \"slategray\",\n        }}\n        icon=\". . .\"\n      >\n        <Action text=\"Back to Game Menu\" onClick={returnToMenu}>\n          <Emoji symbol=\"0x21A9\" />\n        </Action>\n      </Fab>\n    </>\n  )\n})\n\nconst GameView = () => {\n  return (\n    <GameContextProvider>\n      <Router>\n        <Switch>\n          <Route path=\"/20q/learn\">\n            <TwentyQuestionsPractice />\n          </Route>\n          <Route path=\"/20q/easy\">\n            <TwentyQuestions gameMode=\"easy\" />\n          </Route>\n          <Route path=\"/20q/hard\">\n            <TwentyQuestions gameMode=\"hard\" />\n          </Route>\n          <Route path=\"/match/learn\">\n            <Match gameMode=\"learn\" />\n          </Route>\n          <Route path=\"/match/easy\">\n            <Match gameMode=\"easy\" />\n          </Route>\n          <Route path=\"/match/hard\">\n            <Match gameMode=\"hard\" />\n          </Route>\n          <Route path=\"/\">\n            <Menu />\n            <Story />\n          </Route>\n        </Switch>\n        <GameModal />\n      </Router>\n    </GameContextProvider>\n  )\n}\n\nexport default GameView\n","import \"./App.css\"\n// import PickView from \"./views/PickView\"\nimport GameView from \"./views/GameView\"\nimport ReactTooltip from \"react-tooltip\"\n\nconst App = () => {\n  return (\n    <>\n      <GameView />\n      <ReactTooltip effect=\"solid\" />\n    </>\n    // <PickView />\n  )\n}\n\nexport default App\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from \"react\"\nimport ReactDOM from \"react-dom\"\nimport App from \"./App\"\nimport reportWebVitals from \"./reportWebVitals\"\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n)\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals()\n"],"sourceRoot":""}